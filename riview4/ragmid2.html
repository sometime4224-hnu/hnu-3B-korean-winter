<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í•œêµ­ì–´ ì½ê¸° ì—°ìŠµ (ì§€ë¬¸ í™œìš©)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #f3f4f6;
        }
        .correct { background-color: #d1fae5 !important; border-color: #10b981 !important; color: #065f46 !important; }
        .incorrect { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b !important; }
        .vietnamese { color: #64748b; font-size: 0.82rem; line-height: 1.4; margin-top: 4px; border-left: 2px solid #cbd5e1; padding-left: 8px; }
        .blank-title { color: #2563eb; font-weight: 700; border: 2px dashed #2563eb; padding: 4px 12px; border-radius: 6px; background-color: #eff6ff; display: inline-block; }
        .passage-box { background-color: #ffffff; border: 1px solid #e2e8f0; padding: 20px; border-radius: 12px; margin-top: 16px; font-size: 0.95rem; line-height: 1.7; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .option-btn { transition: all 0.1s; border-width: 2px; }
        .option-btn:active { transform: scale(0.98); }
        .highlight-blue { color: #2563eb; font-weight: 700; text-decoration: underline; }
        .highlight-yellow { background-color: #fef08a; padding: 0 4px; border-radius: 4px; font-weight: 700; color: #854d0e; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <div id="app" class="w-full max-w-md bg-white min-h-screen shadow-2xl flex flex-col relative">
        <!-- Header -->
        <div class="bg-indigo-600 p-5 text-white sticky top-0 z-30 shadow-md">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-lg font-bold">í•œêµ­ì–´ ì½ê¸° ì‹¤ì „ í€´ì¦ˆ</h1>
                    <p class="text-indigo-200 text-[10px] uppercase tracking-wider">Reading Comprehension Practice</p>
                </div>
                <button id="view-text-btn" class="bg-white/20 px-3 py-2 rounded-lg text-xs font-bold border border-white/30 active:bg-white/40 transition">
                    ğŸ“‚ ì „ì²´ ì§€ë¬¸ (Xem bÃ i)
                </button>
            </div>
            <div class="mt-4 bg-indigo-900/40 rounded-full h-1 w-full overflow-hidden">
                <div id="progress-bar" class="bg-yellow-400 h-1 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-container" class="flex-grow p-5 pb-24 overflow-y-auto">
            <div id="question-area">
                <div class="flex justify-between items-center mb-4">
                    <span id="question-category" class="text-indigo-600 text-[10px] font-black uppercase bg-indigo-50 px-2 py-1 rounded">CATEGORY</span>
                    <span id="q-count" class="text-xs font-bold text-gray-400 font-mono">01/12</span>
                </div>
                
                <!-- Question Section -->
                <div class="mb-6">
                    <h2 id="question-title" class="text-base font-bold text-gray-800 leading-tight"></h2>
                    <p id="question-title-vn" class="vietnamese italic mb-4"></p>
                    
                    <div id="body-display-area">
                        <!-- Content Injected Here -->
                    </div>
                </div>
                
                <div id="options-grid" class="space-y-3 mt-6">
                    <!-- Options -->
                </div>
            </div>

            <!-- Feedback -->
            <div id="feedback-area" class="hidden mt-8 p-5 rounded-2xl border-2 shadow-sm animate-in fade-in slide-in-from-bottom-2 duration-300">
                <div class="flex items-center mb-2">
                    <span id="feedback-icon" class="text-2xl mr-2"></span>
                    <p id="feedback-status" class="font-bold text-base"></p>
                </div>
                <p id="feedback-rationale" class="text-gray-700 text-sm mb-1"></p>
                <div id="feedback-rationale-vn" class="vietnamese font-normal border-none"></div>
                <button id="next-btn" class="mt-6 w-full bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg active:bg-indigo-700">
                    ë‹¤ìŒ ë¬¸ì œ (Tiáº¿p theo)
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-container" class="hidden flex-grow flex flex-col items-center justify-center p-10 text-center">
            <div class="text-7xl mb-6" id="result-emoji">ğŸ‰</div>
            <h2 class="text-2xl font-bold text-gray-800">í…ŒìŠ¤íŠ¸ ì¢…ë£Œ</h2>
            <p class="text-gray-500 text-sm mt-1">ì§€ë¬¸ì„ ì™„ë²½í•˜ê²Œ ì´í•´í•˜ì…¨ìŠµë‹ˆë‹¤!</p>
            <div class="text-5xl font-black text-indigo-600 my-10">
                <span id="final-score">0</span> / 12
            </div>
            <button onclick="location.reload()" class="bg-indigo-600 text-white w-full py-4 rounded-2xl font-bold shadow-xl active:bg-indigo-700">ë‹¤ì‹œ í•˜ê¸° (LÃ m láº¡i)</button>
        </div>

        <!-- Full Text Modal -->
        <div id="text-modal" class="hidden fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
            <div class="bg-white w-full max-w-md rounded-t-3xl sm:rounded-3xl max-h-[80vh] flex flex-col shadow-2xl relative">
                <div class="p-6 border-b flex justify-between items-center">
                    <h3 class="font-bold text-gray-800">ì „ì²´ ì§€ë¬¸ ë³´ê¸° (Xem bÃ i Ä‘á»c)</h3>
                    <button id="close-modal-btn" class="p-2 text-gray-400 bg-gray-100 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div id="modal-content" class="p-8 overflow-y-auto text-sm leading-loose text-gray-700 whitespace-pre-wrap"></div>
            </div>
        </div>
    </div>

    <script>
        const passages = [
            { id: 1, title: "ì‚¬ë‘ì˜ ì–¸ì–´", template: "ë‹¤ì„¯ ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ëŠ” ë§, ì„ ë¬¼, ìŠ¤í‚¨ì‹­, ë´‰ì‚¬, ê·¸ë¦¬ê³  ì‹œê°„ í•¨ê»˜ ë³´ë‚´ê¸°ì´ë‹¤. \n\nì‚¬ë‘ì˜ ì–¸ì–´ê°€ ë§ì¸ ì‚¬ëŒì€ â€˜ì‚¬ë‘í•´â€™, â€˜ë„Œ ì •ë§ ì¢‹ì€ ì‚¬ëŒì´ì•¼â€™ ë“±ì˜ ì¹­ì°¬ì´ë‚˜ ê²©ë ¤ì˜ ë§ì„ í•´ ì£¼ë©´ ì‚¬ë‘ë°›ê³  ìˆë‹¤ê³  ëŠë‚€ë‹¤. ì–´ë–¤ ì‚¬ëŒë“¤ì€ ì„ ë¬¼ì´ ì‚¬ë‘ì„ í‘œí˜„í•˜ëŠ” ë°©ë²•ì´ë¼ê³  ìƒê°í•´ì„œ í•­ìƒ í¬ê³  ì‘ì€ ì„ ë¬¼ì„ ì£¼ê³ ë°›ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤. \n\nìŠ¤í‚¨ì‹­ì´ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒë“¤ì€ ì†ì„ ì¡ê±°ë‚˜ íŒ”ì§±ì„ ë¼ëŠ” ê²ƒë§Œìœ¼ë¡œë„ í–‰ë³µí•´ì§„ë‹¤. í•˜ì§€ë§Œ ì–´ë–¤ ì‚¬ëŒì€ ì†ì„ ì¡ê±°ë‚˜ ì„ ë¬¼ì„ ë°›ëŠ” ê²ƒë³´ë‹¤ ìƒëŒ€ë°©ê³¼ í•¨ê»˜ ì‹œê°„ì„ ë³´ë‚´ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤. \n\nì–´ë–¤ ì‚¬ëŒë“¤ì€ ìƒëŒ€ë°©ì´ ìê¸°ë¥¼ ë„ì™€ì¤„ ë•Œ ì‚¬ë‘ì„ ëŠë‚€ë‹¤. ã‰ ì´ë“¤ì€ ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒì´ ìƒê¸°ë©´ ë§ì—†ì´ ìš”ë¦¬ë‚˜ ì²­ì†Œ ë“±ì„ í•´ ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ë‘ì„ í‘œí˜„í•œë‹¤." },
            { id: 2, title: "í¬ë¡œìŠ¤í•(CrossFit)", template: "â€˜í¬ë¡œìŠ¤í•â€™ì€ ë‹¬ë¦¬ê¸°ë‚˜ ì¤„ë„˜ê¸°, ì—­ë„ ê°™ì€ ì—¬ëŸ¬ ê°€ì§€ ìš´ë™ì„ ì„ì–´ì„œ ë§Œë“  ìš´ë™ í”„ë¡œê·¸ë¨ì´ë‹¤. ì´ ìš´ë™ì€ ëª¸ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì„ ê³¨ê³ ë£¨ ì“°ê¸° ë•Œë¬¸ì— ë‹¤ì´ì–´íŠ¸ì™€ ëª¸ë§¤ ë§Œë“¤ê¸°ì— íš¨ê³¼ì ì´ë‹¤. \n\nâ€˜í¬ë¡œìŠ¤í•â€™ ìš´ë™ ë°©ë²•ì˜ ì˜ˆëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë¨¼ì € íŒ”êµ½í˜€í´ê¸°ë¥¼ í•œ í›„ ì—­ê¸°ë¥¼ ë“ ë‹¤. ì²˜ìŒì—ëŠ” ê°€ë²¼ìš´ ì—­ê¸°ë¡œ ì‹œì‘í•˜ì§€ë§Œ ì ì  ë¬´ê±°ìš´ ì—­ê¸°ë¡œ ë°”ê¿”ì„œ ( ã‰  ) ë™ì‘ì„ ë°˜ë³µí•œë‹¤. \n\nê·¸ ë‹¤ìŒì— ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸°ë¥¼ í•œ í›„ ì² ë´‰ì— ë§¤ë‹¬ë¦¬ê±°ë‚˜ ì‘ì€ ë¤ë²¨ì„ ë“¤ê³  íŒ”ì„ ì˜¬ë ¸ë‹¤ê°€ ë‚´ë¦¬ëŠ” ë™ì‘ì„ ì—¬ëŸ¬ ë²ˆ í•œë‹¤." },
            { id: 3, title: "êµìˆ˜ë‹˜ì—ê²Œ ë¬¸ì˜ ì´ë©”ì¼", template: "êµìˆ˜ë‹˜, ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ? ì €ëŠ” íˆì—”ì´ë¼ê³  í•©ë‹ˆë‹¤. \n\nìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³  ë©”ì¼ì„ ì”ë‹ˆë‹¤. ìˆ™ì œëŠ” ë‹¤ìŒ ì£¼ì— ( ã‰  )? \n\në‹µì¥ì„ ( ã‰¡ ). ì•ˆë…•íˆ ê³„ì‹­ì‹œì˜¤." },
            { id: 4, title: "ì²­ì²©ì¥ ë‚´ìš©", template: "ë“œë””ì–´ ê²°í˜¼í•©ë‹ˆë‹¤. \n\në‘ ì‚¬ëŒì´ ë§Œë‚˜ì„œ í•˜ë‚˜ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëœ ì—°ì•  ëì— ì €í¬ê°€ ( ã‰  ). ë°”ì˜ì‹œê² ì§€ë§Œ ê¼­ ( ã‰¡ ). \n\nï‚Ÿ ì‹ ë‘ : ê¹€ì² ìˆ˜  ï‚Ÿ ì‹ ë¶€ : ì´ì˜í¬ \nï‚Ÿ ì¼ì‹œ : 12ì›” 25ì¼ ì˜¤í›„ 2ì‹œ \nï‚Ÿ ì¥ì†Œ : í–‰ë³µì›¨ë”©í™€" }
        ];

        const quizData = [
            // ì§€ë¬¸ 1: ì‚¬ë‘ì˜ ì–¸ì–´ (ë¶„ëŸ‰ í™•ëŒ€)
            { 
                pid: 1, 
                q: "ë¹ˆì¹¸ ( ã‰  )ì— ì•Œë§ì€ ë§ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?", 
                vn: "HÃ£y chá»n tá»« thÃ­ch há»£p cho khoáº£ng trá»‘ng ( ã‰  ).", 
                displayType: "blank", 
                body: "ë‹¤ì„¯ ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ëŠ” ë§, ì„ ë¬¼, ìŠ¤í‚¨ì‹­, ë´‰ì‚¬, ê·¸ë¦¬ê³  ( ã‰  )ì´ë‹¤. ì‚¬ë‘ì˜ ì–¸ì–´ê°€ ë§ì¸ ì‚¬ëŒì€ ì¹­ì°¬ì´ë‚˜ ê²©ë ¤ì˜ ë§ì„ ë“¤ì„ ë•Œ ì‚¬ë‘ë°›ëŠ”ë‹¤ê³  ëŠë‚€ë‹¤. ë°˜ë©´ ìŠ¤í‚¨ì‹­ì´ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒë“¤ì€ ì†ì„ ì¡ëŠ” ê²ƒë§Œìœ¼ë¡œë„ í–‰ë³µí•´ì§„ë‹¤.", 
                options: ["ì‹œê°„ í•¨ê»˜ ë³´ë‚´ê¸°", "í˜¼ì ì—¬í–‰í•˜ê¸°", "í¸ì§€ ì“°ê¸°", "ëˆ ëª¨ìœ¼ê¸°"], 
                ans: "ì‹œê°„ í•¨ê»˜ ë³´ë‚´ê¸°", 
                rat: "ì§€ë¬¸ ë„ì…ë¶€ì—ì„œ ì œì‹œëœ 5ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ ì¤‘ ë§ˆì§€ë§‰ ìš”ì†Œì…ë‹ˆë‹¤.", 
                ratVn: "LÃ  yáº¿u tá»‘ cuá»‘i cÃ¹ng trong 5 ngÃ´n ngá»¯ tÃ¬nh yÃªu Ä‘Æ°á»£c nÃªu á»Ÿ Ä‘áº§u bÃ i." 
            },
            { 
                pid: 1, 
                q: "ë°‘ì¤„ ì¹œ ã‰ â€˜ì´ë“¤ì€â€™ì´ ê°€ë¦¬í‚¤ëŠ” ì‚¬ëŒì€?", 
                vn: "Cá»¥m tá»« 'Nhá»¯ng ngÆ°á»i nÃ y' chá»‰ ai?", 
                displayType: "blank", 
                body: "ì–´ë–¤ ì‚¬ëŒì€ ì„ ë¬¼ì„ ë°›ëŠ” ê²ƒë³´ë‹¤ ìƒëŒ€ë°©ê³¼ í•¨ê»˜ ì‹œê°„ì„ ë³´ë‚´ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤. ì–´ë–¤ ì‚¬ëŒë“¤ì€ ìƒëŒ€ë°©ì´ ìê¸°ë¥¼ ë„ì™€ì¤„ ë•Œ ì‚¬ë‘ì„ ëŠë‚€ë‹¤. [ ã‰ ì´ë“¤ì€ ] ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒì´ ìƒê¸°ë©´ ìš”ë¦¬ë‚˜ ì²­ì†Œ ë“±ì„ í•´ ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ë‘ì„ í‘œí˜„í•œë‹¤.", 
                options: ["ë´‰ì‚¬ê°€ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒ", "ì„ ë¬¼ì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒ", "ë§ì„ ì˜í•˜ëŠ” ì‚¬ëŒ", "í•¨ê»˜ ìˆëŠ” ê²ƒì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒ"], 
                ans: "ë´‰ì‚¬ê°€ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒ", 
                rat: "ìƒëŒ€ë°©ì„ ë„ì™€ì£¼ëŠ” í–‰ìœ„(ìš”ë¦¬, ì²­ì†Œ)ë¥¼ í†µí•´ ì‚¬ë‘ì„ í‘œí˜„í•˜ëŠ” 'ë´‰ì‚¬' ìœ í˜•ì„ ë§í•©ë‹ˆë‹¤.", 
                ratVn: "Chá»‰ nhÃ³m ngÆ°á»i 'phá»¥c vá»¥' thá»ƒ hiá»‡n tÃ¬nh yÃªu qua viá»‡c giÃºp Ä‘á»¡ (náº¥u Äƒn, dá»n dáº¹p)." 
            },
            { 
                pid: 1, 
                q: "ë§ì´ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒì— ëŒ€í•œ ì˜¬ë°”ë¥¸ ì„¤ëª…ì€?", 
                vn: "ÄÃ¢u lÃ  giáº£i thÃ­ch Ä‘Ãºng vá» ngÆ°á»i cÃ³ ngÃ´n ngá»¯ tÃ¬nh yÃªu lÃ  'lá»i nÃ³i'?", 
                displayType: "inline", 
                body: "ë‹¤ì„¯ ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ëŠ” ì €ë§ˆë‹¤ ë‹¤ë¦…ë‹ˆë‹¤. ì‚¬ë‘ì˜ ì–¸ì–´ê°€ ë§ì¸ ì‚¬ëŒì€ â€˜ì‚¬ë‘í•´â€™, â€˜ë„Œ ì •ë§ ì¢‹ì€ ì‚¬ëŒì´ì•¼â€™ ê°™ì€ (      )ì„ ë“¤ì„ ë•Œ ì‚¬ë‘ë°›ê³  ìˆë‹¤ê³  ëŠë‚ë‹ˆë‹¤. í•˜ì§€ë§Œ ì–´ë–¤ ì‚¬ëŒì€ ì„ ë¬¼ì´ë‚˜ ìŠ¤í‚¨ì‹­ì„ ë” ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ê¸°ë„ í•©ë‹ˆë‹¤.", 
                options: ["ì¹­ì°¬ì´ë‚˜ ê²©ë ¤ì˜ ë§", "ë¹„ì‹¼ ì„ ë¬¼", "ë”°ëœ»í•œ í¬ì˜¹", "ë§›ìˆëŠ” ìŒì‹"], 
                ans: "ì¹­ì°¬ì´ë‚˜ ê²©ë ¤ì˜ ë§", 
                rat: "ì‚¬ë‘í•œë‹¤ëŠ” ê³ ë°±ì´ë‚˜ ì¢‹ì€ ì‚¬ëŒì´ë¼ëŠ” ì¹­ì°¬ì€ ê¸ì •ì ì¸ ê²©ë ¤ì— í•´ë‹¹í•©ë‹ˆë‹¤.", 
                ratVn: "Lá»i tá» tÃ¬nh hay lá»i khen ngá»£i lÃ  ngÆ°á»i tá»‘t thuá»™c vá» sá»± khÃ­ch lá»‡ tÃ­ch cá»±c." 
            },

            // ì§€ë¬¸ 2: í¬ë¡œìŠ¤í• (ë¶„ëŸ‰ í™•ëŒ€)
            { 
                pid: 2, 
                q: "í¬ë¡œìŠ¤í•ì˜ íŠ¹ì§•ì— ëŒ€í•œ ì„¤ëª…ìœ¼ë¡œ ì•Œë§ì€ ë¹ˆì¹¸ì€?", 
                vn: "Äiá»n vÃ o khoáº£ng trá»‘ng giáº£i thÃ­ch vá» Ä‘áº·c Ä‘iá»ƒm cá»§a CrossFit.", 
                displayType: "inline", 
                body: "â€˜í¬ë¡œìŠ¤í•â€™ì€ ë‹¬ë¦¬ê¸°ë‚˜ ì¤„ë„˜ê¸°, ì—­ë„ ê°™ì€ ì—¬ëŸ¬ ê°€ì§€ ìš´ë™ì„ ì„ì–´ì„œ ë§Œë“  í”„ë¡œê·¸ë¨ì´ë‹¤. ì´ ìš´ë™ì€ ëª¸ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì„ (      ) ì“°ê¸° ë•Œë¬¸ì— ë‹¤ì´ì–´íŠ¸ì™€ ëª¸ë§¤ ë§Œë“¤ê¸°ì— íš¨ê³¼ì ì´ë‹¤. ìš´ë™ ë°©ë²•ì˜ ì˜ˆë¡œëŠ” íŒ”êµ½í˜€í´ê¸°, ì—­ê¸° ë“¤ê¸° ë“±ì´ ìˆë‹¤.", 
                options: ["ê³¨ê³ ë£¨", "í•œìª½ë§Œ", "ë¨¸ë¦¬ë§Œ", "ë‹¤ë¦¬ë§Œ"], 
                ans: "ê³¨ê³ ë£¨", 
                rat: "ì—¬ëŸ¬ ìš´ë™ì„ ì„ì–´ì„œ ì‹ ì²´ ì „ì²´ë¥¼ ê· í˜• ìˆê²Œ ì‚¬ìš©í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.", 
                ratVn: "NghÄ©a lÃ  sá»­ dá»¥ng toÃ n bá»™ cÆ¡ thá»ƒ má»™t cÃ¡ch cÃ¢n báº±ng báº±ng cÃ¡ch káº¿t há»£p nhiá»u bÃ i táº­p." 
            },
            { 
                pid: 2, 
                q: "ë¹ˆì¹¸ ( ã‰  )ì— ë“¤ì–´ê°ˆ ì ì ˆí•œ ë™ì‘ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?", 
                vn: "Äá»™ng tÃ¡c nÃ o phÃ¹ há»£p Ä‘á»ƒ Ä‘iá»n vÃ o khoáº£ng trá»‘ng ( ã‰  )?", 
                displayType: "blank", 
                body: "ë¨¼ì € íŒ”êµ½í˜€í´ê¸°ë¥¼ í•œ í›„ ì—­ê¸°ë¥¼ ë“ ë‹¤. ì²˜ìŒì—ëŠ” ê°€ë²¼ìš´ ì—­ê¸°ë¡œ ì‹œì‘í•˜ì§€ë§Œ ì ì  ë¬´ê±°ìš´ ì—­ê¸°ë¡œ ë°”ê¿”ì„œ [ ã‰  ] ë™ì‘ì„ ë°˜ë³µí•œë‹¤. ê·¸ ë‹¤ìŒì— ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸°ë¥¼ í•œ í›„ ì² ë´‰ì— ë§¤ë‹¬ë¦¬ê¸°ë„ í•œë‹¤.", 
                options: ["íŒ”ì„ êµ½í˜”ë‹¤ í´ëŠ”", "ë°œì„ ë†’ì´ ë“œëŠ”", "ìˆ¨ì„ ê¹Šì´ ì°¸ëŠ”", "ë¹ ë¥´ê²Œ ë‹¬ë ¤ê°€ëŠ”"], 
                ans: "íŒ”ì„ êµ½í˜”ë‹¤ í´ëŠ”", 
                rat: "ì—­ê¸°ë¥¼ ë“¤ê³  ë‚´ë¦´ ë•Œ íŒ” ê·¼ìœ¡ì„ êµ½í˜”ë‹¤ í´ëŠ” ìš´ë™ ì›ë¦¬ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.", 
                ratVn: "Giáº£i thÃ­ch nguyÃªn lÃ½ táº­p luyá»‡n gáº­p vÃ  duá»—i cÆ¡ tay khi nÃ¢ng vÃ  háº¡ táº¡." 
            },
            { 
                pid: 2, 
                q: "ë³¸ë¬¸ì— ì–¸ê¸‰ëœ í¬ë¡œìŠ¤í• ìš´ë™ì˜ ì¢…ë¥˜ê°€ ì•„ë‹Œ ê²ƒì€?", 
                vn: "MÃ´n nÃ o KHÃ”NG Ä‘Æ°á»£c nháº¯c Ä‘áº¿n trong bÃ i táº­p CrossFit?", 
                displayType: "inline", 
                body: "í¬ë¡œìŠ¤í•ì€ ë‹¬ë¦¬ê¸°ë‚˜ ì¤„ë„˜ê¸°, ì—­ë„ ê°™ì€ ì—¬ëŸ¬ ìš´ë™ì„ ì„ì–´ì„œ ë§Œë“  í”„ë¡œê·¸ë¨ì´ë‹¤. ë¨¼ì € íŒ”êµ½í˜€í´ê¸°ì™€ ì—­ê¸° ë“¤ê¸°ë¥¼ í•œë‹¤. ê·¸ ë‹¤ìŒì— ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸°ë¥¼ í•œ í›„ ì² ë´‰ì— ë§¤ë‹¬ë¦¬ê±°ë‚˜ ë¤ë²¨ ìš´ë™ì„ í•œë‹¤.", 
                options: ["ìˆ˜ì˜", "ì¤„ë„˜ê¸°", "íŒ”êµ½í˜€í´ê¸°", "ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸°"], 
                ans: "ìˆ˜ì˜", 
                rat: "ì§€ë¬¸ì— ë‹¬ë¦¬ê¸°, ì¤„ë„˜ê¸°, ì—­ë„, íŒ”êµ½í˜€í´ê¸° ë“±ì€ ë‚˜ì˜¤ì§€ë§Œ ìˆ˜ì˜ì€ ì–¸ê¸‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.", 
                ratVn: "Trong bÃ i cÃ³ nháº¯c Ä‘áº¿n cháº¡y, nháº£y dÃ¢y, táº¡, chá»‘ng Ä‘áº©y nhÆ°ng khÃ´ng cÃ³ bÆ¡i lá»™i." 
            },

            // ì§€ë¬¸ 3: ì´ë©”ì¼
            { pid: 3, q: "íˆì—” ì”¨ê°€ ì´ë©”ì¼ì„ ì“´ ëª©ì ì€?", vn: "Má»¥c Ä‘Ã­ch Hien viáº¿t email lÃ  gÃ¬?", displayType: "inline", body: "êµìˆ˜ë‹˜, ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ? ì €ëŠ” íˆì—”ì´ë¼ê³  í•©ë‹ˆë‹¤. ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³  ë©”ì¼ì„ ì”ë‹ˆë‹¤. ìˆ™ì œëŠ” ë‹¤ìŒ ì£¼ì— ( ã‰  )? ë‹µì¥ì„ ( ã‰¡ ).", options: ["ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³ ", "ì‹œí—˜ ì„±ì ì„ í™•ì¸í•˜ë ¤ê³ ", "ìˆ˜ì—…ì„ ì·¨ì†Œí•˜ë ¤ê³ ", "ê³ í–¥ ì„ ë¬¼ì„ ì „í•´ ë“œë¦¬ë ¤ê³ "], ans: "ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³ ", rat: "ë³¸ë¬¸ì— 'ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³ 'ë¼ê³  ëª…ì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.", ratVn: "Trong bÃ i cÃ³ ghi rÃµ 'Ä‘á»ƒ há»i vá» ngÃ y ná»™p bÃ i táº­p'." },
            { pid: 3, q: "ë¹ˆì¹¸ ( ã‰  )ì— ë“¤ì–´ê°ˆ ì í•©í•œ í‘œí˜„ì€?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰  ) lÃ  gÃ¬?", displayType: "blank", body: "ì €ëŠ” íˆì—”ì´ë¼ê³  í•©ë‹ˆë‹¤. ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³  ë©”ì¼ì„ ì”ë‹ˆë‹¤. ìˆ™ì œëŠ” ë‹¤ìŒ ì£¼ì— [ ã‰  ]? ë‹µì¥ì„ ( ã‰¡ ).", options: ["ì œì¶œí•´ë„ ë©ë‹ˆê¹Œ", "ì–´ë””ì— ìˆìŠµë‹ˆê¹Œ", "í•¨ê»˜ í•©ì‹œë‹¤", "ë¨¼ì € í•˜ì‹­ì‹œì˜¤"], ans: "ì œì¶œí•´ë„ ë©ë‹ˆê¹Œ", rat: "ì œì¶œ ë‚ ì§œë¥¼ ë¬¸ì˜í•˜ëŠ” ì •ì¤‘í•œ ì§ˆë¬¸ í˜•íƒœì…ë‹ˆë‹¤.", ratVn: "Dáº¡ng cÃ¢u há»i lá»‹ch sá»± Ä‘á»ƒ há»i vá» ngÃ y ná»™p bÃ i." },
            { pid: 3, q: "ë¹ˆì¹¸ ( ã‰¡ )ì— ë“¤ì–´ê°ˆ ì •ë‹µì€?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰¡ ) lÃ  gÃ¬?", displayType: "blank", body: "ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³  ë©”ì¼ì„ ì”ë‹ˆë‹¤. ìˆ™ì œëŠ” ë‹¤ìŒ ì£¼ì— ( ã‰  )? ë‹µì¥ì„ [ ã‰¡ ]. ì•ˆë…•íˆ ê³„ì‹­ì‹œì˜¤.", options: ["ê¸°ë‹¤ë¦¬ê² ìŠµë‹ˆë‹¤", "ì•ˆ í•˜ê² ìŠµë‹ˆë‹¤", "ë²Œì¨ í–ˆìŠµë‹ˆë‹¤", "ì•ˆ ë°›ê² ìŠµë‹ˆë‹¤"], ans: "ê¸°ë‹¤ë¦¬ê² ìŠµë‹ˆë‹¤", rat: "ì´ë©”ì¼ ë§ˆë¬´ë¦¬ ì‹œ ìƒëŒ€ë°©ì˜ ë‹µì‹ ì„ ë°”ë¼ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.", ratVn: "CÃ¡ch diá»…n Ä‘áº¡t mong chá» pháº£n há»“i cá»§a Ä‘á»‘i phÆ°Æ¡ng khi káº¿t thÃºc email." },

            // ì§€ë¬¸ 4: ì²­ì²©ì¥
            { pid: 4, q: "ì´ ê¸€ì˜ ì„±ê²©ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€?", vn: "TÃ­nh cháº¥t cá»§a vÄƒn báº£n nÃ y lÃ  gÃ¬?", displayType: "inline", body: "ë“œë””ì–´ ê²°í˜¼í•©ë‹ˆë‹¤. ë‘ ì‚¬ëŒì´ ë§Œë‚˜ì„œ í•˜ë‚˜ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëœ ì—°ì•  ëì— ì €í¬ê°€ ( ã‰  ). ë°”ì˜ì‹œê² ì§€ë§Œ ê¼­ ( ã‰¡ ).", options: ["ì²­ì²©ì¥", "ì‚¬ê³¼ë¬¸", "ê°ì‚¬ í¸ì§€", "ê´‘ê³  ì „ë‹¨ì§€"], ans: "ì²­ì²©ì¥", rat: "ë‘ ì‚¬ëŒì˜ ê²°í˜¼ ì†Œì‹ì„ ì•Œë¦¬ê³  ì´ˆëŒ€í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.", ratVn: "VÄƒn báº£n thÃ´ng bÃ¡o tin má»«ng vÃ  má»i dá»± Ä‘Ã¡m cÆ°á»›i cá»§a hai ngÆ°á»i." },
            { pid: 4, q: "ë¹ˆì¹¸ ( ã‰  )ì— ë“¤ì–´ê°ˆ ì•Œë§ì€ ë§ì€?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰  ) lÃ  gÃ¬?", displayType: "blank", body: "ë‘ ì‚¬ëŒì´ ë§Œë‚˜ì„œ í•˜ë‚˜ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëœ ì—°ì•  ëì— ì €í¬ê°€ [ ã‰  ]. ë°”ì˜ì‹œê² ì§€ë§Œ ê¼­ ( ã‰¡ ).", options: ["ê²°í˜¼ì„ í•©ë‹ˆë‹¤", "ì´ë³„ì„ í•©ë‹ˆë‹¤", "ì‹¸ì›€ì„ í•©ë‹ˆë‹¤", "ì·¨ì§ì„ í•©ë‹ˆë‹¤"], ans: "ê²°í˜¼ì„ í•©ë‹ˆë‹¤", rat: "ì „ì²´ ê¸€ì˜ ì£¼ì œì¸ 'ê²°í˜¼'ì„ ë‚˜íƒ€ë‚´ëŠ” í•µì‹¬ í‘œí˜„ì…ë‹ˆë‹¤.", ratVn: "CÃ¡ch diá»…n Ä‘áº¡t trá»ng tÃ¢m thá»ƒ hiá»‡n chá»§ Ä‘á» 'káº¿t hÃ´n' cá»§a toÃ n bÃ i." },
            { pid: 4, q: "ë¹ˆì¹¸ ( ã‰¡ )ì— ë“¤ì–´ê°ˆ ì ì ˆí•œ ìš”ì²­ì€?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰¡ ) lÃ  gÃ¬?", displayType: "blank", body: "ì˜¤ëœ ì—°ì•  ëì— ì €í¬ê°€ ( ã‰  ). ë°”ì˜ì‹œê² ì§€ë§Œ ê¼­ [ ã‰¡ ]. ï‚Ÿ ì¼ì‹œ : 12ì›” 25ì¼ ì˜¤í›„ 2ì‹œ", options: ["ì°¸ì„í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤", "ì˜¤ì§€ ë§ˆì‹œê¸° ë°”ëë‹ˆë‹¤", "ìŠì–´ë²„ë¦¬ì‹œê¸° ë°”ëë‹ˆë‹¤", "ì „í™”í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤"], ans: "ì°¸ì„í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤", rat: "ê²°í˜¼ì‹ ì¼ì‹œë¥¼ ì•Œë¦¬ë©° í•˜ê°ì˜ ë°©ë¬¸ì„ ì •ì¤‘íˆ ìš”ì²­í•˜ëŠ” ë§ì…ë‹ˆë‹¤.", ratVn: "Lá»i má»i lá»‹ch sá»± mong khÃ¡ch khá»©a Ä‘áº¿n dá»± khi thÃ´ng bÃ¡o ngÃ y giá» Ä‘Ã¡m cÆ°á»›i." }
        ];

        let currentIdx = 0;
        let score = 0;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        const viewBtn = document.getElementById('view-text-btn');
        const catEl = document.getElementById('question-category');
        const qCountEl = document.getElementById('q-count');
        const qTitleEl = document.getElementById('question-title');
        const qTitleVnEl = document.getElementById('question-title-vn');
        const bodyArea = document.getElementById('body-display-area');
        const optionsGrid = document.getElementById('options-grid');
        const fbArea = document.getElementById('feedback-area');
        const fbStatus = document.getElementById('feedback-status');
        const fbIcon = document.getElementById('feedback-icon');
        const fbRat = document.getElementById('feedback-rationale');
        const fbRatVn = document.getElementById('feedback-rationale-vn');
        const nextBtn = document.getElementById('next-btn');
        const progBar = document.getElementById('progress-bar');
        const quizCont = document.getElementById('quiz-container');
        const resCont = document.getElementById('result-container');
        const finalScoreEl = document.getElementById('final-score');
        const modal = document.getElementById('text-modal');
        const modalContent = document.getElementById('modal-content');

        function render() {
            const data = quizData[currentIdx];
            const passage = passages.find(p => p.id === data.pid);
            
            catEl.textContent = passage.title;
            qCountEl.textContent = `${(currentIdx + 1).toString().padStart(2, '0')}/${quizData.length.toString().padStart(2, '0')}`;
            qTitleEl.textContent = data.q;
            qTitleVnEl.textContent = data.vn;
            
            bodyArea.innerHTML = '';
            const boxClass = data.displayType === "blank" ? "passage-box shadow-inner bg-blue-50/30 border-blue-100" : "passage-box bg-slate-50 border-slate-200";
            const label = data.displayType === "blank" ? "ì§€ë¬¸ ë³¸ë¬¸ ë°œì·Œ (Excerpt)" : "ë¬¸ì œ ë³¸ë¬¸ (Context)";
            const labelColor = data.displayType === "blank" ? "text-blue-600" : "text-gray-500";
            
            bodyArea.innerHTML = `<div class="${boxClass}"><p class="${labelColor} text-[10px] font-bold uppercase mb-2 border-b pb-1">${label}</p>${data.body}</div>`;

            optionsGrid.innerHTML = '';
            fbArea.classList.add('hidden');
            progBar.style.width = `${(currentIdx / quizData.length) * 100}%`;

            const shuffledOptions = shuffle([...data.options]);

            shuffledOptions.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left p-4 border border-gray-200 rounded-2xl bg-white text-gray-700 font-medium shadow-sm flex items-center";
                btn.innerHTML = `<span class="w-8 h-8 flex items-center justify-center bg-indigo-50 text-indigo-600 rounded-full mr-4 font-bold text-sm shrink-0">${i + 1}</span> <span>${opt}</span>`;
                btn.onclick = () => check(opt, btn);
                optionsGrid.appendChild(btn);
            });
            window.scrollTo(0, 0);
        }

        function check(selectedText, btn) {
            const data = quizData[currentIdx];
            const btns = optionsGrid.querySelectorAll('button');
            btns.forEach(b => b.disabled = true);

            if (selectedText === data.ans) {
                btn.classList.add('correct');
                fbIcon.innerHTML = "ğŸ¯";
                fbStatus.textContent = "ì •ë‹µì…ë‹ˆë‹¤!";
                fbStatus.className = "font-bold text-green-700";
                fbArea.className = "mt-8 p-5 rounded-2xl border-2 border-green-200 bg-green-50 block shadow-md";
                score++;
            } else {
                btn.classList.add('incorrect');
                btns.forEach(b => {
                    if(b.querySelector('span:last-child').textContent === data.ans) b.classList.add('correct');
                });
                fbIcon.innerHTML = "ğŸ’¡";
                fbStatus.textContent = "ì˜¤ë‹µì…ë‹ˆë‹¤.";
                fbStatus.className = "font-bold text-red-700";
                fbArea.className = "mt-8 p-5 rounded-2xl border-2 border-red-200 bg-red-50 block shadow-md";
            }
            fbRat.textContent = data.rat;
            fbRatVn.innerHTML = data.ratVn;
            
            setTimeout(() => {
                fbArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        nextBtn.onclick = () => {
            currentIdx++;
            if (currentIdx < quizData.length) render();
            else showResults();
        };

        function showResults() {
            progBar.style.width = "100%";
            quizCont.classList.add('hidden');
            resCont.classList.remove('hidden');
            viewBtn.classList.add('hidden');
            finalScoreEl.textContent = score;
            const emoji = document.getElementById('result-emoji');
            if (score >= 11) emoji.textContent = "ğŸ…";
            else if (score >= 8) emoji.textContent = "ğŸ¥ˆ";
            else emoji.textContent = "ğŸ“–";
        }

        viewBtn.onclick = () => {
            const data = quizData[currentIdx];
            if (!data) return;
            
            const passage = passages.find(p => p.id === data.pid);
            if (!passage) return;

            modalContent.innerHTML = `
                <h4 class="font-black text-indigo-700 mb-4 text-lg border-b-2 border-indigo-100 pb-2">${passage.title}</h4>
                <div class="leading-loose text-gray-700 text-sm whitespace-pre-wrap">${passage.template}</div>
            `;
            modal.classList.remove('hidden');
        };

        document.getElementById('close-modal-btn').onclick = () => modal.classList.add('hidden');
        window.onclick = (e) => { if (e.target === modal) modal.classList.add('hidden'); };
        
        window.onload = render;
    </script>
</body>
</html>

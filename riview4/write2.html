<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í•œêµ­ì–´ ì½ê¸° ì—°ìŠµ (ì£¼ê´€ì‹ ì‹¤ì „)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #f3f4f6;
        }
        .correct-box { border-color: #10b981 !important; background-color: #f0fdf4 !important; }
        .incorrect-box { border-color: #ef4444 !important; background-color: #fef2f2 !important; }
        .vietnamese { color: #64748b; font-size: 0.82rem; line-height: 1.4; margin-top: 4px; border-left: 2px solid #cbd5e1; padding-left: 8px; }
        .passage-box { background-color: #ffffff; border: 1px solid #e2e8f0; padding: 20px; border-radius: 12px; margin-top: 16px; font-size: 0.95rem; line-height: 1.7; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .highlight-blue { color: #2563eb; font-weight: 700; text-decoration: underline; }
        .highlight-yellow { background-color: #fef08a; padding: 0 4px; border-radius: 4px; font-weight: 700; color: #854d0e; }
        
        #answer-input {
            border: 2px solid #e2e8f0;
            transition: all 0.2s;
        }
        #answer-input:focus {
            border-color: #4f46e5;
            outline: none;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <div id="app" class="w-full max-w-md bg-white min-h-screen shadow-2xl flex flex-col relative">
        <!-- Header -->
        <div class="bg-indigo-600 p-5 text-white sticky top-0 z-30 shadow-md">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-lg font-bold">í•œêµ­ì–´ ì½ê¸° ì‹¤ì „</h1>
                    <p class="text-indigo-200 text-[10px] uppercase tracking-wider">ì£¼ê´€ì‹ ë¹ˆì¹¸ ì±„ìš°ê¸°</p>
                </div>
                <button id="view-text-btn" class="bg-white/20 px-3 py-2 rounded-lg text-xs font-bold border border-white/30 active:bg-white/40 transition">
                    ğŸ“‚ ì „ì²´ ì§€ë¬¸ ë³´ê¸°
                </button>
            </div>
            <div class="mt-4 bg-indigo-900/40 rounded-full h-1 w-full overflow-hidden">
                <div id="progress-bar" class="bg-yellow-400 h-1 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-container" class="flex-grow p-5 pb-24 overflow-y-auto">
            <div id="question-area">
                <div class="flex justify-between items-center mb-4">
                    <span id="question-category" class="text-indigo-600 text-[10px] font-black uppercase bg-indigo-50 px-2 py-1 rounded">CATEGORY</span>
                    <span id="q-count" class="text-xs font-bold text-gray-400 font-mono">01/12</span>
                </div>
                
                <div class="mb-6">
                    <h2 id="question-title" class="text-base font-bold text-gray-800 leading-tight"></h2>
                    <p id="question-title-vn" class="vietnamese italic mb-4"></p>
                    <div id="body-display-area"></div>
                </div>
                
                <!-- Input Area -->
                <div id="input-section" class="mt-6">
                    <label class="block text-sm font-bold text-gray-600 mb-2">ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”:</label>
                    <input type="text" id="answer-input" placeholder="ì—¬ê¸°ì— ì •ë‹µì„ ì“°ì„¸ìš”..." class="w-full p-4 rounded-xl text-lg font-medium">
                    <button id="submit-btn" class="mt-3 w-full bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg active:bg-indigo-700 transition">
                        í™•ì¸ (Kiá»ƒm tra)
                    </button>
                </div>
            </div>

            <!-- Feedback -->
            <div id="feedback-area" class="hidden mt-8 p-5 rounded-2xl border-2 shadow-sm animate-in fade-in slide-in-from-bottom-2 duration-300">
                <div class="flex items-center mb-2">
                    <span id="feedback-icon" class="text-2xl mr-2"></span>
                    <p id="feedback-status" class="font-bold text-base"></p>
                </div>
                <div class="mb-3">
                    <span class="text-xs font-bold text-gray-400">ì •ë‹µ:</span>
                    <span id="correct-answer-display" class="ml-2 font-bold text-indigo-600"></span>
                </div>
                <p id="feedback-rationale" class="text-gray-700 text-sm mb-1"></p>
                <div id="feedback-rationale-vn" class="vietnamese font-normal border-none"></div>
                <button id="next-btn" class="mt-6 w-full bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg active:bg-indigo-700">
                    ë‹¤ìŒ ë¬¸ì œ
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-container" class="hidden flex-grow flex flex-col p-6 overflow-y-auto">
            <div class="text-center py-8">
                <div class="text-7xl mb-4" id="result-emoji">ğŸ‰</div>
                <h2 class="text-2xl font-bold text-gray-800">ìµœì¢… ê²°ê³¼</h2>
                <div class="text-5xl font-black text-indigo-600 my-6">
                    <span id="final-score">0</span> / 12
                </div>
            </div>

            <div class="bg-gray-50 rounded-2xl p-4 mb-8">
                <h3 class="font-bold text-gray-700 mb-4 border-b pb-2">ë‚˜ì˜ ë‹µì•ˆ ë¦¬í¬íŠ¸</h3>
                <div id="result-list" class="space-y-4"></div>
            </div>

            <button onclick="location.reload()" class="bg-indigo-600 text-white w-full py-4 rounded-2xl font-bold shadow-xl active:bg-indigo-700 mb-10">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
        </div>

        <!-- Modal -->
        <div id="text-modal" class="hidden fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
            <div class="bg-white w-full max-w-md rounded-t-3xl sm:rounded-3xl max-h-[80vh] flex flex-col shadow-2xl relative">
                <div class="p-6 border-b flex justify-between items-center">
                    <h3 class="font-bold text-gray-800">ì§€ë¬¸ ì „ì²´ ë³´ê¸°</h3>
                    <button id="close-modal-btn" class="p-2 text-gray-400 bg-gray-100 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div id="modal-content" class="p-8 overflow-y-auto text-sm leading-loose text-gray-700 whitespace-pre-wrap"></div>
            </div>
        </div>
    </div>

    <script>
        const passages = [
            { id: 1, title: "ì‚¬ë‘ì˜ ì–¸ì–´", template: "ë‹¤ì„¯ ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ëŠ” ë§, ì„ ë¬¼, ìŠ¤í‚¨ì‹­, ë´‰ì‚¬, ê·¸ë¦¬ê³  ì‹œê°„ í•¨ê»˜ ë³´ë‚´ê¸°ì´ë‹¤. \n\nì‚¬ë‘ì˜ ì–¸ì–´ê°€ ë§ì¸ ì‚¬ëŒì€ â€˜ì‚¬ë‘í•´â€™, â€˜ë„Œ ì •ë§ ì¢‹ì€ ì‚¬ëŒì´ì•¼â€™ ë“±ì˜ ì¹­ì°¬ì´ë‚˜ ê²©ë ¤ì˜ ë§ì„ í•´ ì£¼ë©´ ì‚¬ë‘ë°›ê³  ìˆë‹¤ê³  ëŠë‚€ë‹¤. ì–´ë–¤ ì‚¬ëŒë“¤ì€ ì„ ë¬¼ì´ ì‚¬ë‘ì„ í‘œí˜„í•˜ëŠ” ë°©ë²•ì´ë¼ê³  ìƒê°í•´ì„œ í•­ìƒ í¬ê³  ì‘ì€ ì„ ë¬¼ì„ ì£¼ê³ ë°›ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤. \n\nìŠ¤í‚¨ì‹­ì´ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒë“¤ì€ ì†ì„ ì¡ê±°ë‚˜ íŒ”ì§±ì„ ë¼ëŠ” ê²ƒë§Œìœ¼ë¡œë„ í–‰ë³µí•´ì§„ë‹¤. í•˜ì§€ë§Œ ì–´ë–¤ ì‚¬ëŒì€ ì†ì„ ì¡ê±°ë‚˜ ì„ ë¬¼ì„ ë°›ëŠ” ê²ƒë³´ë‹¤ ìƒëŒ€ë°©ê³¼ í•¨ê»˜ ì‹œê°„ì„ ë³´ë‚´ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤. \n\nì–´ë–¤ ì‚¬ëŒë“¤ì€ ìƒëŒ€ë°©ì´ ìê¸°ë¥¼ ë„ì™€ì¤„ ë•Œ ì‚¬ë‘ì„ ëŠë‚€ë‹¤. ã‰ ì´ë“¤ì€ ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒì´ ìƒê¸°ë©´ ë§ì—†ì´ ìš”ë¦¬ë‚˜ ì²­ì†Œ ë“±ì„ í•´ ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ë‘ì„ í‘œí˜„í•œë‹¤." },
            { id: 2, title: "í¬ë¡œìŠ¤í•(CrossFit)", template: "â€˜í¬ë¡œìŠ¤í•â€™ì€ ë‹¬ë¦¬ê¸°ë‚˜ ì¤„ë„˜ê¸°, ì—­ë„ ê°™ì€ ì—¬ëŸ¬ ê°€ì§€ ìš´ë™ì„ ì„ì–´ì„œ ë§Œë“  ìš´ë™ í”„ë¡œê·¸ë¨ì´ë‹¤. ì´ ìš´ë™ì€ ëª¸ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì„ ê³¨ê³ ë£¨ ì“°ê¸° ë•Œë¬¸ì— ë‹¤ì´ì–´íŠ¸ì™€ ëª¸ë§¤ ë§Œë“¤ê¸°ì— íš¨ê³¼ì ì´ë‹¤. \n\nâ€˜í¬ë¡œìŠ¤í•â€™ ìš´ë™ ë°©ë²•ì˜ ì˜ˆëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë¨¼ì € íŒ”êµ½í˜€í´ê¸°ë¥¼ í•œ í›„ ì—­ê¸°ë¥¼ ë“ ë‹¤. ì²˜ìŒì—ëŠ” ê°€ë²¼ìš´ ì—­ê¸°ë¡œ ì‹œì‘í•˜ì§€ë§Œ ì ì  ë¬´ê±°ìš´ ì—­ê¸°ë¡œ ë°”ê¿”ì„œ ( ã‰  ) ë™ì‘ì„ ë°˜ë³µí•œë‹¤. \n\nê·¸ ë‹¤ìŒì— ìœ—ëª¸ ì¼ìœ¼í‚¤ê¸°ë¥¼ í•œ í›„ ì² ë´‰ì— ë§¤ë‹¬ë¦¬ê±°ë‚˜ ì‘ì€ ë¤ë²¨ì„ ë“¤ê³  íŒ”ì„ ì˜¬ë ¸ë‹¤ê°€ ë‚´ë¦¬ëŠ” ë™ì‘ì„ ì—¬ëŸ¬ ë²ˆ í•œë‹¤." },
            { id: 3, title: "êµìˆ˜ë‹˜ì—ê²Œ ë¬¸ì˜ ì´ë©”ì¼", template: "êµìˆ˜ë‹˜, ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ? ì €ëŠ” íˆì—”ì´ë¼ê³  í•©ë‹ˆë‹¤. \n\nìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³  ë©”ì¼ì„ ì”ë‹ˆë‹¤. ìˆ™ì œëŠ” ë‹¤ìŒ ì£¼ì— ( ã‰  )? \n\në‹µì¥ì„ ( ã‰¡ ). ì•ˆë…•íˆ ê³„ì‹­ì‹œì˜¤." },
            { id: 4, title: "ì²­ì²©ì¥ ë‚´ìš©", template: "ë“œë””ì–´ ê²°í˜¼í•©ë‹ˆë‹¤. \n\në‘ ì‚¬ëŒì´ ë§Œë‚˜ì„œ í•˜ë‚˜ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëœ ì—°ì•  ëì— ì €í¬ê°€ ( ã‰  ). ë°”ì˜ì‹œê² ì§€ë§Œ ê¼­ ( ã‰¡ ). \n\nï‚Ÿ ì‹ ë‘ : ê¹€ì² ìˆ˜  ï‚Ÿ ì‹ ë¶€ : ì´ì˜í¬ \nï‚Ÿ ì¼ì‹œ : 12ì›” 25ì¼ ì˜¤í›„ 2ì‹œ \nï‚Ÿ ì¥ì†Œ : í–‰ë³µì›¨ë”©í™€" }
        ];

        const quizData = [
            { pid: 1, q: "ë¹ˆì¹¸ ( ã‰  )ì— ì•Œë§ì€ ë§ì€?", vn: "HÃ£y viáº¿t tá»« thÃ­ch há»£p cho khoáº£ng trá»‘ng ( ã‰  ).", displayType: "blank", body: "ë‹¤ì„¯ ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ëŠ” ë§, ì„ ë¬¼, ìŠ¤í‚¨ì‹­, ë´‰ì‚¬, ê·¸ë¦¬ê³  ( ã‰  )ì´ë‹¤.", ans: "ì‹œê°„ í•¨ê»˜ ë³´ë‚´ê¸°", rat: "ì§€ë¬¸ ë„ì…ë¶€ì—ì„œ ì œì‹œëœ 5ê°€ì§€ ì‚¬ë‘ì˜ ì–¸ì–´ ì¤‘ ë§ˆì§€ë§‰ ìš”ì†Œì…ë‹ˆë‹¤.", ratVn: "LÃ  yáº¿u tá»‘ cuá»‘i cÃ¹ng trong 5 ngÃ´n ngá»¯ tÃ¬nh yÃªu." },
            { pid: 1, q: "ë°‘ì¤„ ì¹œ ã‰ â€˜ì´ë“¤ì€â€™ì´ ê°€ë¦¬í‚¤ëŠ” ì‚¬ëŒì€?", vn: "Cá»¥m tá»« 'Nhá»¯ng ngÆ°á»i nÃ y' chá»‰ nhÃ³m ngÆ°á»i nÃ o?", displayType: "blank", body: "ì–´ë–¤ ì‚¬ëŒë“¤ì€ ìƒëŒ€ë°©ì´ ìê¸°ë¥¼ ë„ì™€ì¤„ ë•Œ ì‚¬ë‘ì„ ëŠë‚€ë‹¤. [ ã‰ ì´ë“¤ì€ ] ìš”ë¦¬ë‚˜ ì²­ì†Œ ë“±ì„ í•´ ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì‚¬ë‘ì„ í‘œí˜„í•œë‹¤.", ans: "ë´‰ì‚¬ê°€ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒ", rat: "ìƒëŒ€ë°©ì„ ë„ì™€ì£¼ëŠ” í–‰ìœ„ë¥¼ í†µí•´ ì‚¬ë‘ì„ í‘œí˜„í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.", ratVn: "Chá»‰ nhÃ³m ngÆ°á»i thá»ƒ hiá»‡n tÃ¬nh yÃªu qua viá»‡c phá»¥c vá»¥." },
            { pid: 1, q: "ë§ì´ ì‚¬ë‘ì˜ ì–¸ì–´ì¸ ì‚¬ëŒì´ ì¢‹ì•„í•˜ëŠ” ë§ì€?", vn: "NgÆ°á»i cÃ³ ngÃ´n ngá»¯ lá»i nÃ³i thÃ­ch nghe Ä‘iá»u gÃ¬?", displayType: "inline", body: "ì‚¬ë‘ì˜ ì–¸ì–´ê°€ ë§ì¸ ì‚¬ëŒì€ â€˜ì‚¬ë‘í•´â€™, â€˜ë„Œ ì •ë§ ì¢‹ì€ ì‚¬ëŒì´ì•¼â€™ ê°™ì€ (      )ì„ ë“¤ì„ ë•Œ í–‰ë³µí•´í•©ë‹ˆë‹¤.", ans: "ì¹­ì°¬ì´ë‚˜ ê²©ë ¤ì˜ ë§", rat: "ê¸ì •ì ì¸ ê°ì •ì„ ì „ë‹¬í•˜ëŠ” ë§ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.", ratVn: "NghÄ©a lÃ  nhá»¯ng lá»i truyá»n Ä‘áº¡t cáº£m xÃºc tÃ­ch cá»±c." },
            { pid: 2, q: "í¬ë¡œìŠ¤í•ì˜ íŠ¹ì§• ë¹ˆì¹¸ì„ ì±„ìš°ì„¸ìš”.", vn: "Äiá»n vÃ o khoáº£ng trá»‘ng vá» Ä‘áº·c Ä‘iá»ƒm cá»§a CrossFit.", displayType: "inline", body: "ì´ ìš´ë™ì€ ëª¸ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì„ (      ) ì“°ê¸° ë•Œë¬¸ì— ë‹¤ì´ì–´íŠ¸ì— íš¨ê³¼ì ì´ë‹¤.", ans: "ê³¨ê³ ë£¨", rat: "ì‹ ì²´ ì „ì²´ë¥¼ ê· í˜• ìˆê²Œ ì‚¬ìš©í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.", ratVn: "NghÄ©a lÃ  sá»­ dá»¥ng cÆ¡ thá»ƒ má»™t cÃ¡ch cÃ¢n báº±ng." },
            { pid: 2, q: "ë¹ˆì¹¸ ( ã‰  )ì— ë“¤ì–´ê°ˆ ë™ì‘ì€?", vn: "Äá»™ng tÃ¡c nÃ o phÃ¹ há»£p cho khoáº£ng trá»‘ng ( ã‰  )?", displayType: "blank", body: "ê°€ë²¼ìš´ ì—­ê¸°ë¡œ ì‹œì‘í•˜ì§€ë§Œ ì ì  ë¬´ê±°ìš´ ì—­ê¸°ë¡œ ë°”ê¿”ì„œ [ ã‰  ] ë™ì‘ì„ ë°˜ë³µí•œë‹¤.", ans: "íŒ”ì„ êµ½í˜”ë‹¤ í´ëŠ”", rat: "ì—­ê¸° ìš´ë™ì˜ ê¸°ë³¸ì ì¸ ê·¼ìœ¡ ì‚¬ìš© ë™ì‘ì…ë‹ˆë‹¤.", ratVn: "Giáº£i thÃ­ch Ä‘á»™ng tÃ¡c gáº­p vÃ  duá»—i tay khi táº­p táº¡." },
            { pid: 2, q: "ë³¸ë¬¸ì— ì–¸ê¸‰ë˜ì§€ ì•Šì€ ìš´ë™ ì¢…ëª©ì€?", vn: "MÃ´n thá»ƒ thao nÃ o KHÃ”NG cÃ³ trong bÃ i?", displayType: "inline", body: "ë‹¬ë¦¬ê¸°, ì¤„ë„˜ê¸°, ì—­ë„ ë“±ì€ ë‚˜ì˜¤ì§€ë§Œ (      )ì€ ì–¸ê¸‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.", ans: "ìˆ˜ì˜", rat: "ì§€ë¬¸ ë‚´ìš© ì¤‘ í¬í•¨ë˜ì§€ ì•Šì€ ë‹¤ë¥¸ ìš´ë™ì„ ê³ ë¥´ëŠ” ì›ë¦¬ì…ë‹ˆë‹¤.", ratVn: "MÃ´n bÆ¡i lá»™i khÃ´ng Ä‘Æ°á»£c nháº¯c Ä‘áº¿n trong bÃ i." },
            { pid: 3, q: "íˆì—” ì”¨ê°€ ì´ë©”ì¼ì„ ì“´ ëª©ì ì€?", vn: "Má»¥c Ä‘Ã­ch Hien viáº¿t email lÃ  gÃ¬?", displayType: "inline", body: "íˆì—” ì”¨ëŠ” êµìˆ˜ë‹˜ê»˜ (      ) ë¬¼ì–´ë³´ë ¤ê³  ë©”ì¼ì„ ì¼ìŠµë‹ˆë‹¤.", ans: "ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼", rat: "'ìˆ™ì œ ì œì¶œ ë‚ ì§œë¥¼ ë¬¼ì–´ë³´ë ¤ê³ 'ë¼ê³  ëª…ì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.", ratVn: "Trong bÃ i cÃ³ ghi rÃµ 'Ä‘á»ƒ há»i vá» ngÃ y ná»™p bÃ i táº­p'." },
            { pid: 3, q: "ë¹ˆì¹¸ ( ã‰  )ì— ë“¤ì–´ê°ˆ ì í•©í•œ í‘œí˜„ì€?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰  ) lÃ  gÃ¬?", displayType: "blank", body: "ìˆ™ì œëŠ” ë‹¤ìŒ ì£¼ì— [ ã‰  ]?", ans: "ì œì¶œí•´ë„ ë©ë‹ˆê¹Œ", rat: "í—ˆë½ì„ êµ¬í•˜ëŠ” ì •ì¤‘í•œ ì˜ë¬¸ë¬¸ì…ë‹ˆë‹¤.", ratVn: "CÃ¢u há»i lá»‹ch sá»± Ä‘á»ƒ xin phÃ©p ná»™p bÃ i." },
            { pid: 3, q: "ë¹ˆì¹¸ ( ã‰¡ )ì— ë“¤ì–´ê°ˆ ë§ˆì¹¨í‘œëŠ”?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰¡ ) lÃ  gÃ¬?", displayType: "blank", body: "êµìˆ˜ë‹˜ì˜ ë‹µì¥ì„ [ ã‰¡ ].", ans: "ê¸°ë‹¤ë¦¬ê² ìŠµë‹ˆë‹¤", rat: "ë‹µì‹ ì„ ìš”ì²­í•˜ë©° ë§ˆë¬´ë¦¬í•˜ëŠ” ì •ì¤‘í•œ í‘œí˜„ì…ë‹ˆë‹¤.", ratVn: "CÃ¡ch káº¿t thÃºc email mong Ä‘á»£i pháº£n há»“i." },
            { pid: 4, q: "ì´ ê¸€ì˜ ì¢…ë¥˜ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?", vn: "VÄƒn báº£n nÃ y thuá»™c loáº¡i gÃ¬?", displayType: "inline", body: "ì´ ê¸€ì€ ê²°í˜¼ ì†Œì‹ì„ ì•Œë¦¬ëŠ” (      )ì…ë‹ˆë‹¤.", ans: "ì²­ì²©ì¥", rat: "ê²°í˜¼ì‹ì— ì´ˆëŒ€í•˜ëŠ” ëª©ì ì˜ ê¸€ì…ë‹ˆë‹¤.", ratVn: "VÄƒn báº£n má»i dá»± Ä‘Ã¡m cÆ°á»›i." },
            { pid: 4, q: "ë¹ˆì¹¸ ( ã‰  )ì— ë“¤ì–´ê°ˆ ë§ì€?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰  ) lÃ  gÃ¬?", displayType: "blank", body: "ì˜¤ëœ ì—°ì•  ëì— ì €í¬ê°€ [ ã‰  ].", ans: "ê²°í˜¼ì„ í•©ë‹ˆë‹¤", rat: "í•µì‹¬ ì£¼ì œì¸ ê²°í˜¼ì„ ì„ ì–¸í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤.", ratVn: "Pháº§n thÃ´ng bÃ¡o vá» viá»‡c káº¿t hÃ´n." },
            { pid: 4, q: "ë¹ˆì¹¸ ( ã‰¡ )ì— ë“¤ì–´ê°ˆ ì´ˆëŒ€ ë¬¸êµ¬ëŠ”?", vn: "ÄÃ¡p Ã¡n cho khoáº£ng trá»‘ng ( ã‰¡ ) lÃ  gÃ¬?", displayType: "blank", body: "ë°”ì˜ì‹œê² ì§€ë§Œ ê¼­ [ ã‰¡ ].", ans: "ì°¸ì„í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤", rat: "ì†ë‹˜ì—ê²Œ ë°©ë¬¸ì„ ìš”ì²­í•˜ëŠ” ì •ì¤‘í•œ í‘œí˜„ì…ë‹ˆë‹¤.", ratVn: "Lá»i má»i lá»‹ch sá»± khÃ¡ch Ä‘áº¿n dá»±." }
        ];

        let currentIdx = 0;
        let score = 0;
        let userRecords = [];

        const catEl = document.getElementById('question-category');
        const qCountEl = document.getElementById('q-count');
        const qTitleEl = document.getElementById('question-title');
        const qTitleVnEl = document.getElementById('question-title-vn');
        const bodyArea = document.getElementById('body-display-area');
        const inputSec = document.getElementById('input-section');
        const ansInput = document.getElementById('answer-input');
        const submitBtn = document.getElementById('submit-btn');
        const fbArea = document.getElementById('feedback-area');
        const fbStatus = document.getElementById('feedback-status');
        const fbIcon = document.getElementById('feedback-icon');
        const fbRat = document.getElementById('feedback-rationale');
        const fbRatVn = document.getElementById('feedback-rationale-vn');
        const correctAnsDisp = document.getElementById('correct-answer-display');
        const nextBtn = document.getElementById('next-btn');
        const progBar = document.getElementById('progress-bar');
        const quizCont = document.getElementById('quiz-container');
        const resCont = document.getElementById('result-container');
        const finalScoreEl = document.getElementById('final-score');
        const modal = document.getElementById('text-modal');
        const modalContent = document.getElementById('modal-content');

        function render() {
            const data = quizData[currentIdx];
            const passage = passages.find(p => p.id === data.pid);
            
            catEl.textContent = passage.title;
            qCountEl.textContent = `${(currentIdx + 1).toString().padStart(2, '0')}/${quizData.length}`;
            qTitleEl.textContent = data.q;
            qTitleVnEl.textContent = data.vn;
            
            bodyArea.innerHTML = `<div class="passage-box bg-slate-50 border-slate-200">${data.body}</div>`;

            fbArea.classList.add('hidden');
            inputSec.classList.remove('hidden');
            ansInput.value = '';
            ansInput.disabled = false;
            submitBtn.disabled = false;
            progBar.style.width = `${(currentIdx / quizData.length) * 100}%`;
            
            setTimeout(() => ansInput.focus(), 100);
            window.scrollTo(0, 0);
        }

        function check() {
            const data = quizData[currentIdx];
            const userAns = ansInput.value.trim();
            if (!userAns) return;

            ansInput.disabled = true;
            submitBtn.disabled = true;
            inputSec.classList.add('hidden');

            const isCorrect = userAns.replace(/\s/g, '') === data.ans.replace(/\s/g, '');
            
            userRecords.push({
                bodySnippet: data.body,
                userAns: userAns,
                correctAns: data.ans,
                isCorrect: isCorrect
            });

            if (isCorrect) {
                fbIcon.innerHTML = "ğŸ¯";
                fbStatus.textContent = "ì •ë‹µì…ë‹ˆë‹¤!";
                fbStatus.className = "font-bold text-green-700";
                fbArea.className = "mt-8 p-5 rounded-2xl border-2 border-green-200 bg-green-50 block shadow-md";
                score++;
            } else {
                fbIcon.innerHTML = "ğŸ’¡";
                fbStatus.textContent = "ì˜¤ë‹µì…ë‹ˆë‹¤.";
                fbStatus.className = "font-bold text-red-700";
                fbArea.className = "mt-8 p-5 rounded-2xl border-2 border-red-200 bg-red-50 block shadow-md";
            }
            
            correctAnsDisp.textContent = data.ans;
            fbRat.textContent = data.rat;
            fbRatVn.innerHTML = data.ratVn;
            
            setTimeout(() => fbArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 100);
        }

        submitBtn.onclick = check;
        ansInput.onkeypress = (e) => { if (e.key === 'Enter') check(); };

        nextBtn.onclick = () => {
            currentIdx++;
            if (currentIdx < quizData.length) render();
            else showResults();
        };

        function showResults() {
            progBar.style.width = "100%";
            quizCont.classList.add('hidden');
            resCont.classList.remove('hidden');
            document.getElementById('view-text-btn').classList.add('hidden');
            finalScoreEl.textContent = score;
            
            const listEl = document.getElementById('result-list');
            listEl.innerHTML = '';
            
            userRecords.forEach((rec, i) => {
                const item = document.createElement('div');
                item.className = `p-4 rounded-xl border ${rec.isCorrect ? 'correct-box' : 'incorrect-box'}`;
                item.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-[10px] font-bold text-gray-400">ë¬¸ì œ ${i+1}</span>
                        <span>${rec.isCorrect ? 'âœ…' : 'âŒ'}</span>
                    </div>
                    <div class="text-[11px] text-gray-500 mb-2 truncate">${rec.bodySnippet}</div>
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <div class="bg-white/60 p-2 rounded">
                            <p class="text-[9px] text-gray-400 uppercase">ë‚´ê°€ ì“´ ë‹µ</p>
                            <p class="${rec.isCorrect ? 'text-green-700' : 'text-red-700'} font-bold">${rec.userAns || '(ì—†ìŒ)'}</p>
                        </div>
                        <div class="bg-white/60 p-2 rounded">
                            <p class="text-[9px] text-gray-400 uppercase">ì •ë‹µ</p>
                            <p class="text-indigo-700 font-bold">${rec.correctAns}</p>
                        </div>
                    </div>
                `;
                listEl.appendChild(item);
            });
        }

        document.getElementById('view-text-btn').onclick = () => {
            const data = quizData[currentIdx];
            const passage = passages.find(p => p.id === data.pid);
            modalContent.innerHTML = `
                <h4 class="font-black text-indigo-700 mb-4 text-lg border-b-2 border-indigo-100 pb-2">${passage.title}</h4>
                <div class="leading-loose text-gray-700 text-sm">${passage.template}</div>
            `;
            modal.classList.remove('hidden');
        };

        document.getElementById('close-modal-btn').onclick = () => modal.classList.add('hidden');
        window.onclick = (e) => { if (e.target === modal) modal.classList.add('hidden'); };
        
        window.onload = render;
    </script>
</body>
</html>

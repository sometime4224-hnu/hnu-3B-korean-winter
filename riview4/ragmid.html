<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÌïúÍµ≠Ïñ¥ ÏùΩÍ∏∞ Ïó∞Ïäµ (Level 3)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #f3f4f6;
        }
        .correct { background-color: #d1fae5 !important; border-color: #10b981 !important; color: #065f46 !important; }
        .incorrect { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b !important; }
        .vietnamese { color: #64748b; font-size: 0.82rem; line-height: 1.4; margin-top: 4px; border-left: 2px solid #cbd5e1; padding-left: 8px; }
        .blank-title { color: #2563eb; font-weight: 700; border: 2px dashed #2563eb; padding: 4px 12px; border-radius: 6px; background-color: #eff6ff; display: inline-block; }
        .passage-box { background-color: #ffffff; border: 1px solid #e2e8f0; padding: 20px; border-radius: 12px; margin-top: 16px; font-size: 0.95rem; line-height: 1.7; shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .option-btn { transition: all 0.1s; border-width: 2px; }
        .option-btn:active { transform: scale(0.98); }
        .highlight-blue { color: #2563eb; font-weight: 700; text-decoration: underline; }
        .highlight-yellow { background-color: #fef08a; padding: 0 4px; border-radius: 4px; font-weight: 700; color: #854d0e; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <div id="app" class="w-full max-w-md bg-white min-h-screen shadow-2xl flex flex-col relative">
        <!-- Header -->
        <div class="bg-indigo-600 p-5 text-white sticky top-0 z-30 shadow-md">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-lg font-bold">ÌïúÍµ≠Ïñ¥ ÏùΩÍ∏∞ ÌÄ¥Ï¶à</h1>
                    <p class="text-indigo-200 text-[10px] uppercase tracking-wider">Ti·∫øng H√†n Trung c·∫•p 3</p>
                </div>
                <button id="view-text-btn" class="bg-white/20 px-3 py-2 rounded-lg text-xs font-bold border border-white/30 active:bg-white/40 transition">
                    üìÇ ÏßÄÎ¨∏ Î≥¥Í∏∞ (Xem b√†i)
                </button>
            </div>
            <div class="mt-4 bg-indigo-900/40 rounded-full h-1 w-full overflow-hidden">
                <div id="progress-bar" class="bg-yellow-400 h-1 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quiz-container" class="flex-grow p-5 pb-24 overflow-y-auto">
            <div id="question-area">
                <div class="flex justify-between items-center mb-4">
                    <span id="question-category" class="text-indigo-600 text-[10px] font-black uppercase bg-indigo-50 px-2 py-1 rounded">CATEGORY</span>
                    <span id="q-count" class="text-xs font-bold text-gray-400 font-mono">01/12</span>
                </div>
                
                <!-- Question Section -->
                <div class="mb-6">
                    <h2 id="question-title" class="text-base font-bold text-gray-800 leading-tight"></h2>
                    <p id="question-title-vn" class="vietnamese italic mb-4"></p>
                    
                    <div id="body-display-area">
                        <!-- Content Injected Here -->
                    </div>
                </div>
                
                <div id="options-grid" class="space-y-3 mt-6">
                    <!-- Shuffled Options -->
                </div>
            </div>

            <!-- Feedback -->
            <div id="feedback-area" class="hidden mt-8 p-5 rounded-2xl border-2 shadow-sm animate-in fade-in slide-in-from-bottom-2 duration-300">
                <div class="flex items-center mb-2">
                    <span id="feedback-icon" class="text-2xl mr-2"></span>
                    <p id="feedback-status" class="font-bold text-base"></p>
                </div>
                <p id="feedback-rationale" class="text-gray-700 text-sm mb-1"></p>
                <div id="feedback-rationale-vn" class="vietnamese font-normal border-none"></div>
                <button id="next-btn" class="mt-6 w-full bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg active:bg-indigo-700">
                    Îã§Ïùå Î¨∏Ï†ú (Ti·∫øp theo)
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-container" class="hidden flex-grow flex flex-col items-center justify-center p-10 text-center">
            <div class="text-7xl mb-6" id="result-emoji">üéâ</div>
            <h2 class="text-2xl font-bold text-gray-800">ÌÖåÏä§Ìä∏ Ï¢ÖÎ£å</h2>
            <p class="text-gray-500 text-sm mt-1">Ho√†n th√†nh b√†i t·∫≠p ƒë·ªçc hi·ªÉu!</p>
            <div class="text-5xl font-black text-indigo-600 my-10">
                <span id="final-score">0</span> / 12
            </div>
            <button onclick="location.reload()" class="bg-indigo-600 text-white w-full py-4 rounded-2xl font-bold shadow-xl active:bg-indigo-700">Îã§Ïãú ÌïòÍ∏∞ (L√†m l·∫°i)</button>
        </div>

        <!-- Full Text Modal -->
        <div id="text-modal" class="hidden fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
            <div class="bg-white w-full max-w-md rounded-t-3xl sm:rounded-3xl max-h-[80vh] flex flex-col shadow-2xl relative">
                <div class="p-6 border-b flex justify-between items-center">
                    <h3 class="font-bold text-gray-800">Ï†ÑÏ≤¥ ÏßÄÎ¨∏ Î≥¥Í∏∞ (Xem b√†i ƒë·ªçc)</h3>
                    <button id="close-modal-btn" class="p-2 text-gray-400 bg-gray-100 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div id="modal-content" class="p-8 overflow-y-auto text-sm leading-loose text-gray-700 whitespace-pre-wrap"></div>
            </div>
        </div>
    </div>

    <script>
        const passages = [
            { id: 1, title: "Ïó∞Ïï† ÏπºÎüº", template: "ÏÇ¨ÎûëÏóê Îπ†ÏßÑ Ïó∞Ïù∏Îì§ÏùÄ ÏÑúÎ°úÏùò ÏÇ¨ÎûëÏù¥ ÏòÅÏõêÌï† Í±∞ÎùºÍ≥† ÏÉùÍ∞ÅÌï©ÎãàÎã§. ÌïòÏßÄÎßå ÏÇ¨ÎûëÏóêÎèÑ {0}Í∞Ä ÏûàÎã§Í≥† Ìï©ÎãàÎã§. Îú®Í≤ÅÍ≤å ÏÇ¨ÎûëÌïòÎçò ÏÇ¨ÎûåÎì§ÎèÑ ÏãúÍ∞ÑÏù¥ ÏßÄÎÇòÎ©¥ ÏÑ§Î†àÎäî ÎßàÏùåÏù¥ Ï§ÑÏñ¥Îì§Í∏∞ ÎïåÎ¨∏ÏûÖÎãàÎã§. \n\nÏù¥ ÎïåÎ¨∏Ïóê ÏÇ¨ÎûëÏù¥ ÏãùÏóàÎã§Í≥† ÏÉùÍ∞ÅÌï¥ÏÑú Ìó§Ïñ¥ÏßÄÎäî Ïó∞Ïù∏Îì§Ïù¥ ÎßéÏäµÎãàÎã§. {1} Ïù¥Í≤ÉÏùÄ ÏÇ¨ÎûëÏù¥ ÎÅùÎÇú Í≤ÉÏù¥ ÏïÑÎãàÎùº ÍπäÏñ¥ÏßÄÎäî Í≥ºÏ†ïÏûÖÎãàÎã§. \n\nÎ≥¥ÌÜµ Ïó¨ÏûêÎäî ÎÇ®ÏûêÏùò ÎßàÏùåÏù¥ Î≥ÄÌñàÎã§Í≥† ÎäêÎÇÑ Îïå {2} ÏÉùÍ∞ÅÏùÑ ÌïòÍ≥†, ÎÇ®ÏûêÎäî Ïó¨ÏûêÏôÄ ÏÑ±Í≤©Ïù¥ Ïïà ÎßûÏùÑ Îïå Ïù¥Î≥ÑÏùÑ Í≥†ÎØºÌïúÎã§Í≥† Ìï©ÎãàÎã§.", answers: ["Ïú†ÌÜµ Í∏∞Ìïú", "Í∑∏Îü¨ÎÇò Ïù¥Îü∞ Î≥ÄÌôîÎäî", "Ìó§Ïñ¥Ïßà"], questionIndices: [0, 1, 2] },
            { id: 2, title: "Î™© Í±¥Í∞ï", template: "ÏöîÏ¶ò ÎßéÏùÄ ÏÇ¨ÎûåÎì§Ïù¥ Î™©Ïùò ÌÜµÏ¶ùÏùÑ ÎäêÎÇçÎãàÎã§. Ïª¥Ìì®ÌÑ∞Î•º Î≥º Îïå Í±∞Î∂ÅÏ≤òÎüº {0} ÏûòÎ™ªÎêú ÏûêÏÑ∏Î•º Ïò§Îûò Ïú†ÏßÄÌïòÍ∏∞ ÎïåÎ¨∏ÏûÖÎãàÎã§. \n\nÏù¥Îü∞ ÌÜµÏ¶ùÏùÑ ÏòàÎ∞©ÌïòÎ†§Î©¥ ÏûêÏÑ∏ ÍµêÏ†ïÏù¥ ÌïÑÏàòÏ†ÅÏûÖÎãàÎã§. ÌäπÌûà ÎßëÏùÄ Í≥µÍ∏∞Î•º ÎßàÏãúÎ©∞ {1} Ï†ÑÏã†Ïùò ÏûêÏÑ∏Î•º Î∞îÎ°úÏû°Îäî Îç∞ Îß§Ïö∞ Ìö®Í≥ºÏ†ÅÏûÖÎãàÎã§. \n\nÎòêÌïú Ïä§Ìä∏Î†àÏπ≠ÏùÑ {2} Í≤ÉÎèÑ Î™© Í±¥Í∞ïÏùÑ ÏßÄÌÇ§Îäî Ï¢ãÏùÄ ÏäµÍ¥ÄÏûÖÎãàÎã§.", answers: ["Î™©ÏùÑ ÏïûÏúºÎ°ú Í∏∏Í≤å ÎπºÍ≥†", "Í±∑Í∏∞ Ïö¥ÎèôÏùÑ ÌïòÎ©¥", "Ïó¨Îü¨ Î≤à Î∞òÎ≥µÌïòÎäî"], questionIndices: [3, 4, 5] },
            { id: 3, title: "ÎèôÎ¨º ÏÇ¨Îûë Î∞îÏûêÌöå", template: "Ï†ÄÌù¨ ‚ÄòÎèôÏÇ¨Î™®‚ÄôÎäî {0} ÏÇ¨ÎûåÎì§Ïù¥ Î™®Ïó¨ÏÑú Î≤ÑÎ†§ÏßÑ ÎèôÎ¨ºÏùÑ ÎèåÎ≥¥Îäî ÏùºÏùÑ Ìï©ÎãàÎã§. Îß§ÎÖÑ Î∞îÏûêÌöåÎ•º Ïó¥Ïñ¥ÏÑú ÎèôÎ¨º Î≥¥Ìò∏ Í∏∞Í∏àÎèÑ ÎßàÎ†®ÌïòÍ≥† Î≤ÑÎ†§ÏßÑ ÎèôÎ¨ºÏóêÍ≤å ÏÉà Ï£ºÏù∏ÏùÑ Ï∞æÏïÑ Ï£ºÍ≥† ÏûàÏäµÎãàÎã§.\n\nÍ≤ΩÌóòÏù¥ ÏóÜÏñ¥ {1} ÏóÜÏùÑÍπå Î¥ê Í±±Ï†ïÌïòÏãúÎäî Î∂ÑÎì§ÏùÑ ÏúÑÌï¥ Ïó¨Îü¨ Í∞ÄÏßÄ ÎèÑÏõÄÎèÑ ÎìúÎ¶ΩÎãàÎã§. Ïù¥Î≤à ÏàòÏùµÍ∏àÏùÄ Î≤ÑÎ†§ÏßÑ ÎèôÎ¨ºÍ≥º {2} Î≥¥Ìò∏ÌïòÎäî Îç∞ Ïì∞ÏûÖÎãàÎã§.", answers: ["ÎèôÎ¨ºÏùÑ ÏÇ¨ÎûëÌïòÎäî", "ÎèôÎ¨ºÏùÑ Ïûò ÎèåÎ≥º Ïàò", "Î©∏Ï¢Ö ÏúÑÍ∏∞ ÎèôÎ¨ºÏùÑ"], questionIndices: [6, 7, 8] },
            { id: 4, title: "ÏÑ±Í≥µ ÎπÑÍ≤∞", template: "ÏßÅÏû•Ïù∏Îì§Ïùò ÏÑ±Í≥µ ÎπÑÍ≤∞ÏùÄ ÌÅ¨Í≤å Îëê Í∞ÄÏßÄÍ∞Ä ÏûàÏäµÎãàÎã§.\n\n‚Ö†. {0}\nÌöåÏÇ¨ÏóêÏÑú ÏûëÏùÄ ÏπúÏ†àÏùÑ Î≤†Ìë∏Îäî ÏÇ¨ÎûåÏù¥ ÎÇòÏ§ëÏóê ÌÅ∞ ÎèÑÏõÄÏùÑ Î∞õÏïÑ ÏÑ±Í≥µÌï©ÎãàÎã§.\n\n‚Ö°. {1}\nÏßÅÏû•Ïù∏Îì§ÏùÄ Îß§ÎÖÑ ÌèâÍ∑† 16Í∂åÏùò Ï±ÖÏùÑ ÏùΩÏúºÎ©∞ ÏßÄÏãùÏùÑ ÏåìÏäµÎãàÎã§. ÏßÄÏãùÏùÑ ÏåìÎäî Í≤ÉÏùÄ {2} Îß§Ïö∞ Ï§ëÏöîÌï©ÎãàÎã§.", answers: ["ÏπúÏ†àÌïú ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", "Íæ∏Ï§ÄÌûà ÎèÖÏÑúÌïòÎäî ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", "ÏÑ±Í≥µÏùÑ ÏúÑÌï¥"], questionIndices: [9, 10, 11] }
        ];

        const quizData = [
            // Q1~Q3: Ïó∞Ïï† ÏπºÎüº
            { pid: 1, q: "ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn t·ª´ th√≠ch h·ª£p cho kho·∫£ng tr·ªëng.", displayType: "inline", body: "ÏÇ¨ÎûëÏóê Îπ†ÏßÑ Ïó∞Ïù∏Îì§ÏùÄ ÏÇ¨ÎûëÏù¥ ÏòÅÏõêÌï† Í±∞ÎùºÍ≥† ÎØøÏßÄÎßå, Ï†ÑÎ¨∏Í∞ÄÎì§ÏùÄ ÏÇ¨ÎûëÏóêÎèÑ (      )Í∞Ä ÏûàÎã§Í≥† ÎßêÌï©ÎãàÎã§. ÏãúÍ∞ÑÏù¥ ÌùêÎ•¥Î©¥ Îú®Í±∞Ïö¥ Í∞êÏ†ïÏù¥ Î≥ÄÌïòÍ∏∞ ÎïåÎ¨∏ÏûÖÎãàÎã§.", options: ["Ïú†ÌÜµ Í∏∞Ìïú", "ÏÇ¨Ïö© Î∞©Î≤ï", "Í≤∞Ìòº ÎÇ†Ïßú", "ÎπÑÎ∞ÄÎ≤àÌò∏"], ans: "Ïú†ÌÜµ Í∏∞Ìïú", rat: "ÏãúÍ∞ÑÏù¥ ÏßÄÎÇòÎ©¥ Î≥ÄÌïòÎäî Í≤ÉÏùÑ ÏùåÏãùÏóê ÎπÑÏú†Ìïú ÌëúÌòÑÏûÖÎãàÎã§.", ratVn: "S·ª≠ d·ª•ng t·ª´ **Ïú†ÌÜµ Í∏∞Ìïú** ƒë·ªÉ so s√°nh t√¨nh y√™u thay ƒë·ªïi theo th·ªùi gian v·ªõi th·ª±c ph·∫©m." },
            { pid: 1, q: "ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn c·ª•m t·ª´ th√≠ch h·ª£p.", displayType: "inline", body: "ÏÇ¨ÎûëÏù¥ ÏãùÏóàÎã§Í≥† ÏÉùÍ∞ÅÌï¥ÏÑú Ìó§Ïñ¥ÏßÄÎäî Ïó∞Ïù∏Îì§Ïù¥ ÎßéÏäµÎãàÎã§. (      ) Ïù¥Í≤ÉÏùÄ ÏÇ¨ÎûëÏù¥ ÎÅùÎÇú Í≤ÉÏù¥ ÏïÑÎãàÎùº ÍπäÏñ¥ÏßÄÎäî Í≥ºÏ†ï Ï§ë ÌïòÎÇòÏûÖÎãàÎã§.", options: ["Í∑∏ÎûòÏÑú Ïù¥Îü∞ ÏãúÏûëÏùÄ", "ÌïòÏßÄÎßå Ïù¥Îü∞ ÎßåÎÇ®ÏùÄ", "Í∑∏Îü¨ÎÇò Ïù¥Îü∞ Î≥ÄÌôîÎäî", "Í∑∏Îü¨ÎØÄÎ°ú Ïù¥Îü∞ Ïù¥Î≥ÑÏùÄ"], ans: "Í∑∏Îü¨ÎÇò Ïù¥Îü∞ Î≥ÄÌôîÎäî", rat: "ÏïûÏùò Î∂ÄÏ†ïÏ†ÅÏù∏ ÏÉùÍ∞ÅÍ≥º Î∞òÎåÄÎêòÎäî ÏûêÏó∞Ïä§Îü¨Ïö¥ Í≥ºÏ†ïÏùÑ ÏÑ§Î™ÖÌï©ÎãàÎã§.", ratVn: "Gi·∫£i th√≠ch v·ªÅ **Î≥ÄÌôî** t·ª± nhi√™n tr√°i ng∆∞·ª£c v·ªõi √Ω nghƒ© ti√™u c·ª±c ·ªü c√¢u tr∆∞·ªõc." },
            { pid: 1, q: "ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn t·ª´ th√≠ch h·ª£p.", displayType: "inline", body: "Ïó¨ÏûêÎäî ÎÇ®ÏûêÏùò ÎßàÏùåÏù¥ Î≥ÄÌñàÎã§Í≥† ÎäêÎÇÑ Îïå (      ) ÏÉùÍ∞ÅÏùÑ ÌïòÍ≥†, ÎÇ®ÏûêÎäî ÏÑ±Í≤© Ï∞®Ïù¥Î•º ÎäêÎÇÑ Îïå Ïù¥Î≥ÑÏùÑ Í≥†ÎØºÌï©ÎãàÎã§.", options: ["Ìó§Ïñ¥Ïßà", "ÏÇ¨Í≥ºÌï†", "Í≤∞ÌòºÌï†", "Ïù¥ÏÇ¨Ìï†"], ans: "Ìó§Ïñ¥Ïßà", rat: "'Ïù¥Î≥Ñ'Í≥º Í∞ôÏùÄ ÏùòÎØ∏Î•º Í∞ÄÏßÑ Îã®Ïñ¥ÏûÖÎãàÎã§.", ratVn: "T·ª´ c√≥ c√πng nghƒ©a v·ªõi vi·ªác chia tay (**Ìó§Ïñ¥Ïßà**)." },
            
            // Q4~Q6: Î™© Í±¥Í∞ï
            { pid: 2, q: "ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn c·ª•m t·ª´ th√≠ch h·ª£p.", displayType: "inline", body: "ÏöîÏ¶ò ÏßÅÏû•Ïù∏Îì§ÏùÄ Î™©Ïùò ÌÜµÏ¶ùÏù¥ Ïã¨Ìï©ÎãàÎã§. Ïª¥Ìì®ÌÑ∞Î•º Î≥º Îïå Í±∞Î∂ÅÏ≤òÎüº (      ) ÏûòÎ™ªÎêú ÏûêÏÑ∏Î•º Ïò§Îûò Ïú†ÏßÄÌïòÍ∏∞ ÎïåÎ¨∏ÏûÖÎãàÎã§.", options: ["Îì±ÏùÑ ÎòëÎ∞îÎ°ú Ìé¥Í≥†", "Î™©ÏùÑ ÏïûÏúºÎ°ú Í∏∏Í≤å ÎπºÍ≥†", "ÎààÏùÑ ÌÅ¨Í≤å Îú®Í≥†", "Í≥†Í∞úÎ•º ÏòÜÏúºÎ°ú ÎèåÎ¶¨Í≥†"], ans: "Î™©ÏùÑ ÏïûÏúºÎ°ú Í∏∏Í≤å ÎπºÍ≥†", rat: "'Í±∞Î∂Å'Ïùò Î™®ÏäµÏóêÏÑú Ïó∞ÏÉÅÌï† Ïàò ÏûàÎäî ÏûòÎ™ªÎêú ÏûêÏÑ∏ÏûÖÎãàÎã§.", ratVn: "T∆∞ th·∫ø sai m√† b·∫°n c√≥ th·ªÉ li√™n t∆∞·ªüng t·ª´ h√¨nh ·∫£nh con r√πa (**Í±∞Î∂Å**)." },
            { pid: 2, q: "ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn c·ª•m t·ª´ th√≠ch h·ª£p.", displayType: "inline", body: "ÏûêÏÑ∏Î•º Í≥†ÏπòÍ∏∞ ÏúÑÌï¥ÏÑúÎäî Ïö¥ÎèôÏù¥ ÌïÑÏöîÌï©ÎãàÎã§. ÎßëÏùÄ Í≥µÍ∏∞Î•º ÎßàÏãúÎ©∞ (      ) Ï†ÑÏã†Ïùò ÏûêÏÑ∏Î•º Î∞îÎ°úÏû°Îäî Îç∞ Îß§Ïö∞ Ìö®Í≥ºÏ†ÅÏûÖÎãàÎã§.", options: ["Í±∑Í∏∞ Ïö¥ÎèôÏùÑ ÌïòÎ©¥", "Ïû†ÏùÑ Ï∂©Î∂ÑÌûà ÏûêÎ©¥", "ÏùåÏãùÏùÑ Í≥®Í≥†Î£® Î®πÏúºÎ©¥", "ÎÖ∏ÎûòÎ•º ÌÅ¨Í≤å Î∂ÄÎ•¥Î©¥"], ans: "Í±∑Í∏∞ Ïö¥ÎèôÏùÑ ÌïòÎ©¥", rat: "Î∞ñÏóêÏÑú Ìï† Ïàò ÏûàÎäî ÎåÄÌëúÏ†ÅÏù∏ ÏûêÏÑ∏ ÍµêÏ†ï Ïö¥ÎèôÏûÖÎãàÎã§.", ratVn: "L√† m√¥n th·ªÉ thao ch·ªânh t∆∞ th·∫ø ti√™u bi·ªÉu t·∫≠p ·ªü ngo√†i tr·ªùi (**Í±∑Í∏∞ Ïö¥Îèô**)." },
            { pid: 2, q: "ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn c·ª•m t·ª´ th√≠ch h·ª£p.", displayType: "inline", body: "ÏïâÏùÄ ÏûêÎ¶¨ÏóêÏÑú Î™© Ïä§Ìä∏Î†àÏπ≠ÏùÑ (      ) Í≤ÉÎèÑ Ï¢ãÏùÄ Î∞©Î≤ïÏûÖÎãàÎã§. ÏûêÏ£º Î∞òÎ≥µÌï†ÏàòÎ°ù Î™© Í±¥Í∞ïÏóê ÎèÑÏõÄÏù¥ Îê©ÎãàÎã§.", options: ["Ìïú Î≤àÎßå ÌïòÎäî", "Ïó¨Îü¨ Î≤à Î∞òÎ≥µÌïòÎäî", "Îπ®Î¶¨ ÎÅùÎÇ¥Îäî", "ÏπúÍµ¨ÏôÄ Ìï®Íªò ÌïòÎäî"], ans: "Ïó¨Îü¨ Î≤à Î∞òÎ≥µÌïòÎäî", rat: "'ÏûêÏ£º' Ìï¥Ïïº Ìö®Í≥ºÍ∞Ä ÏûàÎã§Îäî ÏùòÎØ∏ÏûÖÎãàÎã§.", ratVn: "Nghƒ©a l√† ph·∫£i th·ª±c hi·ªán nhi·ªÅu l·∫ßn (**Ïó¨Îü¨ Î≤à Î∞òÎ≥µÌïòÎäî**) m·ªõi c√≥ hi·ªáu qu·∫£." },
            
            // Q7~Q9: ÎèôÎ¨º ÏÇ¨Îûë Î∞îÏûêÌöå (Í∞úÎüâÌòï)
            { pid: 3, q: "Î¨∏Ï†ú. ÏïÑÎûò Í∏ÄÏùò [ ÎπàÏπ∏ ]Ïóê ÏïåÎßûÏùÄ ÎßêÏùÄ Î¨¥ÏóáÏûÖÎãàÍπå?", vn: "H√£y ch·ªçn t·ª´ th√≠ch h·ª£p cho [ kho·∫£ng tr·ªëng ] b√™n d∆∞·ªõi.", displayType: "blank", body: "Ï†ÄÌù¨ ‚ÄòÎèôÏÇ¨Î™®‚ÄôÎäî [ ÎπàÏπ∏ ] ÏÇ¨ÎûåÎì§Ïù¥ Î™®Ïó¨ÏÑú Î≤ÑÎ†§ÏßÑ ÎèôÎ¨ºÏùÑ ÎèåÎ≥¥Îäî ÏùºÏùÑ Ìï©ÎãàÎã§.", options: ["ÎèôÎ¨ºÏùÑ ÏÇ¨ÎûëÌïòÎäî", "ÎèôÎ¨ºÏùÑ Î¨¥ÏÑúÏõåÌïòÎäî", "ÎèôÎ¨ºÏùÑ Í¥ÄÏ∞∞ÌïòÎäî", "ÎèôÎ¨ºÏùÑ ÌååÎäî"], ans: "ÎèôÎ¨ºÏùÑ ÏÇ¨ÎûëÌïòÎäî", rat: "'ÎèôÏÇ¨Î™®'Îäî 'ÎèôÎ¨ºÏùÑ ÏÇ¨ÎûëÌïòÎäî ÏÇ¨ÎûåÎì§Ïùò Î™®ÏûÑ'Ïù¥ÎùºÎäî ÎúªÏûÖÎãàÎã§.", ratVn: "**ÎèôÏÇ¨Î™®** nghƒ©a l√† 'H·ªôi nh·ªØng ng∆∞·ªùi y√™u ƒë·ªông v·∫≠t' (**ÎèôÎ¨ºÏùÑ ÏÇ¨ÎûëÌïòÎäî**)." },
            { pid: 3, q: "Î¨∏Ï†ú. ÏïÑÎûò Í∏ÄÏùò [ ÎπàÏπ∏ ]Ïóê ÏïåÎßûÏùÄ ÎßêÏùÄ Î¨¥ÏóáÏûÖÎãàÍπå?", vn: "H√£y ch·ªçn c·ª•m t·ª´ th√≠ch h·ª£p cho [ kho·∫£ng tr·ªëng ] b√™n d∆∞·ªõi.", displayType: "blank", body: "Í≤ΩÌóòÏù¥ ÏóÜÏñ¥ [ ÎπàÏπ∏ ] ÏóÜÏùÑÍπå Î¥ê Í±±Ï†ïÌïòÏãúÎäî Î∂ÑÎì§ÏùÑ ÏúÑÌï¥ Ïó¨Îü¨ Í∞ÄÏßÄ ÎèÑÏõÄÎèÑ ÎìúÎ¶ΩÎãàÎã§.", options: ["ÎèôÎ¨ºÏùÑ Ïûò ÎèåÎ≥º Ïàò", "ÎèôÎ¨ºÏùÑ Î≤ÑÎ¶¥ Ïàò", "ÎèôÎ¨ºÏùÑ ÌõàÎ†®ÏãúÌÇ¨ Ïàò", "ÎèôÎ¨ºÏùÑ Íµ¨Í≤ΩÌï† Ïàò"], ans: "ÎèôÎ¨ºÏùÑ Ïûò ÎèåÎ≥º Ïàò", rat: "ÎèôÎ¨ºÏùÑ Ï≤òÏùå ÌÇ§Ïö∞Îäî ÏÇ¨ÎûåÎì§Ïù¥ ÌïòÎäî Í∞ÄÏû• ÌÅ∞ Í±±Ï†ïÏùÑ ÎúªÌï©ÎãàÎã§.", ratVn: "Nghƒ©a l√† n·ªói lo l·∫Øng l·ªõn nh·∫•t c·ªßa ng∆∞·ªùi l·∫ßn ƒë·∫ßu nu√¥i ƒë·ªông v·∫≠t (**ÎèôÎ¨ºÏùÑ Ïûò ÎèåÎ≥º Ïàò**)." },
            { pid: 3, q: "Î¨∏Ï†ú. ÏïÑÎûò Í∏ÄÏùò [ ÎπàÏπ∏ ]Ïóê ÏïåÎßûÏùÄ ÎßêÏùÄ Î¨¥ÏóáÏûÖÎãàÍπå?", vn: "H√£y ch·ªçn c·ª•m t·ª´ th√≠ch h·ª£p cho [ kho·∫£ng tr·ªëng ] b√™n d∆∞·ªõi.", displayType: "blank", body: "ÏàòÏùµÍ∏àÏùÄ Î™®Îëê Î≤ÑÎ†§ÏßÑ ÎèôÎ¨ºÍ≥º ÏÇ¨ÎùºÏßà ÏúÑÍ∏∞Ïóê Ï≤òÌïú [ ÎπàÏπ∏ ] Î≥¥Ìò∏ÌïòÎäî Îç∞ Ïì∞ÏûÖÎãàÎã§.", options: ["Î©∏Ï¢Ö ÏúÑÍ∏∞ ÎèôÎ¨ºÏùÑ", "ÏïºÏÉù ÎèôÎ¨ºÎì§ÏùÑ", "Ïï†ÏôÑ ÎèôÎ¨ºÎì§ÏùÑ", "Î∞îÎã§ ÏÉùÎ¨ºÎì§ÏùÑ"], ans: "Î©∏Ï¢Ö ÏúÑÍ∏∞ ÎèôÎ¨ºÏùÑ", rat: "Î≥¥Ìò∏Í∞Ä ÏãúÍ∏âÌïú, ÏÇ¨ÎùºÏßà ÏúÑÌóòÏù¥ ÏûàÎäî ÎèôÎ¨ºÎì§ÏùÑ ÎúªÌï©ÎãàÎã§.", ratVn: "Nghƒ©a l√† c√°c lo√†i ƒë·ªông v·∫≠t c√≥ nguy c∆° bi·∫øn m·∫•t (**Î©∏Ï¢Ö ÏúÑÍ∏∞ ÎèôÎ¨º**)." },
            
            // Q10~Q12: ÏÑ±Í≥µ ÎπÑÍ≤∞ (Íµ¨Ï°∞ Í∞úÎüâÌòï)
            { pid: 4, q: "Î¨∏Ï†ú. ÏïÑÎûò Í∏ÄÏùò Ï†úÎ™©ÏúºÎ°ú ÏïåÎßûÏùÄ Í≤ÉÏùÄ Î¨¥ÏóáÏûÖÎãàÍπå?", vn: "Ti√™u ƒë·ªÅ n√†o ph√π h·ª£p nh·∫•t cho ƒëo·∫°n vƒÉn d∆∞·ªõi ƒë√¢y?", displayType: "title", body: "ÌöåÏÇ¨ÏóêÏÑú ÎèôÎ£åÎì§ÏóêÍ≤å Ïª§ÌîºÎ•º ÌÉÄ Ï£ºÍ±∞ÎÇò ÏßêÏùÑ Îì§Ïñ¥ Ï£ºÎäî Îì±Ïùò ÏûëÏùÄ Ìò∏ÏùòÎ•º Î≤†Ìë∏Îäî ÏÇ¨ÎûåÏù¥ ÎÇòÏ§ëÏóê ÎèôÎ£åÎì§Ïùò ÎèÑÏõÄÏùÑ Î∞õÏïÑ ÏÑ±Í≥µÌïòÍ≤å Îê©ÎãàÎã§.", options: ["ÏπúÏ†àÌïú ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", "Ïö¥ÎèôÌïòÎäî ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", "Ïó¨ÌñâÌïòÎäî ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", "ÏùºÏ∞ç ÏûêÎäî ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§"], ans: "ÏπúÏ†àÌïú ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", rat: "ÎèôÎ£åÎ•º ÎèïÎäî ÌñâÎèôÏùÄ 'ÏπúÏ†à'Ïóê Ìï¥ÎãπÌï©ÎãàÎã§.", ratVn: "H√†nh ƒë·ªông gi√∫p ƒë·ª° ƒë·ªìng nghi·ªáp thu·ªôc v·ªÅ **ÏπúÏ†à** (th√¢n thi·ªán)." },
            { pid: 4, q: "Î¨∏Ï†ú. ÏïÑÎûò Í∏ÄÏùò Ï†úÎ™©ÏúºÎ°ú ÏïåÎßûÏùÄ Í≤ÉÏùÄ Î¨¥ÏóáÏûÖÎãàÍπå?", vn: "Ti√™u ƒë·ªÅ n√†o ph√π h·ª£p nh·∫•t cho ƒëo·∫°n vƒÉn d∆∞·ªõi ƒë√¢y?", displayType: "title", body: "ÌïúÍµ≠Ïùò ÏßÅÏû•Ïù∏Îì§ÏùÄ ÌèâÍ∑†Ï†ÅÏúºÎ°ú 1ÎÖÑÏóê 16Í∂åÏùò Ï±ÖÏùÑ ÏùΩÏúºÎ©∞ ÏÜåÏÑ§Ïù¥ÎÇò Í≤ΩÏ†ú ÏÑúÏ†ÅÏùÑ ÌÜµÌï¥ ÏßÄÏãùÏùÑ ÏåìÏäµÎãàÎã§.", options: ["Íæ∏Ï§ÄÌûà ÎèÖÏÑúÌïòÎäî ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", "Ïà†ÏùÑ ÎßàÏãúÎäî Í≤ÉÏù¥ Ï¢ãÎã§", "Ïû†ÏùÑ ÎßéÏù¥ ÏûêÎäî Í≤ÉÏù¥ Ï¢ãÎã§", "Ïª¥Ìì®ÌÑ∞Î•º Î©ÄÎ¶¨ÌïòÎäî Í≤ÉÏù¥ Ï¢ãÎã§"], ans: "Íæ∏Ï§ÄÌûà ÎèÖÏÑúÌïòÎäî ÏÇ¨ÎûåÏù¥ ÏÑ±Í≥µÌïúÎã§", rat: "Ï±ÖÏùÑ ÏùΩÍ≥† ÏßÄÏãùÏùÑ ÏåìÎäî Í≤ÉÏùÄ 'ÎèÖÏÑú'ÏûÖÎãàÎã§.", ratVn: "Vi·ªác ƒë·ªçc s√°ch v√† t√≠ch l≈©y ki·∫øn th·ª©c thu·ªôc v·ªÅ **ÎèÖÏÑú** (ƒë·ªçc s√°ch)." },
            { pid: 4, q: "Î¨∏Ï†ú. ÏïÑÎûò Í∏ÄÏùò ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî.", vn: "H√£y ch·ªçn t·ª´ th√≠ch h·ª£p cho kho·∫£ng tr·ªëng b√™n ÏïÑÎûò.", displayType: "inline", body: "ÏßÄÍ∏àÍπåÏßÄ ÏÑ±Í≥µÏùÑ ÏúÑÌïú Îëê Í∞ÄÏßÄ ÎπÑÍ≤∞ÏùÑ ÏïåÏïÑÎ≥¥ÏïòÏäµÎãàÎã§. ÏßÄÏãùÏùÑ ÏåìÍ≥† ÏπúÏ†àÏùÑ Î≤†Ìë∏Îäî Í≤ÉÏùÄ (      ) Îß§Ïö∞ Ï§ëÏöîÌï©ÎãàÎã§.", options: ["ÏÑ±Í≥µÏùÑ ÏúÑÌï¥", "Ïã§ÏàòÎ•º ÏúÑÌï¥", "Ìè¨Í∏∞Î•º ÏúÑÌï¥", "Ïû†ÏùÑ ÏúÑÌï¥"], ans: "ÏÑ±Í≥µÏùÑ ÏúÑÌï¥", rat: "Í∏Ä Ï†ÑÏ≤¥Ïùò Ï£ºÏ†úÏù∏ ÏßÅÏû•Ïù∏Ïùò 'ÏÑ±Í≥µ'ÏùÑ Í∞ïÏ°∞Ìï©ÎãàÎã§.", ratVn: "Nh·∫•n m·∫°nh v√†o **ÏÑ±Í≥µ** (th√†nh c√¥ng), v·ªën l√† ch·ªß ƒë·ªÅ c·ªßa c·∫£ b√†i." }
        ];

        let currentIdx = 0;
        let score = 0;

        // Shuffle function
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        const catEl = document.getElementById('question-category');
        const qCountEl = document.getElementById('q-count');
        const qTitleEl = document.getElementById('question-title');
        const qTitleVnEl = document.getElementById('question-title-vn');
        const bodyArea = document.getElementById('body-display-area');
        const optionsGrid = document.getElementById('options-grid');
        const fbArea = document.getElementById('feedback-area');
        const fbStatus = document.getElementById('feedback-status');
        const fbIcon = document.getElementById('feedback-icon');
        const fbRat = document.getElementById('feedback-rationale');
        const fbRatVn = document.getElementById('feedback-rationale-vn');
        const nextBtn = document.getElementById('next-btn');
        const progBar = document.getElementById('progress-bar');
        const quizCont = document.getElementById('quiz-container');
        const resCont = document.getElementById('result-container');
        const finalScoreEl = document.getElementById('final-score');
        const modal = document.getElementById('text-modal');
        const modalContent = document.getElementById('modal-content');

        function render() {
            const data = quizData[currentIdx];
            const passage = passages.find(p => p.id === data.pid);
            
            catEl.textContent = passage.title;
            qCountEl.textContent = `${(currentIdx + 1).toString().padStart(2, '0')}/12`;
            qTitleEl.textContent = data.q;
            qTitleVnEl.textContent = data.vn;
            
            // Body Display Logic
            bodyArea.innerHTML = '';
            if (data.displayType === "title") {
                bodyArea.innerHTML = `
                    <div class="mb-3 text-center"><span class="blank-title">1. [ Ï†úÎ™© ]</span></div>
                    <div class="passage-box">
                        <p class="text-gray-400 text-[10px] mb-2 font-bold uppercase tracking-widest border-b pb-1">Î≥∏Î¨∏ ÎÇ¥Ïö© (N·ªôi dung)</p>
                        ${data.body}
                    </div>
                `;
            } else if (data.displayType === "blank") {
                bodyArea.innerHTML = `
                    <div class="passage-box">
                        <p class="text-indigo-500 text-[10px] font-bold uppercase mb-2 border-b pb-1">ÏßÄÎ¨∏ Î≥∏Î¨∏ (ƒêo·∫°n vƒÉn)</p>
                        ${data.body}
                    </div>
                `;
            } else {
                bodyArea.innerHTML = `
                    <div class="passage-box bg-slate-50 border-slate-200">
                        ${data.body}
                    </div>
                `;
            }

            optionsGrid.innerHTML = '';
            fbArea.classList.add('hidden');
            progBar.style.width = `${(currentIdx / quizData.length) * 100}%`;

            // Randomize options
            const shuffledOptions = shuffle([...data.options]);

            shuffledOptions.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left p-4 border border-gray-200 rounded-2xl bg-white text-gray-700 font-medium shadow-sm flex items-center";
                btn.innerHTML = `<span class="w-8 h-8 flex items-center justify-center bg-indigo-50 text-indigo-600 rounded-full mr-4 font-bold text-sm shrink-0">${i + 1}</span> <span>${opt}</span>`;
                btn.onclick = () => check(opt, btn);
                optionsGrid.appendChild(btn);
            });
            window.scrollTo(0, 0);
        }

        function check(selectedText, btn) {
            const data = quizData[currentIdx];
            const btns = optionsGrid.querySelectorAll('button');
            btns.forEach(b => b.disabled = true);

            if (selectedText === data.ans) {
                btn.classList.add('correct');
                fbIcon.innerHTML = "üéØ";
                fbStatus.textContent = "Ï†ïÎãµÏûÖÎãàÎã§! (Ch√≠nh x√°c)";
                fbStatus.className = "font-bold text-green-700";
                fbArea.className = "mt-8 p-5 rounded-2xl border-2 border-green-200 bg-green-50 block shadow-md";
                score++;
            } else {
                btn.classList.add('incorrect');
                // Find correct btn to highlight
                btns.forEach(b => {
                    if(b.querySelector('span:last-child').textContent === data.ans) b.classList.add('correct');
                });
                fbIcon.innerHTML = "üí°";
                fbStatus.textContent = "Ïò§ÎãµÏûÖÎãàÎã§. (Sai r·ªìi)";
                fbStatus.className = "font-bold text-red-700";
                fbArea.className = "mt-8 p-5 rounded-2xl border-2 border-red-200 bg-red-50 block shadow-md";
            }
            fbRat.textContent = data.rat;
            fbRatVn.innerHTML = data.ratVn;
            
            setTimeout(() => {
                fbArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        nextBtn.onclick = () => {
            currentIdx++;
            if (currentIdx < quizData.length) render();
            else showResults();
        };

        function showResults() {
            progBar.style.width = "100%";
            quizCont.classList.add('hidden');
            resCont.classList.remove('hidden');
            finalScoreEl.textContent = score;
            const emoji = document.getElementById('result-emoji');
            if (score >= 11) emoji.textContent = "üèÖ";
            else if (score >= 8) emoji.textContent = "ü•à";
            else emoji.textContent = "üìñ";
        }

        document.getElementById('view-text-btn').onclick = () => {
            const data = quizData[currentIdx];
            const passage = passages.find(p => p.id === data.pid);
            let text = passage.template;
            const currentSubIdx = passage.questionIndices.indexOf(currentIdx);

            for (let i = 0; i < 3; i++) {
                let rep = "";
                if (i < currentSubIdx) rep = `<span class="highlight-blue">${passage.answers[i]}</span>`;
                else if (i === currentSubIdx) rep = `<span class="highlight-yellow">(        )</span>`;
                else rep = `(        )`;
                text = text.replace(`{${i}}`, rep);
            }

            modalContent.innerHTML = `
                <h4 class="font-black text-indigo-700 mb-4 text-lg border-b-2 border-indigo-100 pb-2">${passage.title}</h4>
                <div class="leading-loose text-gray-700 text-sm">${text}</div>
            `;
            modal.classList.remove('hidden');
        };

        document.getElementById('close-modal-btn').onclick = () => modal.classList.add('hidden');
        window.onclick = (e) => { if (e.target === modal) modal.classList.add('hidden'); };
        
        window.onload = render;
    </script>
</body>
</html>


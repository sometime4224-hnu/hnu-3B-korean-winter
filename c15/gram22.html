<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>í•œêµ­ì–´ ì¶”ì¸¡ í‘œí˜„ í€´ì¦ˆ: ë‰˜ì•™ìŠ¤ ë§ˆìŠ¤í„°</title>
  <style>
    :root {
      --bg-body: #0f172a;
      --bg-card: #1e293b;
      --bg-btn: #334155;
      --bg-btn-hover: #475569;
      --text-main: #f1f5f9;
      --text-sub: #94a3b8;
      --accent: #60a5fa;
      --success: #10b981;
      --error: #ef4444;
      --border: #334155;
      --radius: 12px;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    * { box-sizing: border-box; }
    
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Pretendard", "Segoe UI", Roboto, sans-serif;
      background-color: var(--bg-body);
      color: var(--text-main);
      line-height: 1.6;
    }

    .wrap {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header Area */
    header {
      margin-bottom: 24px;
      text-align: center;
    }
    .main-title {
      font-size: 1.5rem;
      font-weight: 800;
      margin: 0 0 8px 0;
      color: #fff;
    }
    .sub-title {
      font-size: 0.9rem;
      color: var(--text-sub);
    }

    /* Grid Layout */
    .dashboard {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 20px;
    }

    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr; /* Stack specifically on mobile */
      }
      .card.right {
        order: -1; /* Show progress bar on top in mobile */
      }
    }

    /* Card Component */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    /* Progress Bar */
    .score-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: 8px;
    }
    .score-label { font-size: 0.85rem; color: var(--text-sub); }
    .score-val { font-size: 1.2rem; font-weight: 700; color: var(--accent); }
    
    .progress-track {
      height: 8px;
      background: var(--bg-btn);
      border-radius: 99px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: var(--accent);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Quiz Area */
    .q-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 16px;
      font-size: 0.9rem;
      color: var(--text-sub);
      border-bottom: 1px solid var(--border);
      padding-bottom: 12px;
    }
    .q-badge {
      background: var(--bg-btn);
      padding: 2px 8px;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-main);
    }

    .context-box {
      background: #0f172a; /* Darker inner bg */
      padding: 16px;
      border-radius: 8px;
      border-left: 4px solid var(--accent);
      margin-bottom: 20px;
      font-size: 1.05rem;
    }
    .context-label {
      display: block;
      font-size: 0.8rem;
      color: var(--text-sub);
      margin-bottom: 6px;
      font-weight: 700;
    }
    .blank {
      display: inline-block;
      min-width: 60px;
      border-bottom: 2px dashed var(--accent);
      color: var(--accent);
      text-align: center;
      font-weight: bold;
    }

    /* Choices */
    .choice-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .btn-choice {
      width: 100%;
      text-align: left;
      padding: 16px;
      background: var(--bg-btn);
      border: 1px solid transparent;
      border-radius: 10px;
      color: var(--text-main);
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }
    .btn-choice:hover:not(:disabled) {
      background: var(--bg-btn-hover);
      transform: translateY(-2px);
    }
    .btn-choice:disabled {
      opacity: 0.7;
      cursor: default;
    }
    
    /* Answer States */
    .btn-choice.correct {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
      font-weight: 700;
    }
    .btn-choice.wrong {
      border-color: var(--error);
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
    }
    
    /* Result Icon */
    .res-icon {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.2rem;
    }

    /* Explanation Box */
    .explanation {
      margin-top: 20px;
      padding: 16px;
      background: rgba(96, 165, 250, 0.1);
      border: 1px solid rgba(96, 165, 250, 0.2);
      border-radius: 8px;
      animation: fadeIn 0.3s ease-in-out;
    }
    @keyframes fadeIn { from { opacity:0; transform:translateY(5px); } to { opacity:1; transform:translateY(0); } }
    
    .exp-title { font-weight: 700; color: var(--accent); margin-bottom: 6px; display: block; }
    .exp-text { font-size: 0.95rem; color: var(--text-main); }

    /* Controls */
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 24px;
    }
    .btn-nav {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text-main);
      font-weight: 600;
      cursor: pointer;
    }
    .btn-nav:hover:not(:disabled) { background: var(--bg-btn); }
    .btn-nav:disabled { opacity: 0.3; cursor: not-allowed; }
    .btn-nav.primary { border-color: var(--accent); color: var(--accent); }

    /* Cheat Sheet (Right Side) */
    .cheat-item { margin-bottom: 16px; font-size: 0.9rem; }
    .cheat-title { font-weight: 700; color: #fff; margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
    .cheat-desc { color: var(--text-sub); line-height: 1.4; }
    .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
    .dot.yellow { background: #fbbf24; } /* -ì„ ê²ƒ ê°™ë‹¤ */
    .dot.purple { background: #a78bfa; } /* -ì„ê±¸ìš” */
    .dot.green { background: #34d399; } /* -ì„ í…ë°ìš” */

  </style>
</head>
<body>

<div class="wrap">
  <header>
    <h1 class="main-title">í•œêµ­ì–´ ì¶”ì¸¡ í‘œí˜„ í€´ì¦ˆ</h1>
    <div class="sub-title">ìƒí™©ì— ê°€ì¥ ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ì„ ê³¨ë¼ë³´ì„¸ìš”.</div>
  </header>

  <div class="dashboard">
    <div class="card" id="quizCard">
      <div class="q-header">
        <span id="qIndex">ë¬¸ì œ 1 / 10</span>
        <span class="q-badge">ë‰˜ì•™ìŠ¤ ì¶”ë¡ </span>
      </div>

      <div class="context-box">
        <span class="context-label">ìƒí™©(Context)</span>
        <div id="qContextText"></div>
        <div style="margin-top:12px; font-size:1.1em;">
          "<span id="qSentenceText"></span>"
        </div>
      </div>

      <div class="choice-list" id="choiceList">
        </div>

      <div id="feedbackArea" style="display:none;">
        <div class="explanation">
          <span class="exp-title" id="resTitle">ì •ë‹µì…ë‹ˆë‹¤!</span>
          <span class="exp-text" id="expText">í•´ì„¤ ë‚´ìš©ì´ ì—¬ê¸°ì— ë‚˜ì˜µë‹ˆë‹¤.</span>
        </div>
      </div>

      <div class="controls">
        <button class="btn-nav" id="prevBtn">ì´ì „</button>
        <button class="btn-nav primary" id="nextBtn">ë‹¤ìŒ ë¬¸ì œ</button>
      </div>
    </div>

    <div class="card right">
      <div class="score-row">
        <span class="score-label">í˜„ì¬ ì ìˆ˜</span>
        <span class="score-val"><span id="scoreVal">0</span>ì </span>
      </div>
      <div class="progress-track">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div style="margin-top:8px; text-align:right; font-size:0.8rem; color:var(--text-sub);">
        ì§„í–‰ë¥  <span id="progressPct">0</span>%
      </div>

      <hr style="border:0; border-top:1px solid var(--border); margin: 24px 0;">

      <h3 style="margin:0 0 16px 0; font-size:1rem;">ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸</h3>
      
      <div class="cheat-item">
        <div class="cheat-title"><span class="dot yellow"></span> -(ìœ¼)ã„¹ ê²ƒ ê°™ì•„ìš”</div>
        <div class="cheat-desc">ê°€ì¥ ì¼ë°˜ì ì´ê³  ì¡°ì‹¬ìŠ¤ëŸ¬ìš´ ì¶”ì¸¡. ê·¼ê±°ê°€ ì•½í•´ë„ OK. (í™•ì‹ : ë‚®ìŒ~ì¤‘ê°„)</div>
      </div>

      <div class="cheat-item">
        <div class="cheat-title"><span class="dot purple"></span> -(ìœ¼)ã„¹ê±¸ìš”</div>
        <div class="cheat-desc">ê²½í—˜ì´ë‚˜ ì§ê°ì„ ë°”íƒ•ìœ¼ë¡œ í•œ ê°•í•œ í™•ì‹ . ìƒëŒ€ì˜ ìƒê°ì— ë°˜ë°•í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì¤„ ë•Œ ìì£¼ ì”€. (í™•ì‹ : ë†’ìŒ)</div>
      </div>

      <div class="cheat-item">
        <div class="cheat-title"><span class="dot green"></span> -(ìœ¼)ã„¹ í…ë°ìš”</div>
        <div class="cheat-desc">"ê·¸ëŸ´ ê²ƒ ê°™ì€ë°..."ë¼ë©° ë§ëì„ íë¦¬ëŠ” ëŠë‚Œ. ìƒëŒ€ì—ê²Œ ì œì•ˆ, ê±±ì •, ì•„ì‰¬ì›€ì„ í‘œí˜„í•˜ê¸° ìœ„í•œ ë°°ê²½ ì„¤ëª….</div>
      </div>
      
      <button class="btn-nav" id="restartBtn" style="width:100%; margin-top:10px;">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
    </div>
  </div>
</div>

<script>
  // Quiz Data
  const quizData = [
    {
      id: 1,
      context: "ì°½ë°–ì„ ë³´ë‹ˆ ë¨¹êµ¬ë¦„ì´ ê°€ë“í•˜ê³  ë°”ëŒì´ ì•„ì£¼ ì„¸ê²Œ ë¶ˆì–´ìš”. ì²œë‘¥ ì†Œë¦¬ë„ ë“¤ë ¤ìš”.",
      sentence: "ì¡°ê¸ˆ ìˆìœ¼ë©´ ë¹„ê°€ _____.",
      answer: "K",
      explain: "ëˆˆì— ë³´ì´ëŠ” í™•ì‹¤í•œ ì¦ê±°(ë¨¹êµ¬ë¦„, ì²œë‘¥)ê°€ ìˆì–´ í™”ìê°€ ê°•í•˜ê²Œ í™•ì‹ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë•ŒëŠ” ë‹¨ìˆœ ì¶”ì¸¡ë³´ë‹¤ í™•ì‹ ì´ ê°•í•œ '-ì„ê±¸ìš”'ê°€ ê°€ì¥ ìì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤."
    },
    {
      id: 2,
      context: "ì¹œêµ¬ê°€ 'ë¯¼ìˆ˜ ì§€ê¸ˆ ì–´ë””ì•¼?'ë¼ê³  ë¬»ìŠµë‹ˆë‹¤. ë‚˜ëŠ” ë¯¼ìˆ˜ì—ê²Œ ì—°ë½ì„ ëª» ë°›ì•„ì„œ ì˜ ëª°ë¼ìš”.",
      sentence: "ê¸€ì„, ì˜ ëª¨ë¥´ê² ëŠ”ë° ì§‘ì— _____.",
      answer: "G",
      explain: "ê·¼ê±°ê°€ ê±°ì˜ ì—†ê³  ì •ë³´ê°€ ë¶€ì¡±í•œ ìƒí™©ì…ë‹ˆë‹¤. ì´ë•ŒëŠ” ê°€ì¥ ì¡°ì‹¬ìŠ¤ëŸ½ê³  ë§‰ì—°í•œ ì¶”ì¸¡ì¸ '-ì„ ê²ƒ ê°™ì•„ìš”'ë¥¼ ì”ë‹ˆë‹¤."
    },
    {
      id: 3,
      context: "ì§€ê¸ˆ 8ì‹œ 55ë¶„ì´ê³ , ìˆ˜ì—…ì€ 9ì‹œì˜ˆìš”. í•™êµê¹Œì§€ 20ë¶„ì´ ê±¸ë ¤ìš”. ì¹œêµ¬ì—ê²Œ ë¹¨ë¦¬ ê°€ë¼ê³  ë§í•˜ê³  ì‹¶ì–´ìš”.",
      sentence: "ì§€ê¸ˆ ì¶œë°œí•˜ë©´ _____.",
      answer: "T",
      explain: "'ëŠ¦ì„ ê²ƒ'ì´ë¼ëŠ” ì˜ˆìƒì´ ì¤‘ìš”í•œ ê²Œ ì•„ë‹ˆë¼, 'ê·¸ëŸ¬ë‹ˆê¹Œ ì„œë‘˜ëŸ¬ë¼/íƒì‹œë¥¼ íƒ€ë¼'ëŠ” ì œì•ˆì˜ ì˜ë„ê°€ ìˆ¨ì–´ ìˆìŠµë‹ˆë‹¤. ìƒí™©ì„ ì „ì œë¡œ ê±±ì •/ì œì•ˆì„ í•  ë•ŒëŠ” '-ì„ í…ë°ìš”'ê°€ ì ì ˆí•©ë‹ˆë‹¤."
    },
    {
      id: 4,
      context: "ë‚˜ëŠ” ì´ ì¹´í˜ ë‹¨ê³¨ì´ë¼ ë©”ë‰´ ë§›ì„ ë‹¤ ì•Œì•„ìš”. ì¹œêµ¬ê°€ ë‹¨ ì»¤í”¼ë¥¼ ì‹«ì–´í•˜ëŠ”ë° 'ìº¬ë¼ë©œ ë¼ë–¼'ë¥¼ ì‹œí‚¤ë ¤ê³  í•´ìš”.",
      sentence: "ê·¸ê±´ ë„ˆë¬´ ë‹¨ë§›ì´ ê°•í•  _____.",
      answer: "K",
      explain: "ìì‹ ì˜ ê²½í—˜(ë‹¨ê³¨)ì„ ë°”íƒ•ìœ¼ë¡œ ì¹œêµ¬ì˜ ì„ íƒì— ëŒ€í•´ í™•ì‹ ì„ ê°€ì§€ê³  ë§í•´ì£¼ê³  ìˆìŠµë‹ˆë‹¤(ë°˜ë°•/ì •ë³´ ì œê³µ). '-ì„ê±¸ìš”'ê°€ ì í•©í•©ë‹ˆë‹¤."
    },
    {
      id: 5,
      context: "íšŒì‚¬ ê·œì •ì— 'ì§€ê° 3ë²ˆì´ë©´ ê²½ê³ 'ë¼ê³  ì í˜€ ìˆì–´ìš”. ê¹€ ëŒ€ë¦¬ë‹˜ì€ ì´ë¯¸ 2ë²ˆ ì§€ê°í–ˆê³ , ì˜¤ëŠ˜ë„ ëŠ¦ì—ˆì–´ìš”.",
      sentence: "ì˜¤ëŠ˜ë„ ëŠ¦ì—ˆìœ¼ë‹ˆê¹Œ ê²½ê³ ë¥¼ ë°›ì„ _____.",
      answer: "K",
      explain: "ê·œì¹™ì´ë¼ëŠ” ëª…í™•í•œ ê·¼ê±°ê°€ ìˆì–´ ê²°ê³¼ê°€ ê±°ì˜ í™•ì‹¤í•©ë‹ˆë‹¤. ë‹¨ìˆœ ì¶”ì¸¡ì„ ë„˜ì–´ì„  ë…¼ë¦¬ì  ë‹¨ì •ì—ëŠ” '-ì„ê±¸ìš”'ê°€ ì–´ìš¸ë¦½ë‹ˆë‹¤."
    },
    {
      id: 6,
      context: "ì¹œêµ¬ê°€ ë‚´ì¼ ë†€ì´ê³µì›ì— ê°€ìê³  í•´ìš”. ê·¸ëŸ°ë° ì¼ê¸°ì˜ˆë³´ì—ì„œ ë‚´ì¼ í•˜ë£¨ ì¢…ì¼ ë¹„ê°€ ì˜¨ë‹¤ê³  í–ˆì–´ìš”.",
      sentence: "ë‚´ì¼ ë¹„ê°€ _____ . ë‹¤ë¥¸ ë‚ ë¡œ ì¡ëŠ” ê²Œ ì–´ë•Œ?",
      answer: "T",
      explain: "'ë¹„ê°€ ì˜¬ ê²ƒì´ë‹¤'ë¼ëŠ” ì‚¬ì‹¤ì„ ê·¼ê±°ë¡œ 'ë‹¤ë¥¸ ë‚ ë¡œ ì¡ì'ê³  ì œì•ˆí•˜ê³  ìˆìŠµë‹ˆë‹¤. ìƒëŒ€ë°©ì˜ ì œì•ˆì— ëŒ€í•´ ìš°ë ¤ë¥¼ ë‚˜íƒ€ë‚´ë©° ë°°ê²½ì„ ì„¤ëª…í•˜ëŠ” '-ì„ í…ë°ìš”'ê°€ ê°€ì¥ ìì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤."
    },
    {
      id: 7,
      context: "ì§€í•˜ì² ì´ ê°‘ìê¸° ë©ˆì·„ì–´ìš”. ë°©ì†¡ë„ ì•ˆ ë‚˜ì˜¤ê³  ì•„ë¬´ëŸ° ì •ë³´ê°€ ì—†ì–´ìš”.",
      sentence: "ë¬´ìŠ¨ ì¼ì´ì§€? ê³ ì¥ ë‚œ _____.",
      answer: "G",
      explain: "ìƒí™© íŒŒì•…ì´ ì „í˜€ ì•ˆ ëœ ìƒíƒœì—ì„œì˜ ë§‰ì—°í•œ ì¶”ì¸¡ì…ë‹ˆë‹¤. í™•ì‹ ì„ ê°€ì§ˆ ê·¼ê±°ê°€ ì—†ìœ¼ë¯€ë¡œ '-ì„ ê²ƒ ê°™ì•„ìš”'ê°€ ì•ˆì „í•©ë‹ˆë‹¤."
    },
    {
      id: 8,
      context: "ì¹œêµ¬ê°€ ì•½ì† ì¥ì†Œê°€ ê°•ë‚¨ì—­ì´ë¼ê³  ìš°ê¸°ëŠ”ë°, ë‚´ê°€ ê°€ì§„ ì´ˆëŒ€ì¥ì—ëŠ” í™ëŒ€ì…êµ¬ë¼ê³  ì í˜€ ìˆì–´ìš”.",
      sentence: "ì´ˆëŒ€ì¥ì—ëŠ” í™ëŒ€ë¼ê³  ì¨ ìˆëŠ”ë°... ë„¤ê°€ ì˜ëª» ë³¸ _____.",
      answer: "T",
      explain: "ì¦ê±°(ì´ˆëŒ€ì¥)ë¥¼ ì œì‹œí•˜ë©° ìƒëŒ€ë°©ì˜ ìƒê°ì´ í‹€ë ¸ì„ ê°€ëŠ¥ì„±ì„ ì§€ì í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì™„ê³¡í•˜ê²Œ ìƒëŒ€ì˜ ì°©ì˜¤ë¥¼ ì§€ì í•  ë•Œ '-ì„ í…ë°ìš”'ë¥¼ ìì£¼ ì”ë‹ˆë‹¤."
    },
    {
      id: 9,
      context: "ìš°ë¦¬ íŒ€ì¥ë‹˜ì€ ê¼¼ê¼¼í•œ ì„±ê²©ì´ì—ìš”. ì´ë²ˆ ë³´ê³ ì„œëŠ” ê¸‰í•˜ê²Œ ì¨ì„œ ì˜¤íƒ€ê°€ ì¢€ ë§ì•„ìš”.",
      sentence: "íŒ€ì¥ë‹˜ì´ ì´ ë³´ê³ ì„œë¥¼ ì‹«ì–´í•˜ì‹¤ _____.",
      answer: "G",
      explain: "ì„±ê²©ì„ ì•Œì§€ë§Œ ê²°ê³¼ëŠ” ì•„ì§ ëª¨ë¦…ë‹ˆë‹¤. ì¼ë°˜ì ì¸ ê°€ëŠ¥ì„±ì„ ì´ì•¼ê¸°í•˜ë¯€ë¡œ '-ì„ ê²ƒ ê°™ì•„ìš”'ê°€ ë¬´ë‚œí•©ë‹ˆë‹¤. (í™•ì‹ ì´ ì•„ì£¼ ê°•í•˜ë‹¤ë©´ -ì„ê±¸ìš”ë„ ê°€ëŠ¥í•˜ì§€ë§Œ, ë¬¸ë§¥ìƒ ê±±ì •ìŠ¤ëŸ¬ìš´ ì¶”ì¸¡ì— ê°€ê¹ìŠµë‹ˆë‹¤)"
    },
    {
      id: 10,
      context: "ì§€ê¸ˆ ë°¤ 11ì‹œì˜ˆìš”. ì € ì‹ë‹¹ì€ í•­ìƒ 10ì‹œì— ë¬¸ì„ ë‹«ì•„ìš”. ê°€ê²Œ ë¶ˆë„ êº¼ì ¸ ìˆì–´ìš”.",
      sentence: "ê°€ë³´ë‚˜ ë§ˆë‚˜ ì´ë¯¸ ë¬¸ ë‹«ì•˜ _____.",
      answer: "K",
      explain: "ì‹œê°„ê³¼ ìƒí™© ì¦ê±°ê°€ ì™„ë²½í•˜ì—¬ ì‚¬ì‹¤ìƒ 100% í™•ì‹ í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤. 'ë¶„ëª…íˆ ~í–ˆì„ ê²ƒì´ë‹¤'ë¼ëŠ” ë‰˜ì•™ìŠ¤ëŠ” '-ì„ê±¸ìš”'ì…ë‹ˆë‹¤."
    }
  ];

  const choices = [
    { key: "G", label: "-(ìœ¼)ã„¹ ê²ƒ ê°™ì•„ìš”" }, // Guess (Low-Mid)
    { key: "T", label: "-(ìœ¼)ã„¹ í…ë°ìš”" },    // Tone/Context (Suggestion/Worry)
    { key: "K", label: "-(ìœ¼)ã„¹ê±¸ìš”" }        // Knowledge/Strong Guess
  ];

  // State Management
  let currentIdx = 0;
  let score = 0;
  let userAnswers = new Array(quizData.length).fill(null); // Stores 'G', 'T', 'K' or null

  // DOM Elements
  const els = {
    qIndex: document.getElementById('qIndex'),
    qContext: document.getElementById('qContextText'),
    qSentence: document.getElementById('qSentenceText'),
    choiceList: document.getElementById('choiceList'),
    feedbackArea: document.getElementById('feedbackArea'),
    resTitle: document.getElementById('resTitle'),
    expText: document.getElementById('expText'),
    scoreVal: document.getElementById('scoreVal'),
    progressFill: document.getElementById('progressFill'),
    progressPct: document.getElementById('progressPct'),
    prevBtn: document.getElementById('prevBtn'),
    nextBtn: document.getElementById('nextBtn'),
    restartBtn: document.getElementById('restartBtn')
  };

  // Initialize
  function init() {
    renderQuiz();
    updateStats();
  }

  function renderQuiz() {
    const item = quizData[currentIdx];
    const answeredKey = userAnswers[currentIdx];
    const isAnswered = answeredKey !== null;

    // 1. Text Content
    els.qIndex.textContent = `ë¬¸ì œ ${item.id} / ${quizData.length}`;
    els.qContext.innerHTML = item.context.replace(/\n/g, '<br>');
    els.qSentence.innerHTML = item.sentence.replace("_____", `<span class="blank">_____</span>`);

    // 2. Choices
    els.choiceList.innerHTML = '';
    choices.forEach(choice => {
      const btn = document.createElement('button');
      btn.className = 'btn-choice';
      btn.innerHTML = `${choice.label}`;
      
      if (isAnswered) {
        btn.disabled = true;
        // Styling logic
        if (choice.key === item.answer) {
          btn.classList.add('correct');
          btn.innerHTML += ` <span class="res-icon">â­•</span>`;
        } else if (choice.key === answeredKey && answeredKey !== item.answer) {
          btn.classList.add('wrong');
          btn.innerHTML += ` <span class="res-icon">âŒ</span>`;
        }
      } else {
        btn.onclick = () => handleAnswer(choice.key);
      }
      els.choiceList.appendChild(btn);
    });

    // 3. Feedback Section
    if (isAnswered) {
      els.feedbackArea.style.display = 'block';
      const isCorrect = answeredKey === item.answer;
      els.resTitle.textContent = isCorrect ? "ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰" : "ì•„ì‰½ë„¤ìš”! ë‹¤ì‹œ í™•ì¸í•´ ë³¼ê¹Œìš”?";
      els.resTitle.style.color = isCorrect ? "var(--success)" : "var(--error)";
      els.expText.innerHTML = item.explain;
    } else {
      els.feedbackArea.style.display = 'none';
    }

    // 4. Navigation Buttons
    els.prevBtn.disabled = currentIdx === 0;
    
    if (currentIdx === quizData.length - 1) {
        els.nextBtn.textContent = "ê²°ê³¼ í™•ì¸ ì™„ë£Œ";
        els.nextBtn.disabled = true; 
    } else {
        els.nextBtn.textContent = "ë‹¤ìŒ ë¬¸ì œ";
        els.nextBtn.disabled = false;
    }
  }

  function handleAnswer(key) {
    if (userAnswers[currentIdx] !== null) return; // Prevent double answer

    userAnswers[currentIdx] = key;
    if (key === quizData[currentIdx].answer) {
      score++;
    }
    
    updateStats();
    renderQuiz();
  }

  function updateStats() {
    els.scoreVal.textContent = score;
    
    const answeredCount = userAnswers.filter(a => a !== null).length;
    const pct = Math.round((answeredCount / quizData.length) * 100);
    
    els.progressFill.style.width = `${pct}%`;
    els.progressPct.textContent = pct;
  }

  function goNext() {
    if (currentIdx < quizData.length - 1) {
      currentIdx++;
      renderQuiz();
    }
  }

  function goPrev() {
    if (currentIdx > 0) {
      currentIdx--;
      renderQuiz();
    }
  }

  function restart() {
    if(!confirm("í€´ì¦ˆë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
    currentIdx = 0;
    score = 0;
    userAnswers.fill(null);
    renderQuiz();
    updateStats();
  }

  // Event Listeners
  els.nextBtn.addEventListener('click', goNext);
  els.prevBtn.addEventListener('click', goPrev);
  els.restartBtn.addEventListener('click', restart);

  // Keyboard support
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight' && !els.nextBtn.disabled) goNext();
    if (e.key === 'ArrowLeft' && !els.prevBtn.disabled) goPrev();
  });

  // Start
  init();

</script>
</body>
</html>

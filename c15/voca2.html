<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>êµì‹¤ ì–´íœ˜ í€´ì¦ˆ (ëª¨ë°”ì¼)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            /* ëª¨ë°”ì¼ì—ì„œ í„°ì¹˜ ì‹œ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
            -webkit-tap-highlight-color: transparent;
        }
        
        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° (ì¹´í…Œê³ ë¦¬ ì˜ì—­ìš©) */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .option-btn:disabled {
            opacity: 0.7;
        }
        .option-btn.correct {
            background-color: #22c55e;
            color: white;
            border-color: #16a34a;
            font-weight: bold;
        }
        .option-btn.wrong {
            background-color: #ef4444;
            color: white;
            border-color: #dc2626;
        }
        .option-btn.faded {
            background-color: #f3f4f6;
            color: #9ca3af;
            border-color: #e5e7eb;
        }

        /* ë¹ˆì¹¸ ìŠ¤íƒ€ì¼ ë°˜ì‘í˜• ì¡°ì • */
        #quiz-question .blank {
            color: #3b82f6;
            font-weight: 700;
            display: inline-block;
            min-width: 60px;
            width: auto;
            padding: 0 5px;
            border-bottom: 3px solid #3b82f6;
            margin: 0 4px;
        }
    </style>
</head>
<body class="bg-gray-50 h-[100dvh] flex flex-col overflow-hidden">

    <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ (ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ ì²˜ë¦¬í•˜ì—¬ ë„˜ì¹¨ ë°©ì§€) -->
    <main class="flex-grow flex flex-col w-full max-w-lg mx-auto p-4 overflow-y-auto">
        
        <!-- 1. í€´ì¦ˆ ì§ˆë¬¸ ì˜ì—­ (ìƒë‹¨) -->
        <div id="quiz-main-content" class="flex flex-col justify-center items-center w-full text-center mt-4 mb-6">
            <div class="flex items-center gap-2 mb-2">
                <span id="quiz-category" class="text-sm font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-md"></span>
                <span id="quiz-question-number" class="text-xs text-gray-400"></span>
            </div>
            
            <!-- ì§ˆë¬¸ í…ìŠ¤íŠ¸: ëª¨ë°”ì¼ì—ì„œëŠ” ì ë‹¹íˆ í¬ê²Œ, ë°ìŠ¤í¬íƒ‘ì—ì„  ë” í¬ê²Œ -->
            <h2 id="quiz-question" class="text-2xl md:text-3xl font-bold text-gray-800 my-4 leading-relaxed break-keep">
                <!-- ì§ˆë¬¸ ë‚´ìš© -->
            </h2>
        </div>

        <!-- 2. í”¼ë“œë°± ì˜ì—­ (ì¤‘ì•™) -->
        <div id="feedback-container" class="min-h-[3rem] flex flex-col justify-center items-center mb-4">
            <p id="quiz-feedback-message" class="text-2xl font-bold transition-all duration-300"></p>
            <p id="quiz-correct-answer" class="text-lg text-gray-600 mt-1 hidden font-medium"></p>
        </div>

        <!-- 3. ì„ íƒì§€ ì˜ì—­ (í•˜ë‹¨) -->
        <div id="quiz-options-container" class="grid grid-cols-1 gap-3 w-full mb-6">
            <!-- ì„ íƒì§€ ë²„íŠ¼ ë™ì  ìƒì„± -->
        </div>

        <!-- ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ (í€´ì¦ˆ í’€ë©´ ë‚˜íƒ€ë‚¨) -->
        <div class="w-full flex justify-center mb-4">
            <button id="next-question-btn" class="w-full md:w-auto px-8 py-4 text-xl font-bold bg-blue-600 text-white rounded-xl shadow-lg hover:bg-blue-700 active:scale-95 transition-all hidden">
                ë‹¤ìŒ ë¬¸ì œ <span class="ml-2">â†’</span>
            </button>
        </div>
    </main>

    <!-- 4. ë„¤ë¹„ê²Œì´ì…˜ (í•˜ë‹¨ ê³ ì •) -->
    <footer class="flex-shrink-0 bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] z-10">
        <div class="max-w-lg mx-auto">
            <!-- ì¹´í…Œê³ ë¦¬ ìŠ¤í¬ë¡¤ ì˜ì—­ -->
            <div id="category-jump-container" class="flex flex-col gap-2 p-3 overflow-x-auto hide-scrollbar">
                <!-- ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const allQuizData = [
                {
                    category: "ìƒí™œ ì‹œì„¤",
                    quizzes: [
                        { korean: "ìˆ˜ë—ë¬¼ì´ ì•ˆ ë‚˜ì˜¤ë‹¤", type: "definition", question: "ë¬¼ ì•ˆ ë‚˜ì™€ìš”." },
                        { korean: "ìˆ˜ë—ë¬¼ì´ ì•ˆ ë‚˜ì˜¤ë‹¤", type: "fill-in-the-blank", question: "ìƒ¤ì›Œë¥¼ í•˜ë ¤ëŠ”ë° ê°‘ìê¸° [ ](ì´)ê°€ ì•ˆ ë‚˜ì™”ì–´ìš”." },
                        { korean: "ì „ê¸°ê°€ ë‚˜ê°€ë‹¤", type: "definition", question: "ë¶ˆ êº¼ì¡Œì–´ìš”. (ì „ê¸° ì•ˆ ë“¤ì–´ì™€ìš”)" },
                        { korean: "ì „ê¸°ê°€ ë‚˜ê°€ë‹¤", type: "fill-in-the-blank", question: "ì–´ì ¯ë°¤ì— [ ](ì´)ê°€ ë‚˜ê°€ì„œ í…”ë ˆë¹„ì „ì´ êº¼ì¡Œì–´ìš”." },
                        { korean: "ë³€ê¸°ê°€ ë§‰íˆë‹¤", type: "definition", question: "í™”ì¥ì‹¤ ë³€ê¸° ë§‰í˜”ì–´ìš”." },
                        { korean: "ë³€ê¸°ê°€ ë§‰íˆë‹¤", type: "fill-in-the-blank", question: "í™”ì¥ì‹¤ [ ](ì´)ê°€ ë§‰í˜€ì„œ ë¬¼ì´ ì•ˆ ë‚´ë ¤ê°€ìš”." },
                        { korean: "ë¬¼ì´ ìƒˆë‹¤", type: "definition", question: "ì²œì¥ì´ë‚˜ ë²½ì—ì„œ ë¬¼ì´ ë–¨ì–´ì ¸ìš”." },
                        { korean: "ë¬¼ì´ ìƒˆë‹¤", type: "fill-in-the-blank", question: "ë¹„ê°€ ì˜¤ë©´ ì²œì¥ì—ì„œ [ ](ì´)ê°€ ìƒˆìš”." },
                        { korean: "ì†ŒìŒì´ ì‹¬í•˜ë‹¤", type: "definition", question: "ë„ˆë¬´ ì‹œë„ëŸ¬ì›Œìš”." },
                        { korean: "ì†ŒìŒì´ ì‹¬í•˜ë‹¤", type: "fill-in-the-blank", question: "ìœ—ì§‘ ê³µì‚¬ ë•Œë¬¸ì— [ ](ì´)ê°€ ì‹¬í•´ì„œ ê³µë¶€ì— ì§‘ì¤‘ì´ ì•ˆ ë¼ìš”." },
                        { korean: "ë‚œë°©ì´ ì•ˆ ë˜ë‹¤", type: "definition", question: "ë°©ì´ ì¶”ì›Œìš”. (ë³´ì¼ëŸ¬ ì•ˆ ë¼ìš”)" },
                        { korean: "ë‚œë°©ì´ ì•ˆ ë˜ë‹¤", type: "fill-in-the-blank", question: "ê²¨ìš¸ì— [ ](ì´)ê°€ ì•ˆ ë¼ì„œ ë„ˆë¬´ ì¶”ì›Œìš”." },
                        { korean: "ì´ìƒí•œ ëƒ„ìƒˆê°€ ë‚˜ë‹¤", type: "definition", question: "ëƒ„ìƒˆê°€ ì´ìƒí•´ìš”." },
                        { korean: "ì´ìƒí•œ ëƒ„ìƒˆê°€ ë‚˜ë‹¤", type: "fill-in-the-blank", question: "ëƒ‰ì¥ê³ ì—ì„œ [ ](ì´)ê°€ ë‚˜ìš”." },
                        { korean: "ë¬¼ì´ ì•ˆ ë‚´ë ¤ê°€ë‹¤", type: "definition", question: "ì‹±í¬ëŒ€ë‚˜ í™”ì¥ì‹¤ì— ë¬¼ì´ ì•ˆ ë¹ ì ¸ìš”." },
                        { korean: "ë¬¼ì´ ì•ˆ ë‚´ë ¤ê°€ë‹¤", type: "fill-in-the-blank", question: "ì„¤ê±°ì§€ë¥¼ í•˜ëŠ”ë° ì‹±í¬ëŒ€ì— [ ](ì´)ê°€ ì•ˆ ë‚´ë ¤ê°€ìš”." }
                    ]
                },
                {
                    category: "ê³„ì•½ ë° ìš”ê¸ˆ",
                    quizzes: [
                        { korean: "ê³„ì•½ì„œ", type: "definition", question: "ì§‘ì´ë‚˜ ë¬¼ê±´ì„ ë¹Œë¦´ ë•Œ ì“°ëŠ” ì„œë¥˜." },
                        { korean: "ê³„ì•½ì„œ", type: "fill-in-the-blank", question: "ì§‘ì„ ê³„ì•½í•  ë•Œ [ ](ì„)ë¥¼ ê¼¼ê¼¼íˆ ì½ì–´ë´ì•¼ í•´ìš”." },
                        { korean: "ê³„ì•½ ê¸°ê°„", type: "definition", question: "ì§‘ì„ ë¹Œë¦¬ê¸°ë¡œ í•œ ì‹œê°„ (ì˜ˆ: 2ë…„)." },
                        { korean: "ê³„ì•½ ê¸°ê°„", type: "fill-in-the-blank", question: "ì´ ì§‘ì˜ [ ](ì€)ëŠ” 2ë…„ì…ë‹ˆë‹¤." },
                        { korean: "ê³„ì•½í•˜ë‹¤", type: "definition", question: "ì§‘ì„ ë¹Œë¦¬ê¸°ë¡œ ì•½ì†í•˜ëŠ” ê²ƒ." },
                        { korean: "ê³„ì•½í•˜ë‹¤", type: "fill-in-the-blank", question: "ë§ˆìŒì— ë“œëŠ” ì§‘ì´ ìˆì–´ì„œ ì˜¤ëŠ˜ [ ](ì„)ë¥¼ í–ˆì–´ìš”." },
                        { korean: "ë³´ì¦ê¸ˆ", type: "definition", question: "ì§‘ ë¹Œë¦´ ë•Œ ë¯¸ë¦¬ ë§¡ê¸°ëŠ” í°ëˆ." },
                        { korean: "ë³´ì¦ê¸ˆ", type: "fill-in-the-blank", question: "ì›”ì„¸ë°©ì„ ì–»ìœ¼ë ¤ë©´ [ ](ì´)ê°€ í•„ìš”í•´ìš”." },
                        { korean: "ê³µê³¼ê¸ˆ", type: "definition", question: "ì „ê¸°, ìˆ˜ë„ ìš”ê¸ˆ ë“±ì„ í•©ì³ì„œ ë¶€ë¥´ëŠ” ë§." },
                        { korean: "ê³µê³¼ê¸ˆ", type: "fill-in-the-blank", question: "ì´ë²ˆ ë‹¬ [ ](ì´)ê°€ ë§ì´ ë‚˜ì™”ì–´ìš”." },
                        { korean: "ì—°ì²´ë£Œ", type: "definition", question: "ìš”ê¸ˆì„ ëŠ¦ê²Œ ëƒˆì„ ë•Œ ë” ë‚´ëŠ” ëˆ." },
                        { korean: "ì—°ì²´ë£Œ", type: "fill-in-the-blank", question: "ìš”ê¸ˆì„ ëŠ¦ê²Œ ë‚´ë©´ [ ](ì„)ë¥¼ ë‚´ì•¼ í•´ìš”." },
                        { korean: "í¬í•¨ë˜ë‹¤", type: "definition", question: "ì–´ë–¤ ê²ƒì— ê°™ì´ ë“¤ì–´ ìˆì–´ìš”." },
                        { korean: "í¬í•¨ë˜ë‹¤", type: "fill-in-the-blank", question: "ê´€ë¦¬ë¹„ì— ìˆ˜ë„ ìš”ê¸ˆì´ [ ](ì´)ê°€ ìˆì–´ìš”." },
                        { korean: "ë‚©ë¶€í•˜ë‹¤", type: "definition", question: "ìš”ê¸ˆì„ ë‚´ìš”." },
                        { korean: "ë‚©ë¶€í•˜ë‹¤", type: "fill-in-the-blank", question: "ì „ê¸° ìš”ê¸ˆì„ ì˜¤ëŠ˜ê¹Œì§€ [ ](ì„)ë¥¼ í•´ì•¼ í•´ìš”." },
                        { korean: "ë°€ë¦¬ë‹¤", type: "definition", question: "ìš”ê¸ˆì„ ì œë•Œ ëª» ëƒˆì–´ìš”." },
                        { korean: "ë°€ë¦¬ë‹¤", type: "fill-in-the-blank", question: "ì›”ì„¸ê°€ ë‘ ë‹¬ì´ë‚˜ [ ](ì´)ê°€ ìˆì–´ìš”." }
                    ]
                },
                {
                    category: "ì¬ì • ë° ì ˆì•½",
                    quizzes: [
                        { korean: "ì§€ì¶œ", type: "definition", question: "ëˆì„ ì¨ìš”." },
                        { korean: "ì§€ì¶œ", type: "fill-in-the-blank", question: "ì´ë²ˆ ë‹¬ì€ [ ](ì´)ê°€ ë„ˆë¬´ ë§ì•˜ì–´ìš”." },
                        { korean: "ìˆ˜ì…", type: "definition", question: "ëˆì„ ë²Œì–´ìš”." },
                        { korean: "ìˆ˜ì…", type: "fill-in-the-blank", question: "[ ](ì´)ê°€ ì§€ì¶œë³´ë‹¤ ì ìœ¼ë©´ ì•ˆ ë¼ìš”." },
                        { korean: "ëŠ˜ë‹¤", type: "definition", question: "ë§ì•„ì¡Œì–´ìš”." },
                        { korean: "ëŠ˜ë‹¤", type: "fill-in-the-blank", question: "ì›”ê¸‰ì´ [ ](ì´)ê°€ ë‚˜ì„œ ê¸°ë¶„ì´ ì¢‹ì•„ìš”." },
                        { korean: "ì¤„ë‹¤", type: "definition", question: "ì ì–´ì¡Œì–´ìš”." },
                        { korean: "ì¤„ë‹¤", type: "fill-in-the-blank", question: "ìš©ëˆì´ [ ](ì´)ê°€ ë“¤ì–´ì„œ ì•„ê»´ ì¨ì•¼ í•´ìš”." },
                        { korean: "ì•„ë¼ë‹¤", type: "definition", question: "ì†Œì¤‘í•˜ê²Œ ì‚¬ìš©í•´ìš”." },
                        { korean: "ì•„ë¼ë‹¤", type: "fill-in-the-blank", question: "ë¬¼ê±´ì„ [ ](ì´)ê°€ ì“°ëŠ” ìŠµê´€ì„ ë“¤ì—¬ì•¼ í•´ìš”." },
                        { korean: "ì ˆì•½í•˜ë‹¤", type: "definition", question: "ì•„ê»´ ì¨ìš”." },
                        { korean: "ì ˆì•½í•˜ë‹¤", type: "fill-in-the-blank", question: "ì „ê¸°ë¥¼ [ ](ì´)ê°€ í•˜ë©´ ìš”ê¸ˆì„ ì¤„ì¼ ìˆ˜ ìˆì–´ìš”." },
                        { korean: "ë‚­ë¹„í•˜ë‹¤", type: "definition", question: "ëˆì´ë‚˜ ë¬¼ê±´ì„ í•¨ë¶€ë¡œ ë§‰ ì¨ìš”." },
                        { korean: "ë‚­ë¹„í•˜ë‹¤", type: "fill-in-the-blank", question: "í•„ìš” ì—†ëŠ” ë¬¼ê±´ì„ ì‚¬ì„œ ëˆì„ [ ](ì„)ë¥¼ í–ˆì–´ìš”." },
                        { korean: "ì €ì¶•í•˜ë‹¤", type: "definition", question: "ëˆì„ ëª¨ì•„ìš”." },
                        { korean: "ì €ì¶•í•˜ë‹¤", type: "fill-in-the-blank", question: "ë§¤ë‹¬ ì›”ê¸‰ì˜ ì¼ë¶€ë¥¼ [ ](ì„)ë¥¼ í•´ìš”." }
                    ]
                }
            ];

            const quizOptionsContainer = document.getElementById('quiz-options-container');
            const quizCategoryEl = document.getElementById('quiz-category');
            const quizQuestionNumberEl = document.getElementById('quiz-question-number');
            const quizQuestionEl = document.getElementById('quiz-question');
            const quizFeedbackMessageEl = document.getElementById('quiz-feedback-message');
            const quizCorrectAnswerEl = document.getElementById('quiz-correct-answer');
            const nextQuestionBtn = document.getElementById('next-question-btn');
            const categoryJumpContainer = document.getElementById('category-jump-container');

            let allVocabularyWords = [];
            let quizList = [];
            let currentQuestionIndex = 0;
            let isAnswered = false;
            let categoryStartIndices = {};

            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            function getAllWords() {
                const words = allQuizData.flatMap(category => 
                    category.quizzes.map(q => q.korean)
                );
                return [...new Set(words)];
            }

            function startQuiz() {
                let fillInBlankQuizzes = [];
                let definitionQuizzes = [];

                categoryStartIndices = {};
                let fillInBlankIndex = 0;
                let definitionIndex = 0;

                allQuizData.forEach(categoryObj => {
                    const categoryName = categoryObj.category;
                    categoryStartIndices[categoryName] = {};

                    let fillIns = categoryObj.quizzes.filter(q => q.type === 'fill-in-the-blank');
                    let shuffledFillIns = shuffleArray(fillIns);
                    
                    categoryStartIndices[categoryName].fill = fillInBlankIndex;
                    fillInBlankQuizzes.push(...shuffledFillIns);
                    fillInBlankIndex += shuffledFillIns.length;

                    let defs = categoryObj.quizzes.filter(q => q.type === 'definition');
                    let shuffledDefs = shuffleArray(defs);

                    categoryStartIndices[categoryName].def = definitionIndex;
                    definitionQuizzes.push(...shuffledDefs);
                    definitionIndex += shuffledDefs.length;
                });

                const totalFillInBlanks = fillInBlankQuizzes.length;
                allQuizData.forEach(categoryObj => {
                    const categoryName = categoryObj.category;
                    categoryStartIndices[categoryName].def += totalFillInBlanks;
                });

                quizList = [...fillInBlankQuizzes, ...definitionQuizzes];
                allVocabularyWords = getAllWords();
                currentQuestionIndex = 0;
                
                createCategoryButtons();
                showQuestion(currentQuestionIndex);
            }

            function createCategoryButtons() {
                categoryJumpContainer.innerHTML = '';

                // Row 1: ë¹ˆì¹¸
                const fillRow = document.createElement('div');
                fillRow.className = "flex items-center gap-2 whitespace-nowrap min-w-max";
                
                const fillLabel = document.createElement('span');
                fillLabel.className = "text-xs font-bold text-gray-500 mr-1 w-8 text-right";
                fillLabel.textContent = "ë¹ˆì¹¸";
                fillRow.appendChild(fillLabel);

                allQuizData.forEach(categoryObj => {
                    const categoryName = categoryObj.category;
                    const jumpIndex = categoryStartIndices[categoryName].fill;
                    
                    const buttonEl = document.createElement('button');
                    buttonEl.textContent = categoryName;
                    buttonEl.className = "category-btn px-3 py-1.5 text-xs font-medium bg-white border border-gray-300 rounded-full text-gray-700 hover:bg-gray-100 transition-colors";
                    buttonEl.dataset.category = categoryName;
                    buttonEl.dataset.type = 'fill-in-the-blank';
                    
                    buttonEl.onclick = () => {
                        currentQuestionIndex = jumpIndex;
                        showQuestion(currentQuestionIndex);
                    };
                    fillRow.appendChild(buttonEl);
                });
                categoryJumpContainer.appendChild(fillRow);

                // Row 2: ëœ»
                const defRow = document.createElement('div');
                defRow.className = "flex items-center gap-2 whitespace-nowrap min-w-max";

                const defLabel = document.createElement('span');
                defLabel.className = "text-xs font-bold text-gray-500 mr-1 w-8 text-right";
                defLabel.textContent = "ëœ»";
                defRow.appendChild(defLabel);

                allQuizData.forEach(categoryObj => {
                    const categoryName = categoryObj.category;
                    const jumpIndex = categoryStartIndices[categoryName].def;
                    
                    const buttonEl = document.createElement('button');
                    buttonEl.textContent = categoryName;
                    buttonEl.className = "category-btn px-3 py-1.5 text-xs font-medium bg-white border border-gray-300 rounded-full text-gray-700 hover:bg-gray-100 transition-colors";
                    buttonEl.dataset.category = categoryName;
                    buttonEl.dataset.type = 'definition';
                    
                    buttonEl.onclick = () => {
                        currentQuestionIndex = jumpIndex;
                        showQuestion(currentQuestionIndex);
                    };
                    defRow.appendChild(buttonEl);
                });
                categoryJumpContainer.appendChild(defRow);
            }

            function showQuestion(index) {
                if (index >= quizList.length) {
                    showQuizComplete();
                    return;
                }

                isAnswered = false;
                const currentItem = quizList[index];
                const currentCategory = allQuizData.find(cat => 
                    cat.quizzes.some(q => q.korean === currentItem.korean)
                ).category;
                const currentType = currentItem.type;

                quizCategoryEl.textContent = currentCategory;
                quizQuestionNumberEl.textContent = `${index + 1}/${quizList.length}`;
                
                if (currentItem.type === 'fill-in-the-blank') {
                    quizQuestionEl.innerHTML = currentItem.question.replace(
                        /\[ \]/, 
                        '<span class="blank">&nbsp;&nbsp;&nbsp;</span>'
                    );
                } else {
                    quizQuestionEl.textContent = currentItem.question;
                }

                quizFeedbackMessageEl.textContent = '';
                quizCorrectAnswerEl.classList.add('hidden');
                nextQuestionBtn.classList.add('hidden');

                const correctAnswer = currentItem.korean;
                const distractors = [];
                while (distractors.length < 3) {
                    const randomWord = allVocabularyWords[Math.floor(Math.random() * allVocabularyWords.length)];
                    if (randomWord !== correctAnswer && !distractors.includes(randomWord)) {
                        distractors.push(randomWord);
                    }
                }

                const options = shuffleArray([correctAnswer, ...distractors]);
                
                quizOptionsContainer.innerHTML = '';
                options.forEach(option => {
                    const buttonEl = document.createElement('button');
                    buttonEl.textContent = option;
                    // ëª¨ë°”ì¼ ì¹œí™”ì  ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ë” í¬ê³  ëˆ„ë¥´ê¸° ì‰½ê²Œ)
                    buttonEl.className = "option-btn w-full px-4 py-4 text-lg font-medium bg-white border border-gray-200 rounded-xl shadow-sm hover:bg-gray-50 active:scale-[0.99] transition-all duration-200";
                    buttonEl.onclick = () => handleAnswer(option, correctAnswer);
                    quizOptionsContainer.appendChild(buttonEl);
                });

                // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í™œì„± ìƒíƒœ í‘œì‹œ
                Array.from(categoryJumpContainer.querySelectorAll('.category-btn')).forEach(btn => {
                    if (btn.dataset.category === currentCategory && btn.dataset.type === currentType) {
                        btn.className = "category-btn px-3 py-1.5 text-xs font-bold bg-blue-100 border border-blue-400 text-blue-700 rounded-full transition-colors shadow-sm";
                    } else {
                        btn.className = "category-btn px-3 py-1.5 text-xs font-medium bg-white border border-gray-300 rounded-full text-gray-700 hover:bg-gray-50 transition-colors";
                    }
                    
                    // í™œì„±í™”ëœ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ì´ í™”ë©´ì— ë³´ì´ë„ë¡ ìë™ ìŠ¤í¬ë¡¤
                    if (btn.classList.contains('bg-blue-100')) {
                        btn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    }
                });
            }

            function handleAnswer(selectedAnswer, correctAnswer) {
                if (isAnswered) return;
                isAnswered = true;

                const isCorrect = selectedAnswer === correctAnswer;

                Array.from(quizOptionsContainer.children).forEach(btn => {
                    btn.disabled = true;
                    if (btn.textContent === correctAnswer) {
                        btn.classList.add('correct');
                        btn.classList.remove('bg-white', 'border-gray-200');
                    } else if (btn.textContent === selectedAnswer) {
                        btn.classList.add('wrong');
                        btn.classList.remove('bg-white', 'border-gray-200');
                    } else {
                        btn.classList.add('faded');
                    }
                });

                if (isCorrect) {
                    quizFeedbackMessageEl.textContent = 'ì •ë‹µ! ğŸ‘';
                    quizFeedbackMessageEl.className = 'text-3xl font-bold text-green-600';
                } else {
                    quizFeedbackMessageEl.textContent = 'ì•„ì‰½ë„¤ìš”!';
                    quizFeedbackMessageEl.className = 'text-3xl font-bold text-red-500';
                    quizCorrectAnswerEl.textContent = `ì •ë‹µ: ${correctAnswer}`;
                    quizCorrectAnswerEl.classList.remove('hidden');
                }

                nextQuestionBtn.classList.remove('hidden');
                // ë‹¤ìŒ ë²„íŠ¼ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ë¶€ë“œëŸ½ê²Œ ì´ë™ (ì‘ì€ í™”ë©´ ëŒ€ì‘)
                nextQuestionBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            nextQuestionBtn.addEventListener('click', () => {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
                // ìƒˆ ë¬¸ì œ ì‹œì‘ ì‹œ ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤
                document.querySelector('main').scrollTop = 0;
            });

            function showQuizComplete() {
                quizOptionsContainer.innerHTML = '';
                categoryJumpContainer.parentElement.style.display = 'none'; // í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ìˆ¨ê¹€
                quizCategoryEl.textContent = '';
                quizQuestionNumberEl.textContent = '';
                
                quizQuestionEl.innerHTML = `
                    <div class="py-10">
                        <div class="text-6xl mb-4">ğŸ‰</div>
                        <div class="text-2xl font-bold text-gray-800">ëª¨ë“  ë¬¸ì œë¥¼ í’€ì—ˆìŠµë‹ˆë‹¤!</div>
                        <div class="text-gray-500 mt-2">ì´ ${quizList.length}ë¬¸ì œ</div>
                    </div>
                `;
                
                quizFeedbackMessageEl.textContent = '';
                quizCorrectAnswerEl.classList.add('hidden');
                
                nextQuestionBtn.innerHTML = 'ë‹¤ì‹œ í’€ê¸° <span class="ml-2">â†»</span>';
                nextQuestionBtn.className = "w-full px-8 py-4 text-xl font-bold bg-green-500 text-white rounded-xl shadow-lg hover:bg-green-600 transition-colors";
                nextQuestionBtn.onclick = () => {
                    location.reload();
                };
            }

            startQuiz();
        });
    </script>
</body>
</html>


<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한국어 쓰기 연습 - 행복한 연애를 위하여</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
        }
        .tab-btn.active {
            border-bottom: 2px solid #4f46e5;
            color: #4f46e5;
            font-weight: 700;
        }
        .helper-card {
            transition: all 0.2s;
        }
        .helper-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        /* Toast Animation */
        #toast {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
        }
        #toast.show {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Navbar -->
    <nav class="bg-indigo-600 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-lg md:text-xl font-bold"><i class="fas fa-pen-nib mr-2"></i>한국어 쓰기 연습</h1>
            <span class="text-sm bg-indigo-500 px-3 py-1 rounded-full">중급 작문 (Viết trung cấp)</span>
        </div>
    </nav>

    <div class="max-w-4xl mx-auto px-4 py-8 space-y-6">

        <!-- Topic Section -->
        <section class="bg-white rounded-xl shadow-md p-6 border-l-4 border-indigo-500">
            <h2 class="text-2xl font-bold text-gray-900 mb-2">오늘의 쓰기 주제 (Chủ đề)</h2>
            <div class="bg-indigo-50 p-4 rounded-lg">
                <p class="text-lg font-medium text-indigo-900 mb-2">
                    "여러분은 연인과 오랫동안 행복하게 지내기 위해 무엇이 가장 중요하다고 생각합니까?"
                </p>
                <p class="text-sm text-gray-600">
                    (Theo bạn, điều gì là quan trọng nhất để sống hạnh phúc lâu dài với người yêu?)
                </p>
            </div>
            <p class="mt-4 text-gray-700">
                위 질문에 대해 자신의 생각을 <strong>200~300자</strong> 내외로 써 보세요.<br>
                김영희 칼럼의 내용을 참고해도 좋고, 자신의 경험을 써도 좋습니다.
            </p>
        </section>

        <!-- Writing Helper (Tabs) -->
        <section class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="border-b border-gray-200 bg-gray-50">
                <div class="flex">
                    <button onclick="switchTab('vocab')" id="tab-vocab" class="tab-btn active flex-1 py-4 text-center text-sm md:text-base text-gray-600 hover:text-indigo-600 font-medium transition">
                        <i class="fas fa-book mr-1"></i> 1. 어휘 도움<br><span class="text-xs font-normal text-gray-400 hidden md:inline">(Từ vựng)</span>
                    </button>
                    <button onclick="switchTab('structure')" id="tab-structure" class="tab-btn flex-1 py-4 text-center text-sm md:text-base text-gray-600 hover:text-indigo-600 font-medium transition">
                        <i class="fas fa-list-ol mr-1"></i> 2. 개요 짜기<br><span class="text-xs font-normal text-gray-400 hidden md:inline">(Dàn ý)</span>
                    </button>
                    <button onclick="switchTab('grammar')" id="tab-grammar" class="tab-btn flex-1 py-4 text-center text-sm md:text-base text-gray-600 hover:text-indigo-600 font-medium transition">
                        <i class="fas fa-magic mr-1"></i> 3. 표현 패턴<br><span class="text-xs font-normal text-gray-400 hidden md:inline">(Mẫu câu)</span>
                    </button>
                </div>
            </div>

            <div class="p-6 bg-white min-h-[200px]">
                
                <!-- Tab 1: Vocabulary -->
                <div id="content-vocab" class="block animate-fade-in">
                    <p class="mb-4 text-gray-600 text-sm">글을 쓸 때 다음 단어들을 활용해 보세요. (Hãy thử sử dụng những từ sau.)</p>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('배려')">
                            <div class="font-bold text-gray-800">배려</div>
                            <div class="text-xs text-gray-500">Sự quan tâm</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('신뢰')">
                            <div class="font-bold text-gray-800">신뢰</div>
                            <div class="text-xs text-gray-500">Sự tin tưởng</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('대화')">
                            <div class="font-bold text-gray-800">대화</div>
                            <div class="text-xs text-gray-500">Trò chuyện</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('존중하다')">
                            <div class="font-bold text-gray-800">존중하다</div>
                            <div class="text-xs text-gray-500">Tôn trọng</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('솔직하다')">
                            <div class="font-bold text-gray-800">솔직하다</div>
                            <div class="text-xs text-gray-500">Thành thật</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('이해하다')">
                            <div class="font-bold text-gray-800">이해하다</div>
                            <div class="text-xs text-gray-500">Thấu hiểu</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('노력하다')">
                            <div class="font-bold text-gray-800">노력하다</div>
                            <div class="text-xs text-gray-500">Nỗ lực</div>
                        </div>
                        <div class="helper-card bg-yellow-50 p-3 rounded text-center cursor-pointer border border-yellow-100" onclick="insertText('맞춰가다')">
                            <div class="font-bold text-gray-800">맞춰가다</div>
                            <div class="text-xs text-gray-500">Hòa hợp</div>
                        </div>
                    </div>
                    <p class="mt-3 text-xs text-right text-gray-400">* 단어를 클릭하면 입력창에 추가됩니다.</p>
                </div>

                <!-- Tab 2: Structure -->
                <div id="content-structure" class="hidden">
                    <p class="mb-4 text-gray-600 text-sm">다음 순서대로 글을 구성하면 논리적입니다. (Cấu trúc bài viết)</p>
                    <div class="space-y-3">
                        <div class="flex items-start">
                            <span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded text-xs font-bold mr-3 mt-1 w-16 text-center">서론</span>
                            <div class="text-sm">
                                <p class="font-bold text-gray-800">주제 소개하기</p>
                                <p class="text-gray-500">사랑하는 사람과 오래 함께하기 위해서는 서로의 노력이 필요합니다.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded text-xs font-bold mr-3 mt-1 w-16 text-center">본론</span>
                            <div class="text-sm">
                                <p class="font-bold text-gray-800">나의 생각 (이유 1, 2)</p>
                                <p class="text-gray-500">첫째, 서로를 믿어야 합니다. 왜냐하면...<br>둘째, 대화를 자주 해야 합니다.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded text-xs font-bold mr-3 mt-1 w-16 text-center">결론</span>
                            <div class="text-sm">
                                <p class="font-bold text-gray-800">정리 및 강조</p>
                                <p class="text-gray-500">따라서 행복한 연애를 위해서는 ~하는 태도가 중요합니다.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: Grammar/Patterns -->
                <div id="content-grammar" class="hidden">
                     <p class="mb-4 text-gray-600 text-sm">자신의 생각을 말할 때 좋은 표현입니다. (Mẫu câu hữu ích)</p>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <button onclick="insertText('제 생각에는 ...이/가 가장 중요하다고 생각합니다.')" class="text-left p-3 border rounded hover:bg-gray-50 text-sm text-gray-700">
                            <span class="font-bold text-indigo-600">● 의견 말하기:</span><br>
                            제 생각에는 ...이/가 가장 중요하다고 생각합니다.
                        </button>
                        <button onclick="insertText('...기 위해서는 ...아/어야 합니다.')" class="text-left p-3 border rounded hover:bg-gray-50 text-sm text-gray-700">
                            <span class="font-bold text-indigo-600">● 조건/의무:</span><br>
                            ...기 위해서는 ...아/어야 합니다.
                        </button>
                        <button onclick="insertText('왜냐하면 ...기 때문입니다.')" class="text-left p-3 border rounded hover:bg-gray-50 text-sm text-gray-700">
                            <span class="font-bold text-indigo-600">● 이유 말하기:</span><br>
                            왜냐하면 ...기 때문입니다.
                        </button>
                        <button onclick="insertText('예를 들어 ...')" class="text-left p-3 border rounded hover:bg-gray-50 text-sm text-gray-700">
                            <span class="font-bold text-indigo-600">● 예시 들기:</span><br>
                            예를 들어 ...
                        </button>
                     </div>
                     <p class="mt-3 text-xs text-right text-gray-400">* 문장을 클릭하면 입력창에 추가됩니다.</p>
                </div>

            </div>
        </section>

        <!-- Writing Area -->
        <section class="bg-white rounded-xl shadow-md p-6 relative">
            <h3 class="font-bold text-lg mb-4 flex justify-between items-center">
                <span><i class="fas fa-keyboard mr-2 text-indigo-500"></i>글쓰기 (Viết bài)</span>
                <span id="char-count" class="text-sm font-normal text-gray-500">0 / 300자</span>
            </h3>
            
            <textarea id="writing-area" 
                class="w-full h-64 p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none leading-loose text-lg"
                placeholder="여기에 글을 작성하세요. 위의 도움말(어휘, 표현)을 클릭하면 내용이 추가됩니다."></textarea>
            
            <p id="save-status" class="text-xs text-gray-400 mt-2 text-right italic h-4"></p>

            <!-- Self Check Checklist -->
            <div class="mt-4 bg-gray-50 p-4 rounded-lg">
                <h4 class="font-bold text-sm text-gray-700 mb-2">자가 점검 (Tự kiểm tra)</h4>
                <div class="flex flex-wrap gap-4 text-sm text-gray-600">
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span>주제가 명확한가요?</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span>접속사(그리고, 하지만)를 잘 썼나요?</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" class="rounded text-indigo-600 focus:ring-indigo-500">
                        <span>맞춤법을 확인했나요?</span>
                    </label>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-6 flex flex-wrap justify-end gap-3">
                 <button onclick="saveManual()" class="px-5 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 shadow-md transition font-bold flex items-center">
                    <i class="fas fa-save mr-2"></i>저장하기 (Lưu)
                </button>
                <button onclick="clearText()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-100 transition">
                    지우기 (Xóa)
                </button>
                <button onclick="copyText()" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 shadow-md transition font-bold">
                    <i class="fas fa-copy mr-2"></i>복사하기 (Sao chép)
                </button>
            </div>
        </section>

    </div>

    <!-- Success Modal (Copy) -->
    <div id="copy-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full mx-4 text-center transform transition-all scale-100">
            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4">
                <i class="fas fa-check text-green-600 text-xl"></i>
            </div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">복사되었습니다!</h3>
            <p class="text-sm text-gray-500 mb-4">작성한 글이 클립보드에 복사되었습니다.<br>과제 제출란에 붙여넣기 하세요.</p>
            <button onclick="closeModal()" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:text-sm">
                확인 (Đóng)
            </button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-10 right-1/2 transform translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-full shadow-lg z-50 flex items-center gap-2">
        <i class="fas fa-info-circle text-yellow-400"></i>
        <span id="toast-message">메시지</span>
    </div>

    <script>
        // Storage Key
        const STORAGE_KEY = 'korean_writing_practice_content';
        const textarea = document.getElementById('writing-area');
        const countDisplay = document.getElementById('char-count');
        const saveStatus = document.getElementById('save-status');

        // --- Load Saved Content on Start ---
        window.addEventListener('DOMContentLoaded', () => {
            const savedContent = localStorage.getItem(STORAGE_KEY);
            if (savedContent) {
                textarea.value = savedContent;
                updateCount();
                saveStatus.innerText = "이전에 작성하던 글을 불러왔습니다. (Đã tải nội dung trước đó)";
            }
        });

        // --- Auto Save Logic ---
        let autoSaveTimer;
        textarea.addEventListener('input', () => {
            updateCount();
            
            saveStatus.innerText = "작성 중... (Đang viết...)";
            
            // Debounce: Wait 1 second after typing stops to save
            clearTimeout(autoSaveTimer);
            autoSaveTimer = setTimeout(() => {
                localStorage.setItem(STORAGE_KEY, textarea.value);
                saveStatus.innerText = "자동 저장됨 " + new Date().toLocaleTimeString();
            }, 1000);
        });

        // --- Manual Save Logic ---
        function saveManual() {
            localStorage.setItem(STORAGE_KEY, textarea.value);
            showToast("안전하게 저장되었습니다! (Đã lưu thành công)");
            saveStatus.innerText = "수동 저장됨 " + new Date().toLocaleTimeString();
        }

        // --- Toast Helper ---
        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = msg;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Tab Switching Logic
        function switchTab(tabName) {
            ['vocab', 'structure', 'grammar'].forEach(name => {
                document.getElementById(`content-${name}`).classList.add('hidden');
                document.getElementById(`tab-${name}`).classList.remove('active', 'text-indigo-600');
                document.getElementById(`tab-${name}`).classList.add('text-gray-600');
            });

            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            const activeBtn = document.getElementById(`tab-${tabName}`);
            activeBtn.classList.add('active', 'text-indigo-600');
            activeBtn.classList.remove('text-gray-600');
        }

        // Insert Text Helper
        function insertText(text) {
            const startPos = textarea.selectionStart;
            const endPos = textarea.selectionEnd;
            const currentValue = textarea.value;
            textarea.value = currentValue.substring(0, startPos) + text + currentValue.substring(endPos);
            textarea.selectionStart = textarea.selectionEnd = startPos + text.length;
            textarea.focus();
            
            // Trigger input event for auto-save
            textarea.dispatchEvent(new Event('input'));
        }

        function updateCount() {
            const length = textarea.value.length;
            countDisplay.innerText = `${length} / 300자`;
            countDisplay.classList.toggle('text-red-500', length > 300);
        }

        // Clear Text
        function clearText() {
            if(confirm('정말 삭제하시겠습니까? 저장된 내용도 함께 삭제됩니다.\n(Bạn có muốn xóa tất cả không?)')) {
                textarea.value = '';
                localStorage.removeItem(STORAGE_KEY); // Clear Storage
                saveStatus.innerText = "";
                updateCount();
                showToast("모두 지워졌습니다. (Đã xóa)");
            }
        }

        // Copy Text
        function copyText() {
            textarea.select();
            textarea.setSelectionRange(0, 99999);
            try {
                document.execCommand('copy');
                document.getElementById('copy-modal').classList.remove('hidden');
            } catch (err) {
                alert('복사 실패');
            }
        }

        function closeModal() {
            document.getElementById('copy-modal').classList.add('hidden');
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í•œêµ­ì–´ ë¬¸ë²• í•™ìŠµ: -(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Nunito:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
            -webkit-tap-highlight-color: transparent;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }

        .tab-btn {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
            font-weight: 700;
        }

        .card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Speak Button Animation */
        .speak-btn:active {
            transform: scale(0.9);
            color: #2563eb;
        }
        
        /* Quiz Option Animation */
        .quiz-option {
            transition: all 0.2s;
        }
        .quiz-option:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-20">
        <div class="max-w-5xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="bg-blue-600 text-white p-2 rounded-lg shadow-sm">
                    <i class="fas fa-book-reader"></i>
                </div>
                <h1 class="text-lg md:text-xl font-bold text-gray-800 tracking-tight line-clamp-1" id="app-title">ë¬¸ë²• í•™ìŠµ</h1>
            </div>
            
            <div class="relative">
                <select id="language-selector" class="appearance-none bg-gray-100 border border-gray-200 text-gray-700 py-2 pl-3 pr-8 rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="vi">ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500">
                    <i class="fas fa-chevron-down text-xs"></i>
                </div>
            </div>
        </div>
        
        <!-- Tabs -->
        <nav class="flex border-b border-gray-200 bg-white">
            <button data-tab="explanation" class="tab-btn flex-1 py-3 text-gray-500 font-medium text-center focus:outline-none" id="explanation-tab-btn">
                <i class="fas fa-chalkboard-teacher mr-1"></i> <span class="tab-text">ì„¤ëª…</span>
            </button>
            <button data-tab="practice" class="tab-btn flex-1 py-3 text-gray-500 font-medium text-center focus:outline-none" id="practice-tab-btn">
                <i class="fas fa-pencil-alt mr-1"></i> <span class="tab-text">ì—°ìŠµ</span>
            </button>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="flex-grow p-4 md:p-6 max-w-5xl mx-auto w-full">
        
        <!-- Explanation Section -->
        <section id="explanation-section" class="space-y-6">
            <!-- Intro Card -->
            <div class="bg-blue-50 border border-blue-100 rounded-xl p-5 md:p-6 shadow-sm">
                <div class="flex items-start gap-3">
                    <i class="fas fa-info-circle text-blue-600 text-xl mt-1"></i>
                    <div>
                        <h2 id="exp-title" class="text-xl md:text-2xl font-bold text-blue-800 mb-2">-(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤</h2>
                        <p id="exp-intro" class="text-gray-700 leading-relaxed">ìƒí™©ì„ ë³´ê³  ì¶”ì¸¡í•  ë•Œ ì‚¬ìš©í•´ìš”.</p>
                        <!-- Tip Box -->
                        <div class="mt-4 bg-white/60 p-3 rounded-lg border border-blue-100 text-sm text-gray-600">
                            <strong class="text-blue-700">Tip!</strong> <span id="exp-tip">'-(ìœ¼)ã„¹ ê²ƒ ê°™ë‹¤'ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ, '-(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤'ëŠ” ì§ì ‘ ë³´ê±°ë‚˜ ë“¤ì€ ê·¼ê±°ê°€ ìˆì„ ë•Œ ë” ìì—°ìŠ¤ëŸ¬ì›Œìš”.</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rules Grid (Tablet: 2 Columns) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                
                <!-- Adjective Card -->
                <div class="card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="flex items-center gap-2 mb-3 border-b border-gray-100 pb-2">
                        <span class="bg-pink-100 text-pink-600 p-1.5 rounded-md text-xs"><i class="fas fa-star"></i></span>
                        <h3 id="exp-adjective-title" class="font-bold text-gray-800">í˜•ìš©ì‚¬ (Adjective)</h3>
                    </div>
                    <ul class="space-y-3 text-sm">
                        <li class="bg-gray-50 p-2.5 rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-xs">ë°›ì¹¨ X / ã„¹</span>
                                <span class="font-bold text-pink-600 bg-white px-2 py-0.5 rounded shadow-sm border border-gray-100">-ã„´ ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>ë°”ì˜ë‹¤ â†’ ë°”ìœ ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ë°”ìœ ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                        <li class="bg-gray-50 p-2.5 rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-xs">ë°›ì¹¨ O</span>
                                <span class="font-bold text-pink-600 bg-white px-2 py-0.5 rounded shadow-sm border border-gray-100">-ì€ ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>ì‘ë‹¤ â†’ ì‘ì€ ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ì‘ì€ ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                        <li class="bg-red-50 p-2.5 rounded-lg border border-red-100">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-red-500 text-xs font-bold">Exception (ìˆë‹¤/ì—†ë‹¤)</span>
                                <span class="font-bold text-red-600 bg-white px-2 py-0.5 rounded shadow-sm border border-red-100">-ëŠ” ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>ë§›ìˆë‹¤ â†’ ë§›ìˆëŠ” ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ë§›ìˆëŠ” ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Verb Card -->
                <div class="card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="flex items-center gap-2 mb-3 border-b border-gray-100 pb-2">
                        <span class="bg-green-100 text-green-600 p-1.5 rounded-md text-xs"><i class="fas fa-running"></i></span>
                        <h3 id="exp-verb-title" class="font-bold text-gray-800">ë™ì‚¬ (Verb)</h3>
                    </div>
                    <ul class="space-y-3 text-sm">
                        <li class="bg-gray-50 p-2.5 rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-xs">Present (í˜„ì¬)</span>
                                <span class="font-bold text-green-600 bg-white px-2 py-0.5 rounded shadow-sm border border-gray-100">-ëŠ” ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>ê°€ë‹¤ â†’ ê°€ëŠ” ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ê°€ëŠ” ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1 mt-1 border-t border-gray-200 pt-1">
                                <span>ë¨¹ë‹¤ â†’ ë¨¹ëŠ” ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ë¨¹ëŠ” ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <!-- Noun Card -->
                <div class="card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="flex items-center gap-2 mb-3 border-b border-gray-100 pb-2">
                        <span class="bg-purple-100 text-purple-600 p-1.5 rounded-md text-xs"><i class="fas fa-user-tag"></i></span>
                        <h3 id="exp-noun-title" class="font-bold text-gray-800">ëª…ì‚¬ (Noun)</h3>
                    </div>
                    <ul class="space-y-3 text-sm">
                        <li class="bg-gray-50 p-2.5 rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-xs">Present (í˜„ì¬)</span>
                                <span class="font-bold text-purple-600 bg-white px-2 py-0.5 rounded shadow-sm border border-gray-100">-ì¸ ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>í•™ìƒ â†’ í•™ìƒì¸ ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('í•™ìƒì¸ ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Tense Card -->
                <div class="card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
                    <div class="flex items-center gap-2 mb-3 border-b border-gray-100 pb-2">
                        <span class="bg-amber-100 text-amber-600 p-1.5 rounded-md text-xs"><i class="fas fa-clock"></i></span>
                        <h3 id="exp-tense-title" class="font-bold text-gray-800">ì‹œì œ (Tense)</h3>
                    </div>
                    <ul class="space-y-3 text-sm">
                        <li class="bg-gray-50 p-2.5 rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-xs">Past (ê³¼ê±°)</span>
                                <span class="font-bold text-amber-600 bg-white px-2 py-0.5 rounded shadow-sm border border-gray-100">-ì•˜/ì—ˆë˜ ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>ë¹„ê°€ ë§ì´ ì™”ë˜ ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ë¹„ê°€ ë§ì´ ì™”ë˜ ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                        <li class="bg-gray-50 p-2.5 rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-xs">Future (ë¯¸ë˜)</span>
                                <span class="font-bold text-amber-600 bg-white px-2 py-0.5 rounded shadow-sm border border-gray-100">-(ìœ¼)ã„¹ ëª¨ì–‘ì´ë‹¤</span>
                            </div>
                            <div class="flex items-center justify-between text-gray-700 pl-1">
                                <span>ë¹„ê°€ ì˜¬ ëª¨ì–‘ì´ë‹¤</span>
                                <button class="speak-btn text-gray-400 hover:text-blue-500" onclick="speak('ë¹„ê°€ ì˜¬ ëª¨ì–‘ì´ë‹¤')"><i class="fas fa-volume-up"></i></button>
                            </div>
                        </li>
                    </ul>
                </div>

            </div>
        </section>

        <!-- Practice Section -->
        <section id="practice-section" class="hidden space-y-6">
            <div class="bg-indigo-50 border border-indigo-100 rounded-xl p-5 shadow-sm text-center">
                <h2 id="quiz-title" class="text-xl font-bold text-indigo-800 mb-1">ì—°ìŠµ ë¬¸ì œ</h2>
                <p id="quiz-instruction" class="text-gray-600 text-sm">ìƒí™©ì„ ë³´ê³  ì•Œë§ì€ ë§ì„ ê³ ë¥´ì„¸ìš”.</p>
            </div>

            <div id="quiz-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Quiz items injected here -->
            </div>
        </section>

    </main>

    <script>
        // Data & Translations
        const translations = {
            ko: {
                title: "ë¬¸ë²• í•™ìŠµ: -(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                tabExp: "ì„¤ëª…",
                tabPrac: "ì—°ìŠµ",
                expTitle: "-(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                expIntro: "ì–´ë–¤ ìƒí™©ì„ ë³´ê³  ê·¸ ì´ìœ ë‚˜ ìƒíƒœë¥¼ ì¶”ì¸¡í•  ë•Œ ì‚¬ìš©í•´ìš”. (ê·¼ê±°ê°€ ìˆëŠ” ì¶”ì¸¡)",
                expTip: "'-(ìœ¼)ã„¹ ê²ƒ ê°™ë‹¤'ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ, ì§ì ‘ ë³´ê±°ë‚˜ ë“¤ì€ ê·¼ê±°ê°€ ìˆì„ ë•Œ ë” ìì—°ìŠ¤ëŸ¬ì›Œìš”.",
                titles: { adj: "í˜•ìš©ì‚¬ (Adjective)", verb: "ë™ì‚¬ (Verb)", noun: "ëª…ì‚¬ (Noun)", tense: "ì‹œì œ (Tense)" },
                rules: {
                    adj1: "ë°›ì¹¨ X / ã„¹ ë°›ì¹¨", adj1_ex: "ë°”ì˜ë‹¤ â†’ ë°”ìœ ëª¨ì–‘ì´ë‹¤",
                    adj2: "ë°›ì¹¨ O", adj2_ex: "ì‘ë‹¤ â†’ ì‘ì€ ëª¨ì–‘ì´ë‹¤",
                    adj3: "ì˜ˆì™¸ (ìˆë‹¤/ì—†ë‹¤)", adj3_ex: "ë§›ìˆë‹¤ â†’ ë§›ìˆëŠ” ëª¨ì–‘ì´ë‹¤",
                    verb1: "í˜„ì¬ (Present)", verb1_ex1: "ê°€ë‹¤ â†’ ê°€ëŠ” ëª¨ì–‘ì´ë‹¤", verb1_ex2: "ë¨¹ë‹¤ â†’ ë¨¹ëŠ” ëª¨ì–‘ì´ë‹¤",
                    noun1: "í˜„ì¬ (Present)", noun1_ex: "í•™ìƒ â†’ í•™ìƒì¸ ëª¨ì–‘ì´ë‹¤",
                    past: "ê³¼ê±° (Past)", past_ex: "ë¹„ê°€ ë§ì´ ì™”ë˜ ëª¨ì–‘ì´ë‹¤",
                    future: "ë¯¸ë˜ (Future)", future_ex: "ê³§ ë¹„ê°€ ì˜¬ ëª¨ì–‘ì´ë‹¤"
                },
                quizTitle: "ì—°ìŠµ ë¬¸ì œ",
                quizInst: "ìƒí™©ì„ ë³´ê³  ë¹ˆì¹¸ì— ì•Œë§ì€ ë§ì„ ê³ ë¥´ì„¸ìš”.",
                quizzes: [
                    { situation: "ë°–ì—ì„œ ì¦ê±°ìš´ ì›ƒìŒì†Œë¦¬ê°€ ë“¤ë ¤ìš”.", context: "ì¬ë¯¸ìˆëŠ” TV í”„ë¡œê·¸ë¨ì„ ____ ëª¨ì–‘ì´ì—ìš”.", options: ["ë³´ëŠ”", "ë³¸", "ë³¼"], answer: "ë³´ëŠ”" },
                    { situation: "ì¹œêµ¬ê°€ í•˜í’ˆì„ ê³„ì†í•´ìš”.", context: "ì–´ì ¯ë°¤ì— ì ì„ ì˜ ____ ëª¨ì–‘ì´ì—ìš”.", options: ["ëª» ìëŠ”", "ëª» ì”", "ëª» ì˜"], answer: "ëª» ì”" },
                    { situation: "ì‹ë‹¹ ì•ì— ì‚¬ëŒë“¤ì´ ì¤„ì„ ì„œ ìˆì–´ìš”.", context: "ì € ì‹ë‹¹ì€ ìŒì‹ì´ ì•„ì£¼ ____ ëª¨ì–‘ì´ì—ìš”.", options: ["ë§›ìˆëŠ”", "ë§›ìˆê³ ", "ë§›ìˆì€"], answer: "ë§›ìˆëŠ”" },
                    { situation: "ì¹œêµ¬ê°€ ê°‘ìê¸° ë›°ê¸° ì‹œì‘í•´ìš”.", context: "ì•½ì† ì‹œê°„ì— ____ ëª¨ì–‘ì´ì—ìš”.", options: ["ëŠ¦ëŠ”", "ëŠ¦ì€", "ëŠ¦ì„"], answer: "ëŠ¦ëŠ”" }
                ],
                feedback: { correct: "ì •ë‹µì…ë‹ˆë‹¤! ì˜í–ˆì–´ìš”.", incorrect: "ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”." }
            },
            vi: {
                title: "Há»c ngá»¯ phÃ¡p: -(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                tabExp: "Giáº£i thÃ­ch",
                tabPrac: "Luyá»‡n táº­p",
                expTitle: "-(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                expIntro: "Sá»­ dá»¥ng khi phá»ng Ä‘oÃ¡n dá»±a trÃªn tÃ¬nh huá»‘ng quan sÃ¡t Ä‘Æ°á»£c. (Phá»ng Ä‘oÃ¡n cÃ³ cÄƒn cá»©)",
                expTip: "Giá»‘ng '-(ìœ¼)ã„¹ ê²ƒ ê°™ë‹¤', nhÆ°ng tá»± nhiÃªn hÆ¡n khi cÃ³ cÄƒn cá»© trá»±c tiáº¿p.",
                titles: { adj: "TÃ­nh tá»«", verb: "Äá»™ng tá»«", noun: "Danh tá»«", tense: "ThÃ¬ (Thá»i gian)" },
                rules: {
                    adj1: "KhÃ´ng patchim / ã„¹", adj1_ex: "ë°”ì˜ë‹¤ â†’ ë°”ìœ ëª¨ì–‘ì´ë‹¤",
                    adj2: "CÃ³ patchim", adj2_ex: "ì‘ë‹¤ â†’ ì‘ì€ ëª¨ì–‘ì´ë‹¤",
                    adj3: "Ngoáº¡i lá»‡ (ìˆë‹¤/ì—†ë‹¤)", adj3_ex: "ë§›ìˆë‹¤ â†’ ë§›ìˆëŠ” ëª¨ì–‘ì´ë‹¤",
                    verb1: "Hiá»‡n táº¡i", verb1_ex1: "ê°€ë‹¤ â†’ ê°€ëŠ” ëª¨ì–‘ì´ë‹¤", verb1_ex2: "ë¨¹ë‹¤ â†’ ë¨¹ëŠ” ëª¨ì–‘ì´ë‹¤",
                    noun1: "Hiá»‡n táº¡i", noun1_ex: "í•™ìƒ â†’ í•™ìƒì¸ ëª¨ì–‘ì´ë‹¤",
                    past: "QuÃ¡ khá»©", past_ex: "ë¹„ê°€ ë§ì´ ì™”ë˜ ëª¨ì–‘ì´ë‹¤ (ÄÃ£ mÆ°a)",
                    future: "TÆ°Æ¡ng lai", future_ex: "ë¹„ê°€ ì˜¬ ëª¨ì–‘ì´ë‹¤ (Sáº¯p mÆ°a)"
                },
                quizTitle: "BÃ i táº­p luyá»‡n táº­p",
                quizInst: "Chá»n tá»« Ä‘Ãºng dá»±a trÃªn tÃ¬nh huá»‘ng.",
                quizzes: [
                    { situation: "Nghe tháº¥y tiáº¿ng cÆ°á»i vui váº» bÃªn ngoÃ i.", context: "HÃ¬nh nhÆ° há» Ä‘ang ____ chÆ°Æ¡ng trÃ¬nh TV thÃº vá»‹.", options: ["ë³´ëŠ”", "ë³¸", "ë³¼"], answer: "ë³´ëŠ”" },
                    { situation: "Báº¡n tÃ´i ngÃ¡p liÃªn tá»¥c.", context: "HÃ¬nh nhÆ° tá»‘i qua ____ ngá»§ ngon.", options: ["ëª» ìëŠ”", "ëª» ì”", "ëª» ì˜"], answer: "ëª» ì”" },
                    { situation: "NgÆ°á»i ta xáº¿p hÃ ng trÆ°á»›c quÃ¡n Äƒn.", context: "HÃ¬nh nhÆ° Ä‘á»“ Äƒn á»Ÿ Ä‘Ã³ ____ láº¯m.", options: ["ë§›ìˆëŠ”", "ë§›ìˆê³ ", "ë§›ìˆì€"], answer: "ë§›ìˆëŠ”" },
                    { situation: "Báº¡n tÃ´i Ä‘á»™t nhiÃªn cháº¡y Ä‘i.", context: "HÃ¬nh nhÆ° ____ giá» háº¹n.", options: ["ëŠ¦ëŠ”", "ëŠ¦ì€", "ëŠ¦ì„"], answer: "ëŠ¦ëŠ”" }
                ],
                feedback: { correct: "ChÃ­nh xÃ¡c!", incorrect: "Thá»­ láº¡i nhÃ©." }
            },
            ja: {
                title: "æ–‡æ³•å­¦ç¿’: -(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                tabExp: "èª¬æ˜",
                tabPrac: "ç·´ç¿’",
                expTitle: "-(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                expIntro: "çŠ¶æ³ã‚’è¦‹ã¦æ¨æ¸¬ã™ã‚‹æ™‚ã«ä½¿ã„ã¾ã™ã€‚(æ ¹æ‹ ã®ã‚ã‚‹æ¨æ¸¬)",
                expTip: "'-(ìœ¼)ã„¹ ê²ƒ ê°™ë‹¤'ã¨ä¼¼ã¦ã„ã¾ã™ãŒã€ç›´æ¥è¦‹ãŸã‚Šèã„ãŸã‚Šã—ãŸæ ¹æ‹ ãŒã‚ã‚‹æ™‚ã«ã‚ˆãä½¿ã„ã¾ã™ã€‚",
                titles: { adj: "å½¢å®¹è©", verb: "å‹•è©", noun: "åè©", tense: "æ™‚åˆ¶" },
                rules: {
                    adj1: "ãƒ‘ãƒƒãƒãƒ ç„¡ / ã„¹", adj1_ex: "ë°”ì˜ë‹¤ â†’ ë°”ìœ ëª¨ì–‘ì´ë‹¤",
                    adj2: "ãƒ‘ãƒƒãƒãƒ æœ‰", adj2_ex: "ì‘ë‹¤ â†’ ì‘ì€ ëª¨ì–‘ì´ë‹¤",
                    adj3: "ä¾‹å¤– (ìˆë‹¤/ì—†ë‹¤)", adj3_ex: "ë§›ìˆë‹¤ â†’ ë§›ìˆëŠ” ëª¨ì–‘ì´ë‹¤",
                    verb1: "ç¾åœ¨", verb1_ex1: "ê°€ë‹¤ â†’ ê°€ëŠ” ëª¨ì–‘ì´ë‹¤", verb1_ex2: "ë¨¹ë‹¤ â†’ ë¨¹ëŠ” ëª¨ì–‘ì´ë‹¤",
                    noun1: "ç¾åœ¨", noun1_ex: "í•™ìƒ â†’ í•™ìƒì¸ ëª¨ì–‘ì´ë‹¤",
                    past: "éå»", past_ex: "ë¹„ê°€ ë§ì´ ì™”ë˜ ëª¨ì–‘ì´ë‹¤ (é›¨ãŒé™ã£ãŸã‚ˆã†ã )",
                    future: "æœªæ¥", future_ex: "ë¹„ê°€ ì˜¬ ëª¨ì–‘ì´ë‹¤ (é›¨ãŒé™ã‚‹ã‚ˆã†ã )"
                },
                quizTitle: "ç·´ç¿’å•é¡Œ",
                quizInst: "çŠ¶æ³ã‚’è¦‹ã¦é©åˆ‡ãªè¨€è‘‰ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚",
                quizzes: [
                    { situation: "å¤–ã‹ã‚‰ç¬‘ã„å£°ãŒèã“ãˆã¾ã™ã€‚", context: "é¢ç™½ã„ãƒ†ãƒ¬ãƒ“ç•ªçµ„ã‚’ ____ ã‚ˆã†ã§ã™ã€‚", options: ["ë³´ëŠ”", "ë³¸", "ë³¼"], answer: "ë³´ëŠ”" },
                    { situation: "å‹é”ãŒã‚ãã³ã‚’ã—ã¦ã„ã¾ã™ã€‚", context: "æ˜¨å¤œã€ã‚ˆã ____ ã‚ˆã†ã§ã™ã€‚", options: ["ëª» ìëŠ”", "ëª» ì”", "ëª» ì˜"], answer: "ëª» ì”" },
                    { situation: "åº—ã®å‰ã«è¡Œåˆ—ãŒã§ãã¦ã„ã¾ã™ã€‚", context: "ã‚ã®åº—ã¯æ–™ç†ãŒ ____ ã‚ˆã†ã§ã™ã€‚", options: ["ë§›ìˆëŠ”", "ë§›ìˆê³ ", "ë§›ìˆì€"], answer: "ë§›ìˆëŠ”" },
                    { situation: "å‹é”ãŒæ€¥ã«èµ°ã‚Šå‡ºã—ã¾ã—ãŸã€‚", context: "ç´„æŸã®æ™‚é–“ã« ____ ã‚ˆã†ã§ã™ã€‚", options: ["ëŠ¦ëŠ”", "ëŠ¦ì€", "ëŠ¦ã‚’"], answer: "ëŠ¦ëŠ”" }
                ],
                feedback: { correct: "æ­£è§£ã§ã™ï¼", incorrect: "ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚" }
            },
            zh: {
                title: "è¯­æ³•å­¦ä¹ : -(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                tabExp: "è¯´æ˜",
                tabPrac: "ç»ƒä¹ ",
                expTitle: "-(ìœ¼)ã„´/ëŠ” ëª¨ì–‘ì´ë‹¤",
                expIntro: "æ ¹æ®è§‚å¯Ÿåˆ°çš„æƒ…å†µè¿›è¡Œæ¨æµ‹æ—¶ä½¿ç”¨ã€‚ï¼ˆæœ‰æ ¹æ®çš„æ¨æµ‹ï¼‰",
                expTip: "è™½ç„¶å’Œ '-(ìœ¼)ã„¹ ê²ƒ ê°™ë‹¤' ç›¸ä¼¼ï¼Œä½†åœ¨æœ‰äº²çœ¼çœ‹åˆ°æˆ–å¬åˆ°çš„æ ¹æ®æ—¶ä½¿ç”¨æ›´è‡ªç„¶ã€‚",
                titles: { adj: "å½¢å®¹è¯", verb: "åŠ¨è¯", noun: "åè¯", tense: "æ—¶æ€" },
                rules: {
                    adj1: "æ— æ”¶éŸ³ / ã„¹æ”¶éŸ³", adj1_ex: "ë°”ì˜ë‹¤ â†’ ë°”ìœ ëª¨ì–‘ì´ë‹¤",
                    adj2: "æœ‰æ”¶éŸ³", adj2_ex: "ì‘ë‹¤ â†’ ì‘ì€ ëª¨ì–‘ì´ë‹¤",
                    adj3: "ä¾‹å¤– (ìˆë‹¤/ì—†ë‹¤)", adj3_ex: "ë§›ìˆë‹¤ â†’ ë§›ìˆëŠ” ëª¨ì–‘ì´ë‹¤",
                    verb1: "ç°åœ¨", verb1_ex1: "ê°€ë‹¤ â†’ ê°€ëŠ” ëª¨ì–‘ì´ë‹¤", verb1_ex2: "ë¨¹ë‹¤ â†’ ë¨¹ëŠ” ëª¨ì–‘ì´ë‹¤",
                    noun1: "ç°åœ¨", noun1_ex: "í•™ìƒ â†’ í•™ìƒì¸ ëª¨ì–‘ì´ë‹¤",
                    past: "è¿‡å»", past_ex: "ë¹„ê°€ ë§ì´ ì™”ë˜ ëª¨ì–‘ì´ë‹¤ (å¥½åƒä¸‹è¿‡é›¨)",
                    future: "æœªæ¥", future_ex: "ë¹„ê°€ ì˜¬ ëª¨ì–‘ì´ë‹¤ (å¥½åƒè¦ä¸‹é›¨)"
                },
                quizTitle: "ç»ƒä¹ é¢˜",
                quizInst: "è¯·æ ¹æ®æƒ…å†µé€‰æ‹©æ­£ç¡®çš„è¯ã€‚",
                quizzes: [
                    { situation: "å¤–é¢ä¼ æ¥ç¬‘å£°ã€‚", context: "å¥½åƒåœ¨ ____ æœ‰è¶£çš„ç”µè§†èŠ‚ç›®ã€‚", options: ["ë³´ëŠ”", "ë³¸", "ë³¼"], answer: "ë³´ëŠ”" },
                    { situation: "æœ‹å‹ä¸€ç›´åœ¨æ‰“å“ˆæ¬ ã€‚", context: "æ˜¨æ™šå¥½åƒæ²¡ ____ è§‰ã€‚", options: ["ëª» ìëŠ”", "ëª» ì”", "ëª» ì˜"], answer: "ëª» ì”" },
                    { situation: "é¤å…å‰æ’ç€é˜Ÿã€‚", context: "é‚£å®¶é¤å…çš„èœå¥½åƒå¾ˆ ____ ã€‚", options: ["ë§›ìˆëŠ”", "ë§›ìˆê³ ", "ë§›ìˆì€"], answer: "ë§›ìˆëŠ”" },
                    { situation: "æœ‹å‹çªç„¶è·‘äº†èµ·æ¥ã€‚", context: "çº¦ä¼šå¥½åƒè¦ ____ ã€‚", options: ["ëŠ¦ëŠ”", "ëŠ¦ì€", "ëŠ¦ì„"], answer: "ëŠ¦ëŠ”" }
                ],
                feedback: { correct: "å›ç­”æ­£ç¡®ï¼", incorrect: "è¯·å†è¯•ä¸€æ¬¡ã€‚" }
            }
        };

        // State
        let currentLang = 'ko';

        // Elements
        const langSelector = document.getElementById('language-selector');
        const tabs = document.querySelectorAll('.tab-btn');
        const sections = {
            explanation: document.getElementById('explanation-section'),
            practice: document.getElementById('practice-section')
        };
        const appTitle = document.getElementById('app-title');

        // Functions
        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                // Clean text for TTS (remove arrows, explanations in parens)
                const cleanText = text.replace(/â†’.*$/, '').replace(/\(.*\)/, '').trim();
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.lang = 'ko-KR';
                utterance.rate = 0.9;
                window.speechSynthesis.speak(utterance);
            }
        }

        function renderContent() {
            const t = translations[currentLang];
            
            // App Title & Tabs
            appTitle.textContent = t.title;
            document.querySelector('#explanation-tab-btn .tab-text').textContent = t.tabExp;
            document.querySelector('#practice-tab-btn .tab-text').textContent = t.tabPrac;

            // Explanation Content
            document.getElementById('exp-title').textContent = t.expTitle;
            document.getElementById('exp-intro').textContent = t.expIntro;
            document.getElementById('exp-tip').textContent = t.expTip;
            document.getElementById('exp-adjective-title').textContent = t.titles.adj;
            document.getElementById('exp-verb-title').textContent = t.titles.verb;
            document.getElementById('exp-noun-title').textContent = t.titles.noun;
            document.getElementById('exp-tense-title').textContent = t.titles.tense;

            // --- FIXED LOGIC FOR UPDATING CARDS ---
            
            // Adjective Card
            const adjCard = document.querySelectorAll('.card')[0];
            updateRuleList(adjCard, [
                { label: t.rules.adj1, ex: t.rules.adj1_ex },
                { label: t.rules.adj2, ex: t.rules.adj2_ex },
                { label: t.rules.adj3, ex: t.rules.adj3_ex }
            ]);

            // Verb Card (Manual Update due to unique structure)
            const verbCard = document.querySelectorAll('.card')[1];
            const verbItem = verbCard.querySelector('li');
            if (verbItem) {
                // Header is the first child div
                const headerDiv = verbItem.children[0];
                if(headerDiv) {
                    const labelSpan = headerDiv.querySelector('span:first-child');
                    if(labelSpan) labelSpan.textContent = t.rules.verb1; // "Present (í˜„ì¬)"
                }

                // Example 1 is the second child div
                const ex1Div = verbItem.children[1];
                if(ex1Div) {
                    const exSpan = ex1Div.querySelector('span');
                    const btn = ex1Div.querySelector('button');
                    if(exSpan) exSpan.textContent = t.rules.verb1_ex1;
                    if(btn) btn.onclick = () => speak(t.rules.verb1_ex1.split('â†’')[1] || t.rules.verb1_ex1);
                }

                // Example 2 is the third child div
                const ex2Div = verbItem.children[2];
                if(ex2Div) {
                    const exSpan = ex2Div.querySelector('span');
                    const btn = ex2Div.querySelector('button');
                    if(exSpan) exSpan.textContent = t.rules.verb1_ex2;
                    if(btn) btn.onclick = () => speak(t.rules.verb1_ex2.split('â†’')[1] || t.rules.verb1_ex2);
                }
            }

            // Noun Card
            const nounCard = document.querySelectorAll('.card')[2];
            updateRuleList(nounCard, [
                { label: t.rules.noun1, ex: t.rules.noun1_ex }
            ]);

            // Tense Card
            const tenseCard = document.querySelectorAll('.card')[3];
            updateRuleList(tenseCard, [
                { label: t.rules.past, ex: t.rules.past_ex },
                { label: t.rules.future, ex: t.rules.future_ex }
            ]);

            // Quiz Section
            document.getElementById('quiz-title').textContent = t.quizTitle;
            document.getElementById('quiz-instruction').textContent = t.quizInst;
            renderQuiz();
        }

        function updateRuleList(card, data) {
            const listItems = card.querySelectorAll('li');
            data.forEach((d, i) => {
                const item = listItems[i];
                if(item) {
                    // Header Div is the first child
                    const headerDiv = item.children[0];
                    if(headerDiv) {
                        const labelSpan = headerDiv.querySelector('span:first-child');
                        if(labelSpan) labelSpan.textContent = d.label;
                    }
                    
                    // Example Div is the second child
                    const exDiv = item.children[1];
                    if(exDiv) {
                        const exSpan = exDiv.querySelector('span');
                        const btn = exDiv.querySelector('button');
                        
                        if(exSpan) exSpan.textContent = d.ex;
                        // Clean text for speech
                        const speakTextStr = d.ex.split('â†’')[1] || d.ex.split('(')[0];
                        if(btn) btn.onclick = () => speak(speakTextStr);
                    }
                }
            });
        }

        function renderQuiz() {
            const t = translations[currentLang];
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            t.quizzes.forEach((q, idx) => {
                const card = document.createElement('div');
                card.className = 'bg-white border border-gray-200 rounded-xl p-5 shadow-sm';
                card.innerHTML = `
                    <div class="mb-4">
                        <div class="text-xs font-bold text-indigo-500 mb-1">Situation</div>
                        <p class="text-gray-600 italic mb-3 bg-gray-50 p-2 rounded border-l-2 border-indigo-200">"${q.situation}"</p>
                        <p class="text-lg font-medium text-gray-800">${q.context}</p>
                    </div>
                    <div class="grid grid-cols-3 gap-2 options-container" id="q-${idx}">
                        ${q.options.map(opt => `
                            <button onclick="checkAnswer(${idx}, '${opt}', this)" class="quiz-option bg-white border-2 border-gray-200 text-gray-600 font-bold py-2 rounded-lg hover:border-indigo-300 hover:text-indigo-600 focus:outline-none">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                    <div class="mt-3 text-sm font-bold hidden feedback-msg"></div>
                `;
                container.appendChild(card);
            });
        }

        window.checkAnswer = function(qIdx, selected, btn) {
            const t = translations[currentLang];
            const q = t.quizzes[qIdx];
            const card = btn.closest('.bg-white');
            const feedback = card.querySelector('.feedback-msg');
            const allBtns = card.querySelectorAll('.quiz-option');

            // Reset buttons
            allBtns.forEach(b => {
                b.disabled = true;
                b.classList.remove('border-green-500', 'text-green-600', 'bg-green-50', 'border-red-500', 'text-red-600', 'bg-red-50');
                if (b.innerText.trim() === q.answer) {
                    b.classList.add('border-green-500', 'text-green-600', 'bg-green-50');
                }
            });

            feedback.classList.remove('hidden', 'text-green-600', 'text-red-600');
            
            if(selected === q.answer) {
                btn.classList.add('border-green-500', 'text-green-600', 'bg-green-50');
                feedback.textContent = t.feedback.correct;
                feedback.classList.add('text-green-600');
                speak(q.context.replace('____', selected));
            } else {
                btn.classList.add('border-red-500', 'text-red-600', 'bg-red-50');
                feedback.textContent = t.feedback.incorrect;
                feedback.classList.add('text-red-600');
            }
        };

        // Event Listeners
        langSelector.addEventListener('change', (e) => {
            currentLang = e.target.value;
            renderContent();
        });

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                const target = tab.dataset.tab;
                Object.values(sections).forEach(s => s.classList.add('hidden'));
                sections[target].classList.remove('hidden');
            });
        });

        // Initialize
        document.querySelector('[data-tab="explanation"]').classList.add('active');
        renderContent();

    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í•œêµ­ì–´ ë¬¸ë²• í•™ìŠµ: ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Nunito:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f9ff; /* Sky-50 feel */
            color: #334155;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Hide Scrollbar but keep functionality */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .slide {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .slide.active {
            display: flex; /* Changed to flex for vertical centering content if needed */
            flex-direction: column;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-content {
            flex: 1;
            overflow-y: auto;
            /* Smooth scrolling for touch devices */
            -webkit-overflow-scrolling: touch; 
        }

        /* Input styling focus transition */
        input:focus, textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Speaker Icon Animation */
        .speak-btn:active {
            transform: scale(0.9);
            color: #2563eb;
        }
    </style>
</head>
<body class="flex flex-col h-[100dvh] overflow-hidden">

    <!-- Top Bar -->
    <header class="bg-white shadow-sm z-10 px-4 py-3 flex justify-between items-center shrink-0">
        <div class="flex items-center gap-2 overflow-hidden">
            <div class="bg-blue-100 text-blue-600 p-2 rounded-lg">
                <i class="fas fa-book-open"></i>
            </div>
            <h1 class="text-lg md:text-xl font-bold text-slate-800 truncate" data-translate-key="main_title">ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤</h1>
        </div>
        
        <div class="flex items-center gap-2">
            <!-- Language Selector (Compact) -->
            <div class="relative">
                <select id="language-selector" class="appearance-none bg-slate-100 border-none text-slate-700 text-sm font-medium py-2 pl-3 pr-8 rounded-lg focus:ring-2 focus:ring-blue-500 cursor-pointer">
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="vi">ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500">
                    <i class="fas fa-chevron-down text-xs"></i>
                </div>
            </div>
            
            <!-- Save Button (Icon only on mobile) -->
            <button id="save-btn" class="bg-emerald-500 hover:bg-emerald-600 text-white p-2 md:px-4 md:py-2 rounded-lg transition shadow-sm active:scale-95" title="Save Image">
                <i class="fas fa-download md:mr-2"></i>
                <span class="hidden md:inline font-bold text-sm" data-translate-key="save_image">ì €ì¥</span>
            </button>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="w-full bg-slate-200 h-1.5 shrink-0">
        <div id="progress-bar" class="bg-blue-500 h-1.5 transition-all duration-300" style="width: 20%"></div>
    </div>

    <!-- Main Slide Area -->
    <main id="slide-container" class="flex-1 bg-white relative overflow-hidden flex flex-col w-full max-w-5xl mx-auto md:my-6 md:rounded-2xl md:shadow-xl md:border md:border-slate-100">
        
        <!-- Slide 1: Explanation -->
        <div id="slide-1" class="slide active h-full p-6 md:p-10">
            <div class="slide-content space-y-6">
                <div class="text-center space-y-2 mb-8">
                    <span class="inline-block px-3 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-full mb-2">Grammar Point</span>
                    <h2 class="text-2xl md:text-3xl font-bold text-slate-800" data-translate-key="slide1_title">ë¬¸ë²• ì„¤ëª…</h2>
                    <p class="text-slate-500 text-sm md:text-base font-medium">Expression for Emphasis</p>
                </div>

                <div class="bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg shadow-sm">
                    <p class="text-lg md:text-xl text-slate-800 font-medium leading-relaxed" data-translate-key="slide1_exp1">
                        ì–´ë–¤ ê²ƒì„ <span class="text-amber-600 font-bold">ì•„ì£¼ ì•„ì£¼ ë§ì´</span> ê°•ì¡°í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•´ìš”.
                    </p>
                    <p class="text-slate-600 mt-2 text-sm md:text-base" data-translate-key="slide1_exp2">
                        ë†€ë¼ì›€, ê°ë™, ë˜ëŠ” í˜ë“¦ì„ í‘œí˜„í•  ë•Œ ìì£¼ ì¨ìš”. (= ì •ë§ ~í•´ìš”)
                    </p>
                </div>

                <div class="space-y-4">
                    <h3 class="font-bold text-slate-700 flex items-center text-lg">
                        <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                        <span data-translate-key="example">ì˜ˆì‹œ</span>
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="bg-slate-50 p-4 rounded-xl border border-slate-100 flex items-start gap-3 hover:bg-white hover:shadow-md transition-all">
                            <button class="speak-btn text-slate-400 hover:text-blue-500 mt-1 shrink-0" onclick="speakText(this.nextElementSibling.innerText)">
                                <i class="fas fa-volume-high text-lg"></i>
                            </button>
                            <p class="text-slate-700 text-base md:text-lg leading-snug">
                                ìš”ê°€ê°€ ìì„¸ êµì •ì— <span class="font-bold text-blue-600">ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ëª°ë¼ìš”</span>.
                            </p>
                        </div>
                        <div class="bg-slate-50 p-4 rounded-xl border border-slate-100 flex items-start gap-3 hover:bg-white hover:shadow-md transition-all">
                            <button class="speak-btn text-slate-400 hover:text-blue-500 mt-1 shrink-0" onclick="speakText(this.nextElementSibling.innerText)">
                                <i class="fas fa-volume-high text-lg"></i>
                            </button>
                            <p class="text-slate-700 text-base md:text-lg leading-snug">
                                ì–´ì œ ì´ì‚¬í•´ì„œ ëª¸ì´ <span class="font-bold text-blue-600">ì–¼ë§ˆë‚˜ í”¼ê³¤í•œì§€ ëª°ë¼ìš”</span>.
                            </p>
                        </div>
                        <div class="bg-slate-50 p-4 rounded-xl border border-slate-100 flex items-start gap-3 hover:bg-white hover:shadow-md transition-all">
                            <button class="speak-btn text-slate-400 hover:text-blue-500 mt-1 shrink-0" onclick="speakText(this.nextElementSibling.innerText)">
                                <i class="fas fa-volume-high text-lg"></i>
                            </button>
                            <p class="text-slate-700 text-base md:text-lg leading-snug">
                                ê¹€ì¹˜ê°€ ìš°ë¦¬ ëª¸ì— <span class="font-bold text-blue-600">ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ëª°ë¼ìš”</span>.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 2: Rules (Forms) -->
        <div id="slide-2" class="slide h-full p-6 md:p-10">
            <div class="slide-content space-y-6">
                <div class="text-center mb-4">
                    <h2 class="text-2xl font-bold text-slate-800" data-translate-key="slide2_title">í˜•íƒœ (Form)</h2>
                    <p class="text-slate-500 text-sm mt-1">Conjugation Rules</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Adjective Card -->
                    <div class="bg-pink-50 rounded-xl p-5 border border-pink-100 shadow-sm">
                        <div class="flex items-center gap-2 mb-3 text-pink-700 font-bold text-lg">
                            <i class="fas fa-star"></i>
                            <span data-translate-key="adjective">í˜•ìš©ì‚¬ (A)</span>
                        </div>
                        <ul class="space-y-3 text-sm md:text-base">
                            <li class="bg-white p-3 rounded-lg shadow-sm">
                                <span class="block text-xs text-slate-400 mb-1">ë°›ì¹¨ X / ã„¹ ë°›ì¹¨</span>
                                <span class="font-bold text-pink-600">-ã„´ì§€ ëª¨ë¥´ë‹¤</span>
                                <div class="text-slate-600 mt-1 text-xs">ì˜ˆì˜ë‹¤ â†’ ì˜ˆìœì§€</div>
                            </li>
                            <li class="bg-white p-3 rounded-lg shadow-sm">
                                <span class="block text-xs text-slate-400 mb-1">ë°›ì¹¨ O</span>
                                <span class="font-bold text-pink-600">-ì€ì§€ ëª¨ë¥´ë‹¤</span>
                                <div class="text-slate-600 mt-1 text-xs">ì¢‹ë‹¤ â†’ ì¢‹ì€ì§€</div>
                            </li>
                        </ul>
                    </div>

                    <!-- Verb Card -->
                    <div class="bg-blue-50 rounded-xl p-5 border border-blue-100 shadow-sm">
                        <div class="flex items-center gap-2 mb-3 text-blue-700 font-bold text-lg">
                            <i class="fas fa-running"></i>
                            <span data-translate-key="verb">ë™ì‚¬ (V)</span>
                        </div>
                        <ul class="space-y-3 text-sm md:text-base">
                            <li class="bg-white p-3 rounded-lg shadow-sm">
                                <span class="block text-xs text-slate-400 mb-1">í•­ìƒ (Always)</span>
                                <span class="font-bold text-blue-600">-ëŠ”ì§€ ëª¨ë¥´ë‹¤</span>
                                <div class="text-slate-600 mt-1 text-xs">ë¨¹ë‹¤ â†’ ë¨¹ëŠ”ì§€</div>
                                <div class="text-slate-600 text-xs">ê°€ë‹¤ â†’ ê°€ëŠ”ì§€</div>
                            </li>
                        </ul>
                    </div>

                    <!-- Past Tense Card -->
                    <div class="bg-purple-50 rounded-xl p-5 border border-purple-100 shadow-sm">
                        <div class="flex items-center gap-2 mb-3 text-purple-700 font-bold text-lg">
                            <i class="fas fa-history"></i>
                            <span data-translate-key="past_tense">ê³¼ê±° (Past)</span>
                        </div>
                        <ul class="space-y-3 text-sm md:text-base">
                            <li class="bg-white p-3 rounded-lg shadow-sm">
                                <span class="block text-xs text-slate-400 mb-1">A / V</span>
                                <span class="font-bold text-purple-600">-ì•˜/ì—ˆëŠ”ì§€ ëª¨ë¥´ë‹¤</span>
                                <div class="text-slate-600 mt-1 text-xs">í˜ë“¤ë‹¤ â†’ í˜ë“¤ì—ˆëŠ”ì§€</div>
                                <div class="text-slate-600 text-xs">ê³µë¶€í•˜ë‹¤ â†’ ê³µë¶€í–ˆëŠ”ì§€</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Activity 1 -->
        <div id="slide-3" class="slide h-full p-6 md:p-10">
            <div class="slide-content space-y-6">
                <div class="flex items-center gap-3 mb-2">
                    <span class="bg-teal-100 text-teal-700 px-3 py-1 rounded-full text-xs font-bold uppercase">Activity 1</span>
                    <h2 class="text-xl md:text-2xl font-bold text-slate-800" data-translate-key="activity1_title">ë¬¸ì¥ ì™„ì„±í•˜ê¸°</h2>
                </div>
                <p class="text-slate-500 text-sm" data-translate-key="activity1_desc">ê´„í˜¸ ì•ˆì˜ ë‹¨ì–´ë¥¼ ì•Œë§ê²Œ ë°”ê¿”ë³´ì„¸ìš”.</p>

                <div class="space-y-4">
                    <!-- Q1 (Solved) -->
                    <div class="bg-slate-50 p-4 rounded-xl border border-slate-100 opacity-70">
                        <p class="text-sm text-slate-500 mb-1">ë³´ê¸° (Example)</p>
                        <p class="text-slate-800">
                            ì´ ì¼€ì´í¬ê°€ <span class="font-mono text-teal-600 font-bold">(ë§›ìˆë‹¤)</span>.
                        </p>
                        <p class="text-teal-600 font-bold mt-2">â†’ ì´ ì¼€ì´í¬ê°€ <span class="underline">ì–¼ë§ˆë‚˜ ë§›ìˆëŠ”ì§€ ëª°ë¼ìš”</span>.</p>
                    </div>

                    <!-- Q3 (Input) -->
                    <div class="bg-white p-4 rounded-xl border-2 border-slate-100 focus-within:border-teal-400 transition-colors shadow-sm">
                        <div class="mb-2 text-slate-800 font-medium">
                            1. í•œêµ­ì–´ ê³µë¶€ê°€ <span class="font-mono text-teal-600 font-bold">(ì–´ë µë‹¤)</span>.
                        </div>
                        <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                            <span class="text-slate-400 text-lg">â†’</span>
                            <input type="text" class="flex-1 bg-slate-50 border-none rounded-lg p-3 text-slate-800 placeholder-slate-400 focus:ring-2 focus:ring-teal-200" data-translate-key-placeholder="placeholder_type">
                        </div>
                    </div>

                    <!-- Q4 (Input) -->
                    <div class="bg-white p-4 rounded-xl border-2 border-slate-100 focus-within:border-teal-400 transition-colors shadow-sm">
                        <div class="mb-2 text-slate-800 font-medium">
                            2. ì¹œêµ¬ê°€ ì„ ë¬¼ì„ ë°›ê³  <span class="font-mono text-teal-600 font-bold">(ì¢‹ì•„í•˜ë‹¤)</span>.
                        </div>
                        <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-2">
                            <span class="text-slate-400 text-lg">â†’</span>
                            <input type="text" class="flex-1 bg-slate-50 border-none rounded-lg p-3 text-slate-800 placeholder-slate-400 focus:ring-2 focus:ring-teal-200" data-translate-key-placeholder="placeholder_type">
                        </div>
                    </div>
                </div>

                <div class="pt-4">
                    <button id="show-answers-btn-1" class="w-full md:w-auto bg-teal-100 hover:bg-teal-200 text-teal-800 font-bold py-3 px-6 rounded-xl transition flex items-center justify-center gap-2">
                        <i class="fas fa-eye"></i>
                        <span data-translate-key="show_answer">ì •ë‹µ ë³´ê¸°</span>
                    </button>
                    
                    <div id="activity1-answers" class="hidden mt-4 p-4 bg-teal-50 border border-teal-200 rounded-xl space-y-2 animate-fade-in-down">
                        <p class="font-bold text-teal-800 mb-2 flex items-center">
                            <i class="fas fa-check-circle mr-2"></i> <span data-translate-key="answer">ì •ë‹µ</span>
                        </p>
                        <div class="flex items-center justify-between bg-white p-2 rounded-lg border border-teal-100">
                            <span class="text-slate-700">1. í•œêµ­ì–´ ê³µë¶€ê°€ <span class="font-bold text-teal-600">ì–¼ë§ˆë‚˜ ì–´ë ¤ìš´ì§€ ëª°ë¼ìš”</span>.</span>
                            <button class="speak-btn text-slate-400 hover:text-teal-600 p-1" onclick="speakText('í•œêµ­ì–´ ê³µë¶€ê°€ ì–¼ë§ˆë‚˜ ì–´ë ¤ìš´ì§€ ëª°ë¼ìš”')"><i class="fas fa-volume-high"></i></button>
                        </div>
                        <div class="flex items-center justify-between bg-white p-2 rounded-lg border border-teal-100">
                            <span class="text-slate-700">2. ì¹œêµ¬ê°€ ì„ ë¬¼ì„ ë°›ê³  <span class="font-bold text-teal-600">ì–¼ë§ˆë‚˜ ì¢‹ì•„í•˜ëŠ”ì§€ ëª°ë¼ìš”</span>.</span>
                            <button class="speak-btn text-slate-400 hover:text-teal-600 p-1" onclick="speakText('ì¹œêµ¬ê°€ ì„ ë¬¼ì„ ë°›ê³  ì–¼ë§ˆë‚˜ ì¢‹ì•„í•˜ëŠ”ì§€ ëª°ë¼ìš”')"><i class="fas fa-volume-high"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: Activity 2 -->
        <div id="slide-4" class="slide h-full p-6 md:p-10">
            <div class="slide-content space-y-6">
                <div class="flex items-center gap-3">
                    <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold uppercase">Activity 2</span>
                    <h2 class="text-xl md:text-2xl font-bold text-slate-800" data-translate-key="activity2_title">ì¹œêµ¬ì—ê²Œ ì¶”ì²œí•˜ê¸°</h2>
                </div>
                
                <!-- Example Bubble -->
                <div class="bg-white border border-slate-200 p-5 rounded-2xl shadow-sm relative">
                    <div class="absolute -top-3 left-4 bg-indigo-500 text-white text-xs px-2 py-1 rounded">Example</div>
                    <div class="space-y-3">
                        <div class="flex gap-3">
                            <div class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold shrink-0">A</div>
                            <div class="bg-slate-100 p-3 rounded-r-xl rounded-bl-xl text-sm md:text-base text-slate-700">
                                <span data-translate-key="a2_q1">ìš”ì¦˜ ë¬´ìŠ¨ ë…¸ë˜ ë“¤ì–´ìš”?</span>
                                <button class="ml-2 text-slate-400 hover:text-indigo-500" onclick="speakText(this.previousElementSibling.innerText)"><i class="fas fa-volume-high text-xs"></i></button>
                            </div>
                        </div>
                        <div class="flex gap-3 flex-row-reverse">
                            <div class="w-8 h-8 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center text-xs font-bold shrink-0">B</div>
                            <div class="bg-indigo-50 p-3 rounded-l-xl rounded-br-xl text-sm md:text-base text-slate-800 shadow-sm border border-indigo-100">
                                <span data-translate-key="a2_a1">BTS ë…¸ë˜ë¥¼ ë“¤ì–´ìš”. ê·¸ ë…¸ë˜ê°€ ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ëª°ë¼ìš”.</span>
                                <button class="ml-2 text-indigo-300 hover:text-indigo-600" onclick="speakText(this.previousElementSibling.innerText)"><i class="fas fa-volume-high text-xs"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <p class="font-bold text-slate-700 mb-3" data-translate-key="try_it">ì£¼ì œë¥¼ ì„ íƒí•´ì„œ ì¨ë³´ì„¸ìš”!</p>
                    
                    <!-- Chips Container (Horizontal Scroll) -->
                    <div class="flex gap-2 overflow-x-auto pb-2 hide-scrollbar">
                        <button class="activity2-prompt-btn whitespace-nowrap bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-full text-sm font-medium hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition active:scale-95 shadow-sm" data-prompt="food">
                            ğŸ” <span data-translate-key="a2_p1">ìŒì‹ ì¶”ì²œ</span>
                        </button>
                        <button class="activity2-prompt-btn whitespace-nowrap bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-full text-sm font-medium hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition active:scale-95 shadow-sm" data-prompt="media">
                            ğŸ¬ <span data-translate-key="a2_p2">ì˜í™”/ë“œë¼ë§ˆ</span>
                        </button>
                        <button class="activity2-prompt-btn whitespace-nowrap bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-full text-sm font-medium hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition active:scale-95 shadow-sm" data-prompt="place">
                            âœˆï¸ <span data-translate-key="a2_p3">ì¥ì†Œ ì¶”ì²œ</span>
                        </button>
                    </div>

                    <textarea id="activity2-input" rows="4" class="w-full mt-2 p-4 bg-white border-2 border-slate-200 rounded-xl focus:border-indigo-400 resize-none text-slate-800 text-base" data-translate-key-placeholder="placeholder_type_long"></textarea>
                </div>
            </div>
        </div>

        <!-- Slide 5: Activity 3 -->
        <div id="slide-5" class="slide h-full p-6 md:p-10">
            <div class="slide-content space-y-6">
                <div class="flex items-center gap-3">
                    <span class="bg-rose-100 text-rose-700 px-3 py-1 rounded-full text-xs font-bold uppercase">Final Activity</span>
                    <h2 class="text-xl md:text-2xl font-bold text-slate-800" data-translate-key="activity3_title">ë‚˜ì˜ ê²½í—˜ ì´ì•¼ê¸°í•˜ê¸°</h2>
                </div>
                
                <p class="text-slate-600 leading-relaxed" data-translate-key="activity3_desc">
                    ìµœê·¼ì— ì•„ì£¼ ë†€ëê±°ë‚˜, ì¢‹ì•˜ê±°ë‚˜, í˜ë“¤ì—ˆë˜ ê²½í—˜ì„ ì ì–´ë³´ì„¸ìš”.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-xl border border-rose-100 shadow-sm">
                        <p class="text-xs font-bold text-rose-400 uppercase mb-2">Example 1</p>
                        <div class="flex items-start gap-2">
                             <p class="text-sm text-slate-700" data-translate-key="a3_ex1">"ì§€ë‚œ ì£¼ë§ì— ì œì£¼ë„ì— ê°”ì–´ìš”. ë°”ë‹¤ê°€ <span class="font-bold text-rose-500">ì–¼ë§ˆë‚˜ ì•„ë¦„ë‹¤ì› ëŠ”ì§€ ëª°ë¼ìš”</span>."</p>
                             <button class="speak-btn text-slate-300 hover:text-rose-500" onclick="speakText(this.previousElementSibling.innerText)"><i class="fas fa-volume-high text-xs"></i></button>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-rose-100 shadow-sm">
                         <p class="text-xs font-bold text-rose-400 uppercase mb-2">Example 2</p>
                         <div class="flex items-start gap-2">
                            <p class="text-sm text-slate-700" data-translate-key="a3_ex2">"ì–´ì œ ì‹œí—˜ê³µë¶€ë¥¼ í–ˆì–´ìš”. <span class="font-bold text-rose-500">ì–¼ë§ˆë‚˜ í”¼ê³¤í–ˆëŠ”ì§€ ëª°ë¼ìš”</span>."</p>
                            <button class="speak-btn text-slate-300 hover:text-rose-500" onclick="speakText(this.previousElementSibling.innerText)"><i class="fas fa-volume-high text-xs"></i></button>
                        </div>
                    </div>
                </div>

                <div>
                    <div class="flex items-center justify-between mb-2">
                        <label class="font-bold text-slate-700" data-translate-key="your_turn">ì—¬ëŸ¬ë¶„ì˜ ì´ì•¼ê¸°ëŠ”?</label>
                    </div>
                    <textarea id="activity3-input" rows="5" class="w-full p-4 bg-white border-2 border-slate-200 rounded-xl focus:border-rose-400 resize-none text-slate-800" data-translate-key-placeholder="placeholder_type_exp"></textarea>
                    
                    <div class="mt-3 flex flex-wrap gap-2 text-xs text-slate-500">
                        <span class="bg-slate-100 px-2 py-1 rounded"># <span data-translate-key="a3_p1">ì˜í™”/ì±…</span></span>
                        <span class="bg-slate-100 px-2 py-1 rounded"># <span data-translate-key="a3_p2">ì—¬í–‰</span></span>
                        <span class="bg-slate-100 px-2 py-1 rounded"># <span data-translate-key="a3_p3">ë§›ìˆëŠ” ì‹ì‚¬</span></span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Navigation Footer -->
    <footer class="bg-white border-t border-slate-100 p-4 shrink-0 safe-area-bottom">
        <div class="max-w-5xl mx-auto flex justify-between items-center gap-4">
            <button id="prev-btn" class="flex-1 bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold py-3 px-4 rounded-xl transition duration-300 disabled:opacity-30 disabled:cursor-not-allowed flex items-center justify-center gap-2 active:scale-95">
                <i class="fas fa-chevron-left"></i>
                <span data-translate-key="prev_btn">ì´ì „</span>
            </button>
            
            <div class="text-slate-400 font-mono text-sm font-medium w-16 text-center">
                <span id="current-slide-num" class="text-slate-800 font-bold text-lg">1</span> / <span id="total-slide-num">5</span>
            </div>
            
            <button id="next-btn" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 disabled:opacity-30 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-blue-200 active:scale-95">
                <span data-translate-key="next_btn">ë‹¤ìŒ</span>
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-20 left-1/2 transform -translate-x-1/2 bg-slate-800/90 text-white px-4 py-2 rounded-full shadow-lg text-sm font-medium opacity-0 transition-opacity duration-300 pointer-events-none z-50">
        <i class="fas fa-check mr-2"></i> ì´ë¯¸ì§€ ì €ì¥ ì™„ë£Œ!
    </div>

    <script>
        // --- TRANSLATION DATA ---
        const translations = {
            ko: {
                main_title: "ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                save_image: "ì €ì¥",
                slide1_title: "ë¬¸ë²• ì„¤ëª…",
                slide1_exp1: "ì–´ë–¤ ê²ƒì„ ì•„ì£¼ ì•„ì£¼ ë§ì´ ê°•ì¡°í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•´ìš”.",
                slide1_exp2: "ë†€ë¼ì›€, ê°ë™, ë˜ëŠ” í˜ë“¦ì„ í‘œí˜„í•  ë•Œ ìì£¼ ì¨ìš”. (= ì •ë§ ~í•´ìš”)",
                example: "ì˜ˆì‹œ",
                slide2_title: "í˜•íƒœ (Form)",
                adjective: "í˜•ìš©ì‚¬ (A)",
                adj_rule1: "ë°›ì¹¨ X / ã„¹ ë°›ì¹¨: -ã„´ì§€ ëª¨ë¥´ë‹¤",
                adj_rule2: "ë°›ì¹¨ O: -ì€ì§€ ëª¨ë¥´ë‹¤",
                verb: "ë™ì‚¬ (V)",
                verb_rule1: "í•­ìƒ: -ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                past_tense: "ê³¼ê±° (Past)",
                past_rule1: "-ì•˜/ì—ˆëŠ”ì§€ ëª¨ë¥´ë‹¤",
                activity1_title: "ë¬¸ì¥ ì™„ì„±í•˜ê¸°",
                activity1_desc: "ê´„í˜¸ ì•ˆì˜ ë‹¨ì–´ë¥¼ ì•Œë§ê²Œ ë°”ê¿”ë³´ì„¸ìš”.",
                answer: "ì •ë‹µ",
                show_answer: "ì •ë‹µ ë³´ê¸°",
                placeholder_type: "ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”",
                activity2_title: "ì¹œêµ¬ì—ê²Œ ì¶”ì²œí•˜ê¸°",
                activity2_desc: "'ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤'ë¥¼ ì‚¬ìš©í•´ì„œ ì¹œêµ¬ì—ê²Œ ì¶”ì²œí•´ë³´ì„¸ìš”.",
                a2_q1: "ìš”ì¦˜ ë¬´ìŠ¨ ë…¸ë˜ ë“¤ì–´ìš”?",
                a2_a1: "BTS ë…¸ë˜ë¥¼ ë“¤ì–´ìš”. ê·¸ ë…¸ë˜ê°€ ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ëª°ë¼ìš”.",
                try_it: "ì£¼ì œë¥¼ ì„ íƒí•´ì„œ ì¨ë³´ì„¸ìš”!",
                a2_p1: "ìŒì‹ ì¶”ì²œ",
                a2_p2: "ì˜í™”/ë“œë¼ë§ˆ",
                a2_p3: "ì¥ì†Œ ì¶”ì²œ",
                placeholder_type_long: "ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì˜ˆë¬¸ì„ ë³´ê±°ë‚˜, ì§ì ‘ ì¨ë³´ì„¸ìš”.",
                activity3_title: "ë‚˜ì˜ ê²½í—˜ ì´ì•¼ê¸°í•˜ê¸°",
                activity3_desc: "ìµœê·¼ì— ì•„ì£¼ ë†€ëê±°ë‚˜, ì¢‹ì•˜ê±°ë‚˜, í˜ë“¤ì—ˆë˜ ê²½í—˜ì„ ì ì–´ë³´ì„¸ìš”.",
                a3_ex1: "\"ì§€ë‚œ ì£¼ë§ì— ì œì£¼ë„ì— ê°”ì–´ìš”. ë°”ë‹¤ê°€ ì–¼ë§ˆë‚˜ ì•„ë¦„ë‹¤ì› ëŠ”ì§€ ëª°ë¼ìš”.\"",
                a3_ex2: "\"ì–´ì œ ì‹œí—˜ê³µë¶€ë¥¼ í–ˆì–´ìš”. ì–¼ë§ˆë‚˜ í”¼ê³¤í–ˆëŠ”ì§€ ëª°ë¼ìš”.\"",
                your_turn: "ì—¬ëŸ¬ë¶„ì˜ ì´ì•¼ê¸°ëŠ”?",
                placeholder_type_exp: "ì—¬ëŸ¬ë¶„ì˜ ê²½í—˜ì„ ììœ ë¡­ê²Œ ì¨ë³´ì„¸ìš”.",
                a3_p1: "ì˜í™”/ì±…",
                a3_p2: "ì—¬í–‰",
                a3_p3: "ë§›ìˆëŠ” ì‹ì‚¬",
                prev_btn: "ì´ì „",
                next_btn: "ë‹¤ìŒ",
                toast_saved: "ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!"
            },
            vi: {
                main_title: "ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                save_image: "LÆ°u",
                slide1_title: "Giáº£i thÃ­ch ngá»¯ phÃ¡p",
                slide1_exp1: "Sá»­ dá»¥ng khi báº¡n muá»‘n nháº¥n máº¡nh Ä‘iá»u gÃ¬ Ä‘Ã³ ráº¥t ráº¥t nhiá»u.",
                slide1_exp2: "Thá»ƒ hiá»‡n sá»± ngáº¡c nhiÃªn, cáº£m Ä‘á»™ng hoáº·c váº¥t váº£. (= Thá»±c sá»± ~)",
                example: "VÃ­ dá»¥",
                slide2_title: "Dáº¡ng (Form)",
                adjective: "TÃ­nh tá»« (A)",
                adj_rule1: "KhÃ´ng patchim / 'ã„¹': -ã„´ì§€ ëª¨ë¥´ë‹¤",
                adj_rule2: "CÃ³ patchim: -ì€ì§€ ëª¨ë¥´ë‹¤",
                verb: "Äá»™ng tá»« (V)",
                verb_rule1: "LuÃ´n luÃ´n: -ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                past_tense: "QuÃ¡ khá»© (Past)",
                past_rule1: "-ì•˜/ì—ˆëŠ”ì§€ ëª¨ë¥´ë‹¤",
                activity1_title: "HoÃ n thÃ nh cÃ¢u",
                activity1_desc: "Chia tá»« trong ngoáº·c cho Ä‘Ãºng ngá»¯ phÃ¡p.",
                answer: "ÄÃ¡p Ã¡n",
                show_answer: "Xem Ä‘Ã¡p Ã¡n",
                placeholder_type: "Nháº­p cÃ¢u tráº£ lá»i",
                activity2_title: "Giá»›i thiá»‡u cho báº¡n bÃ¨",
                activity2_desc: "HÃ£y thá»­ giá»›i thiá»‡u Ä‘iá»u gÃ¬ Ä‘Ã³ cho báº¡n bÃ¨.",
                a2_q1: "Dáº¡o nÃ y báº¡n nghe nháº¡c gÃ¬?",
                a2_a1: "Nghe nháº¡c BTS. BÃ i hÃ¡t Ä‘Ã³ hay láº¯m luÃ´n.",
                try_it: "Chá»n chá»§ Ä‘á» vÃ  viáº¿t thá»­ nhÃ©!",
                a2_p1: "MÃ³n Äƒn",
                a2_p2: "Phim áº£nh",
                a2_p3: "Äá»‹a Ä‘iá»ƒm",
                placeholder_type_long: "Nháº¥n nÃºt trÃªn Ä‘á»ƒ xem máº«u hoáº·c tá»± viáº¿t.",
                activity3_title: "Ká»ƒ chuyá»‡n kinh nghiá»‡m",
                activity3_desc: "Viáº¿t vá» tráº£i nghiá»‡m ngáº¡c nhiÃªn, vui váº» hoáº·c váº¥t váº£ gáº§n Ä‘Ã¢y.",
                a3_ex1: "\"TÃ´i Ä‘Ã£ Ä‘i Jeju. Biá»ƒn Ä‘áº¹p khÃ´ng tÆ°á»Ÿng Ä‘Æ°á»£c.\"",
                a3_ex2: "\"HÃ´m qua há»c thi. Má»‡t khÃ´ng táº£ ná»•i.\"",
                your_turn: "CÃ¢u chuyá»‡n cá»§a báº¡n?",
                placeholder_type_exp: "HÃ£y viáº¿t tá»± do vá» tráº£i nghiá»‡m cá»§a báº¡n.",
                a3_p1: "Phim/SÃ¡ch",
                a3_p2: "Du lá»‹ch",
                a3_p3: "Bá»¯a Äƒn ngon",
                prev_btn: "TrÆ°á»›c",
                next_btn: "Tiáº¿p",
                toast_saved: "ÄÃ£ lÆ°u hÃ¬nh áº£nh!"
            },
            ja: {
                main_title: "ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                save_image: "ä¿å­˜",
                slide1_title: "æ–‡æ³•èª¬æ˜",
                slide1_exp1: "ä½•ã‹ã‚’éå¸¸ã«å¼·èª¿ã—ãŸã„ã¨ãã«ä½¿ã„ã¾ã™ã€‚",
                slide1_exp2: "é©šãã€æ„Ÿå‹•ã€å¤§å¤‰ã•ã‚’è¡¨ç¾ã™ã‚‹ã®ã«ã‚ˆãä½¿ã„ã¾ã™ã€‚ï¼ˆï¼æœ¬å½“ã«ã€œã§ã™ï¼‰",
                example: "ä¾‹æ–‡",
                slide2_title: "å½¢æ…‹ (Form)",
                adjective: "å½¢å®¹è© (A)",
                adj_rule1: "ãƒ‘ãƒƒãƒãƒ ç„¡ / ã„¹: -ã„´ì§€ ëª¨ë¥´ë‹¤",
                adj_rule2: "ãƒ‘ãƒƒãƒãƒ æœ‰: -ì€ì§€ ëª¨ë¥´ë‹¤",
                verb: "å‹•è© (V)",
                verb_rule1: "å¸¸ã«: -ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                past_tense: "éå» (Past)",
                past_rule1: "-ì•˜/ì—ˆëŠ”ì§€ ëª¨ë¥´ë‹¤",
                activity1_title: "æ–‡ç« å®Œæˆ",
                activity1_desc: "æ‹¬å¼§å†…ã®å˜èªã‚’æ­£ã—ãå¤‰ãˆã¦ã¿ã¦ãã ã•ã„ã€‚",
                answer: "æ­£è§£",
                show_answer: "æ­£è§£ã‚’è¦‹ã‚‹",
                placeholder_type: "ã“ã“ã«å…¥åŠ›",
                activity2_title: "å‹é”ã«å‹§ã‚ã‚‹",
                activity2_desc: "å‹é”ã«å¥½ããªã‚‚ã®ã‚’å‹§ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚",
                a2_q1: "æœ€è¿‘ã©ã‚“ãªæ­Œè´ã„ã¦ã‚‹ï¼Ÿ",
                a2_a1: "BTSã€‚ãã®æ­Œã€ã©ã‚Œã ã‘è‰¯ã„ã‹åˆ†ã‹ã‚‰ãªã„ã‚ˆã€‚",
                try_it: "ãƒˆãƒ”ãƒƒã‚¯ã‚’é¸ã‚“ã§æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†ï¼",
                a2_p1: "é£Ÿã¹ç‰©",
                a2_p2: "æ˜ ç”»/ãƒ‰ãƒ©ãƒ",
                a2_p3: "å ´æ‰€",
                placeholder_type_long: "ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã‹ã€ç›´æ¥æ›¸ã„ã¦ã¿ã¦ãã ã•ã„ã€‚",
                activity3_title: "çµŒé¨“ã‚’è©±ã™",
                activity3_desc: "æœ€è¿‘ã®é©šã„ãŸã“ã¨ã€è‰¯ã‹ã£ãŸã“ã¨ã€å¤§å¤‰ã ã£ãŸã“ã¨ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚",
                a3_ex1: "ã€Œæ¸ˆå·å³¶ã«è¡Œãã¾ã—ãŸã€‚æµ·ãŒã©ã‚Œã»ã©ç¾ã—ã‹ã£ãŸã‹åˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚ã€",
                a3_ex2: "ã€Œæ˜¨æ—¥è©¦é¨“å‹‰å¼·ã‚’ã—ã¾ã—ãŸã€‚ã©ã‚Œã»ã©ç–²ã‚ŒãŸã‹åˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚ã€",
                your_turn: "ã‚ãªãŸã®è©±ã¯ï¼Ÿ",
                placeholder_type_exp: "è‡ªç”±ã«çµŒé¨“ã‚’æ›¸ã„ã¦ã¿ã¦ãã ã•ã„ã€‚",
                a3_p1: "æ˜ ç”»/æœ¬",
                a3_p2: "æ—…è¡Œ",
                a3_p3: "ç¾å‘³ã—ã„é£Ÿäº‹",
                prev_btn: "å‰ã¸",
                next_btn: "æ¬¡ã¸",
                toast_saved: "ç”»åƒã‚’ä¿å­˜ã—ã¾ã—ãŸï¼"
            },
            zh: {
                main_title: "ì–¼ë§ˆë‚˜ -(ìœ¼)ã„´/ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                save_image: "ä¿å­˜",
                slide1_title: "è¯­æ³•è¯´æ˜",
                slide1_exp1: "æƒ³éå¸¸å¼ºè°ƒæŸäº‹æ—¶ä½¿ç”¨ã€‚",
                slide1_exp2: "å¸¸ç”¨äºè¡¨è¾¾æƒŠè®¶ã€æ„ŸåŠ¨æˆ–è¾›è‹¦ã€‚ï¼ˆ= çœŸçš„~ï¼‰",
                example: "ä¾‹å­",
                slide2_title: "å½¢æ€ (Form)",
                adjective: "å½¢å®¹è¯ (A)",
                adj_rule1: "æ— æ”¶éŸ³ / ã„¹æ”¶éŸ³: -ã„´ì§€ ëª¨ë¥´ë‹¤",
                adj_rule2: "æœ‰æ”¶éŸ³: -ì€ì§€ ëª¨ë¥´ë‹¤",
                verb: "åŠ¨è¯ (V)",
                verb_rule1: "æ€»æ˜¯: -ëŠ”ì§€ ëª¨ë¥´ë‹¤",
                past_tense: "è¿‡å» (Past)",
                past_rule1: "-ì•˜/ì—ˆëŠ”ì§€ ëª¨ë¥´ë‹¤",
                activity1_title: "å®Œæˆå¥å­",
                activity1_desc: "è¯·æ­£ç¡®å˜æ¢æ‹¬å·ä¸­çš„å•è¯ã€‚",
                answer: "ç­”æ¡ˆ",
                show_answer: "æŸ¥çœ‹ç­”æ¡ˆ",
                placeholder_type: "è¯·è¾“å…¥",
                activity2_title: "å‘æœ‹å‹æ¨è",
                activity2_desc: "è¯•ç€å‘æœ‹å‹æ¨èä½ å–œæ¬¢çš„ä¸œè¥¿å§ã€‚",
                a2_q1: "æœ€è¿‘å¬ä»€ä¹ˆæ­Œï¼Ÿ",
                a2_a1: "å¬BTSçš„æ­Œã€‚ä½ ä¸çŸ¥é“é‚£é¦–æ­Œæœ‰å¤šå¥½å¬ã€‚",
                try_it: "é€‰æ‹©ä¸»é¢˜å†™å†™çœ‹å§ï¼",
                a2_p1: "ç¾é£Ÿæ¨è",
                a2_p2: "ç”µå½±/ç”µè§†å‰§",
                a2_p3: "åœºæ‰€æ¨è",
                placeholder_type_long: "ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹ä¾‹å¥æˆ–ç›´æ¥è¾“å…¥ã€‚",
                activity3_title: "è®²è¿°ç»å†",
                activity3_desc: "è¯·å†™ä¸‹æœ€è¿‘è®©ä½ æƒŠè®¶ã€å¼€å¿ƒæˆ–è¾›è‹¦çš„ç»å†ã€‚",
                a3_ex1: "â€œå»äº†æµå·å²›ã€‚ä½ ä¸çŸ¥é“å¤§æµ·æœ‰å¤šç¾ã€‚â€",
                a3_ex2: "â€œæ˜¨å¤©ä¸ºäº†è€ƒè¯•å­¦ä¹ äº†ã€‚ä½ ä¸çŸ¥é“æˆ‘æœ‰å¤šç´¯ã€‚â€",
                your_turn: "ä½ çš„æ•…äº‹æ˜¯ï¼Ÿ",
                placeholder_type_exp: "è¯·è‡ªç”±å†™ä¸‹ä½ çš„ç»å†ã€‚",
                a3_p1: "ç”µå½±/ä¹¦",
                a3_p2: "æ—…è¡Œ",
                a3_p3: "ç¾é£Ÿ",
                prev_btn: "ä¸Šä¸€é¡µ",
                next_btn: "ä¸‹ä¸€é¡µ",
                toast_saved: "å›¾ç‰‡å·²ä¿å­˜ï¼"
            }
        };


        // --- SCRIPT LOGIC ---
        let currentSlide = 1;
        const totalSlides = 5;
        const slides = document.querySelectorAll('.slide');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentSlideNum = document.getElementById('current-slide-num');
        const totalSlideNum = document.getElementById('total-slide-num');
        const progressBar = document.getElementById('progress-bar');
        const langSelector = document.getElementById('language-selector');
        const saveBtn = document.getElementById('save-btn');
        const toast = document.getElementById('toast');

        function updateSlideView() {
            slides.forEach((slide, index) => {
                if ((index + 1) === currentSlide) {
                    slide.classList.add('active');
                    // Scroll to top of slide content when changing slides
                    const content = slide.querySelector('.slide-content');
                    if(content) content.scrollTop = 0;
                } else {
                    slide.classList.remove('active');
                }
            });
            
            // Update Numbers
            currentSlideNum.textContent = currentSlide;
            totalSlideNum.textContent = totalSlides;
            
            // Update Progress Bar
            const progress = (currentSlide / totalSlides) * 100;
            progressBar.style.width = `${progress}%`;

            // Button States
            prevBtn.disabled = currentSlide === 1;
            nextBtn.disabled = currentSlide === totalSlides;
            
            // Button Styles (Optional: visually dim)
            prevBtn.style.opacity = currentSlide === 1 ? '0.3' : '1';
            nextBtn.style.opacity = currentSlide === totalSlides ? '0.3' : '1';
        }
        
        function speakText(text) {
            // Remove any potential HTML tags or extra spaces for cleaner TTS
            const cleanText = text.replace(/"/g, '').trim();
            
            if ('speechSynthesis' in window) {
                // Cancel current speech if any
                window.speechSynthesis.cancel();

                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.lang = 'ko-KR';
                utterance.rate = 0.9; // Slightly slower for learners
                
                // Try to find a Korean voice
                const voices = window.speechSynthesis.getVoices();
                const korVoice = voices.find(v => v.lang.includes('ko'));
                if (korVoice) utterance.voice = korVoice;

                window.speechSynthesis.speak(utterance);
            } else {
                alert("TTS not supported in this browser");
            }
        }

        function changeLanguage(lang) {
            const langData = translations[lang];
            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                if (langData[key]) {
                    el.innerText = langData[key];
                }
            });
            document.querySelectorAll('[data-translate-key-placeholder]').forEach(el => {
                const key = el.dataset.translateKeyPlaceholder;
                if (langData[key]) {
                    el.placeholder = langData[key];
                }
            });
        }
        
        function showToast(message) {
            toast.innerHTML = `<i class="fas fa-check mr-2"></i> ${message}`;
            toast.classList.remove('opacity-0');
            toast.classList.add('opacity-100', 'translate-y-0');
            setTimeout(() => {
                toast.classList.remove('opacity-100', 'translate-y-0');
                toast.classList.add('opacity-0');
            }, 2000);
        }

        // --- Event Listeners ---
        nextBtn.addEventListener('click', () => {
            if (currentSlide < totalSlides) {
                currentSlide++;
                updateSlideView();
            }
        });

        prevBtn.addEventListener('click', () => {
            if (currentSlide > 1) {
                currentSlide--;
                updateSlideView();
            }
        });

        langSelector.addEventListener('change', (e) => {
            const selectedLang = e.target.value;
            changeLanguage(selectedLang);
        });

        saveBtn.addEventListener('click', () => {
            const slideContainer = document.getElementById('slide-container');
            
            // Temporarily remove overflow hidden for full capture if content is long
            const originalOverflow = slideContainer.style.overflow;
            slideContainer.style.overflow = 'visible';

            html2canvas(slideContainer, {
                 scale: 2, 
                 backgroundColor: '#ffffff',
                 useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `korean-grammar-slide-${currentSlide}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Restore styling
                slideContainer.style.overflow = originalOverflow;
                
                const lang = langSelector.value;
                showToast(translations[lang].toast_saved);
            }).catch(err => {
                console.error("Capture failed:", err);
                slideContainer.style.overflow = originalOverflow;
            });
        });
        
        // Activity 1: Show Answers
        const showAnswersBtn1 = document.getElementById('show-answers-btn-1');
        const activity1Answers = document.getElementById('activity1-answers');
        if(showAnswersBtn1) {
            showAnswersBtn1.addEventListener('click', () => {
                activity1Answers.classList.remove('hidden');
                // Scroll to answers on mobile
                setTimeout(() => {
                    activity1Answers.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            });
        }
        
        // Activity 2: Prompt Buttons
        const activity2PromptBtns = document.querySelectorAll('.activity2-prompt-btn');
        const activity2Input = document.getElementById('activity2-input');
        if(activity2PromptBtns.length > 0) {
            const promptTemplates = {
                food: "ì œê°€ ì œì¼ ì¢‹ì•„í•˜ëŠ” ìŒì‹ì€ ë¹„ë¹”ë°¥ì´ì—ìš”. ê·¸ ìŒì‹ì´ ì–¼ë§ˆë‚˜ ë§›ìˆëŠ”ì§€ ëª°ë¼ìš”.",
                media: "ì €ëŠ” ìš”ì¦˜ 'ì˜¤ì§•ì–´ ê²Œì„'ì„ ë´ìš”. ê·¸ ë“œë¼ë§ˆê°€ ì–¼ë§ˆë‚˜ ì¬ë¯¸ìˆëŠ”ì§€ ëª°ë¼ìš”.",
                place: "ì €ëŠ” í•œê°• ê³µì›ì— ìì£¼ ê°€ìš”. ê·¸ê³³ì´ ì–¼ë§ˆë‚˜ ì•„ë¦„ë‹¤ìš´ì§€ ëª°ë¼ìš”."
            };
            activity2PromptBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const promptType = btn.dataset.prompt;
                    if (promptTemplates[promptType]) {
                        activity2Input.value = promptTemplates[promptType];
                        activity2Input.focus();
                        // Brief highlight effect
                        activity2Input.classList.add('ring-2', 'ring-indigo-300');
                        setTimeout(() => activity2Input.classList.remove('ring-2', 'ring-indigo-300'), 500);
                    }
                });
            });
        }

        // Initialize TTS voices
        window.speechSynthesis.onvoiceschanged = () => {
             // Pre-load voices
             window.speechSynthesis.getVoices();
        };

        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            updateSlideView();
            changeLanguage(langSelector.value);
        });

    </script>
</body>
</html>

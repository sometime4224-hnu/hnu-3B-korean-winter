<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì–´ ì–´íœ˜ í€´ì¦ˆ (ìƒˆ ë²„ì „)</title>
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì ìš© (Noto Sans KRë¡œ ë³€ê²½í•˜ì—¬ í•œêµ­ì–´ ê°€ë…ì„± í–¥ìƒ) */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
        }
        /* í™”ë©´ ì „í™˜ì„ ìœ„í•œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .screen {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  í™”ë©´ ìˆ¨ê¹€ */
        }
        .screen.active {
            display: block; /* active í´ë˜ìŠ¤ê°€ ìˆëŠ” í™”ë©´ë§Œ í‘œì‹œ */
        }
        /* ì»¤ìŠ¤í…€ ë¼ë””ì˜¤ ë²„íŠ¼/ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .option-label {
            transition: all 0.2s ease-in-out;
        }
        .option-input:checked + .option-label {
            background-color: #3b82f6; /* bg-blue-500 */
            color: white;
            border-color: #3b82f6; /* border-blue-500 */
        }
        .option-input:disabled + .option-label {
            background-color: #f3f4f6; /* bg-gray-100 */
            color: #9ca3af; /* text-gray-400 */
            cursor: not-allowed;
        }
        /* ì •ë‹µ/ì˜¤ë‹µ í”¼ë“œë°± ìŠ¤íƒ€ì¼ */
        .feedback-correct {
            background-color: #d1fae5; /* bg-green-100 */
            border-left: 4px solid #10b981; /* border-green-500 */
        }
        .feedback-incorrect {
            background-color: #fee2e2; /* bg-red-100 */
            border-left: 4px solid #ef4444; /* border-red-500 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex items-center justify-center min-h-screen">

    <div class="container w-full max-w-2xl mx-auto p-4 md:p-8 bg-white shadow-2xl rounded-lg">

        <!-- 1. ë©”ì¸ í™”ë©´ -->
        <div id="main-screen" class="screen active text-center">
            <h1 class="text-3xl font-bold text-blue-600 mb-6">í•œêµ­ì–´ ì–´íœ˜ í€´ì¦ˆ</h1>
            <p class="text-lg text-gray-700 mb-8">ì´ë¯¸ì§€ ì†ì˜ ì–´íœ˜(ì—°ìŠµ 1~3)ë¥¼ ë³µìŠµí•´ ë´…ì‹œë‹¤.</p>
            <button id="start-quiz-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg text-xl transition duration-300 shadow-md">
                í€´ì¦ˆ ì‹œì‘í•˜ê¸°
            </button>
            <button id="show-history-btn" class="w-full mt-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg text-xl transition duration-300">
                í€´ì¦ˆ ê¸°ë¡ ë³´ê¸°
            </button>
            <div id="history-container" class="mt-6 text-left hidden">
                <h2 class="text-2xl font-semibold mb-4 text-center">í€´ì¦ˆ ê¸°ë¡</h2>
                <div id="history-list" class="space-y-3 max-h-64 overflow-y-auto">
                    <!-- ê¸°ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
                <button id="clear-history-btn" class="w-full mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    ê¸°ë¡ ëª¨ë‘ ì‚­ì œ
                </button>
            </div>
            <!-- ìƒì„¸ ê¸°ë¡ ëª¨ë‹¬ -->
            <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
                <div class="bg-white rounded-lg shadow-xl w-full max-w-xl max-h-[80vh] overflow-hidden">
                    <div class="flex justify-between items-center p-4 border-b">
                        <h3 class="text-xl font-bold">ìƒì„¸ ê¸°ë¡</h3>
                        <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
                    </div>
                    <div id="modal-content" class="p-6 overflow-y-auto max-h-[calc(80vh-120px)]">
                        <!-- ìƒì„¸ í”¼ë“œë°±ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                    <div class="p-4 border-t bg-gray-50 text-right">
                        <button id="close-modal-btn-bottom" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                            ë‹«ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. í€´ì¦ˆ í™”ë©´ -->
        <div id="quiz-screen" class="screen">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-lg font-semibold text-blue-600">ë¬¸ì œ <span id="question-number">1</span> / <span id="total-questions">25</span></span>
                    <!-- íŒíŠ¸ ë²„íŠ¼ê³¼ í…ìŠ¤íŠ¸ê°€ í‘œì‹œë  ì˜ì—­ -->
                    <div class="text-right">
                        <button id="hint-btn" class="text-sm font-medium bg-yellow-300 hover:bg-yellow-400 text-yellow-800 px-3 py-1 rounded-full transition duration-300 shadow-sm">
                            ğŸ’¡ íŒíŠ¸ ë³´ê¸°
                        </button>
                        <span id="hint-text" class="hidden text-sm font-semibold text-yellow-800 bg-yellow-100 px-3 py-1 rounded-full ml-2"></span>
                    </div>
                </div>
                <!-- ì§„í–‰ë¥  ë°” -->
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-500 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>

            <h2 id="question-text" class="text-xl md:text-2xl font-semibold text-gray-900 mb-6 min-h-[60px]"></h2>
            
            <!-- ì„ íƒì§€ ì˜ì—­ -->
            <div id="options-container" class="space-y-3">
                <!-- ì„ íƒì§€ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>

            <!-- O/X ì„ íƒì§€ ì˜ì—­ -->
            <div id="ox-options-container" class="flex space-x-4 mt-4">
                <!-- O/X ë²„íŠ¼ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>

            <button id="next-question-btn" class="w-full mt-8 bg-gray-300 text-gray-500 font-bold py-3 px-6 rounded-lg text-lg transition duration-300 cursor-not-allowed" disabled>
                ë‹¤ìŒ
            </button>
        </div>

        <!-- 3. ê²°ê³¼ í™”ë©´ -->
        <div id="results-screen" class="screen text-center">
            <h1 class="text-3xl font-bold text-blue-600 mb-4">í€´ì¦ˆ ì™„ë£Œ!</h1>
            <div class="bg-blue-50 p-6 rounded-lg shadow-inner mb-6">
                <h2 class="text-2xl font-semibold mb-2">ë‹¹ì‹ ì˜ ì ìˆ˜</h2>
                <p class="text-5xl font-bold text-blue-600"><span id="score">0</span> / <span id="total-score">25</span></p>
            </div>
            
            <div class="text-left mb-6">
                <h3 class="text-2xl font-semibold mb-4">ìƒì„¸ í”¼ë“œë°±</h3>
                <div id="feedback-container" class="space-y-4 max-h-80 overflow-y-auto p-4 bg-gray-50 rounded-lg border">
                    <!-- í”¼ë“œë°±ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <button id="save-results-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-300 shadow-md">
                ê²°ê³¼ ì €ì¥í•˜ê¸°
            </button>
            <button id="restart-quiz-btn" class="w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-300">
                ë‹¤ì‹œ í’€ê¸°
            </button>
        </div>

    </div>

    <script>
        // --- 1. í€´ì¦ˆ ë°ì´í„° ---
        // ì²¨ë¶€ëœ ì´ë¯¸ì§€ì˜ ì–´íœ˜(ì—°ìŠµ 1, 2, 3)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ 25ê°œì˜ ë¬¸ì œ
        const questions = [
            // ì—°ìŠµ 1 ì–´íœ˜ (6ê°œ)
            {
                vocab: 'ë§ˆìŒì´ í¸ì•ˆí•´ì§€ë‹¤',
                type: 'dialogue',
                question: 'A: ì£¼ë§ì— ë­ í–ˆì–´ìš”?\nB: ìŠ¤íŒŒì— ê°€ì„œ ë§ˆì‚¬ì§€ë¥¼ ë°›ì•˜ì–´ìš”. ìŠ¤íŠ¸ë ˆìŠ¤ê°€ í’€ë¦¬ê³  ________.',
                options: ['ë§ˆìŒì´ í¸ì•ˆí•´ì¡Œì–´ìš”', 'ê°€ìŠ´ì´ ë›°ì—ˆì–´ìš”', 'ì‹ ì´ ë‚¬ì–´ìš”', 'í˜ì´ ë‚¬ì–´ìš”'],
                answer: 'ë§ˆìŒì´ í¸ì•ˆí•´ì¡Œì–´ìš”'
            },
            {
                vocab: 'ì‹ ì´ ë‚˜ë‹¤',
                type: 'mc',
                question: 'ì†Œí’ ê°€ê¸° ì „ë‚  ë°¤, ë„ˆë¬´ ________ ì ì´ ì˜¤ì§€ ì•Šì•˜ë‹¤.',
                options: ['ì‹ ì´ ë‚˜ì„œ', 'ë§ˆìŒì— ì—¬ìœ ê°€ ìƒê²¨ì„œ', 'í˜ì´ ë‚˜ì„œ', 'ë§ˆìŒì´ í¸ì•ˆí•´ì ¸ì„œ'],
                answer: 'ì‹ ì´ ë‚˜ì„œ'
            },
            {
                vocab: 'ê°€ìŠ´ì´ ë›°ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ë¬´ì„œìš´ ì˜í™”ë¥¼ ë´¤ë”ë‹ˆ ê°€ìŠ´ì´ ë›°ê³  ê¸´ì¥ëë‹¤."',
                answer: 'o'
            },
            {
                vocab: 'ë§ˆìŒì— ì—¬ìœ ê°€ ìƒê¸°ë‹¤',
                type: 'dialogue',
                question: 'A: ìš”ì¦˜ ë°”ìœ ì¼ì´ ëë‚¬ë‚˜ ë´ìš”. í‘œì •ì´ ì¢‹ì•„ ë³´ì—¬ìš”.\nB: ë„¤, ì¼ì´ ì˜ ëë‚˜ì„œ ________.',
                options: ['ë§ˆìŒì— ì—¬ìœ ê°€ ìƒê²¼ì–´ìš”', 'ê°€ìŠ´ì´ ì„¤ë ˆìš”', 'í˜ì´ ë‚¬ì–´ìš”', 'ì‹ ì´ ë‚¬ì–´ìš”'],
                answer: 'ë§ˆìŒì— ì—¬ìœ ê°€ ìƒê²¼ì–´ìš”'
            },
            {
                vocab: 'í˜ì´ ë‚˜ë‹¤',
                type: 'mc',
                question: 'ì¹œêµ¬ë“¤ì˜ ì‘ì›ì„ ë“¤ìœ¼ë‹ˆ ì—†ë˜ ________.',
                options: ['í˜ì´ ë‚¬ì–´ìš”', 'ì‹ ì´ ë‚¬ì–´ìš”', 'ì—¬ìœ ê°€ ìƒê²¼ì–´ìš”', 'ê°€ìŠ´ì´ ë›°ì—ˆì–´ìš”'],
                answer: 'í˜ì´ ë‚¬ì–´ìš”'
            },
            {
                vocab: 'ê°€ìŠ´ì´ ì„¤ë ˆë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì˜¤ë«ë™ì•ˆ ê¸°ë‹¤ë ¸ë˜ ì—¬í–‰ì„ ë– ë‚˜ê²Œ ë˜ì–´ ê°€ìŠ´ì´ ì„¤ë ˆë‹¤."',
                answer: 'o'
            },
            // ì—°ìŠµ 2 ì–´íœ˜ (ëª¨ì–‘ 3ê°œ + ì§ˆê°/íŠ¹ì„± 8ê°œ = 11ê°œ)
            {
                vocab: 'ì„¸ëª¨',
                type: 'mc',
                question: 'íŠ¸ë¼ì´ì•µê¸€ì€ ì–´ë–¤ ëª¨ì–‘ì…ë‹ˆê¹Œ?',
                options: ['ì„¸ëª¨', 'ë„¤ëª¨', 'ë™ê·¸ë¼ë¯¸', 'ìš¸í‰ë¶ˆí‰í•˜ë‹¤'],
                answer: 'ì„¸ëª¨'
            },
            {
                vocab: 'ë„¤ëª¨',
                type: 'mc',
                question: 'ì±…ì´ë‚˜ ê³µì±…ì€ ë³´í†µ ì–´ë–¤ ëª¨ì–‘ì…ë‹ˆê¹Œ?',
                options: ['ë„¤ëª¨', 'ì„¸ëª¨', 'ë™ê·¸ë¼ë¯¸', 'ë¹½ë¹½í•˜ë‹¤'],
                answer: 'ë„¤ëª¨'
            },
            {
                vocab: 'ë™ê·¸ë¼ë¯¸',
                type: 'mc',
                question: 'ë©œë¡ ì´ë‚˜ ìˆ˜ë°•ì€ ë³´í†µ ì–´ë–¤ ëª¨ì–‘ì— ê°€ê¹ìŠµë‹ˆê¹Œ?',
                options: ['ë‘¥ê·¼ ëª¨ì–‘ (ë™ê·¸ë¼ë¯¸)', 'ì„¸ëª¨ ëª¨ì–‘', 'ë„¤ëª¨ ëª¨ì–‘', 'ë¾°ì¡±í•œ ëª¨ì–‘'],
                answer: 'ë‘¥ê·¼ ëª¨ì–‘ (ë™ê·¸ë¼ë¯¸)'
            },
            {
                vocab: 'í‰í‰í•˜ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ë°”ë‹¥ì´ í‰í‰í•´ì„œ ê±·ê¸° í¸í•˜ë‹¤."',
                answer: 'o'
            },
            {
                vocab: 'ê±°ì¹ ë‹¤',
                type: 'mc',
                question: 'ì‚¬í¬(sandpaper)ì˜ í‘œë©´ì€ ë§¤ìš° ________.',
                options: ['ê±°ì¹ ë‹¤', 'ë¶€ë“œëŸ½ë‹¤', 'ë§¤ë„ëŸ½ë‹¤', 'ë”±ë”±í•˜ë‹¤'],
                answer: 'ê±°ì¹ ë‹¤'
            },
            {
                vocab: 'ë¾°ì¡±í•˜ë‹¤',
                type: 'mc',
                question: 'ì—°í•„ì˜ ëì€ ________.',
                options: ['ë¾°ì¡±í•˜ë‹¤', 'í‰í‰í•˜ë‹¤', 'ìš¸í‰ë¶ˆí‰í•˜ë‹¤', 'ë¶€ë“œëŸ½ë‹¤'],
                answer: 'ë¾°ì¡±í•˜ë‹¤'
            },
            {
                vocab: 'ë¹½ë¹½í•˜ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì£¼ë§ì˜ ëª…ë™ ê±°ë¦¬ëŠ” ì‚¬ëŒë“¤ë¡œ ë¹½ë¹½í•˜ë‹¤."',
                answer: 'o'
            },
            {
                vocab: 'ë¶€ë“œëŸ½ë‹¤',
                type: 'dialogue',
                question: 'A: ì´ ì¼€ì´í¬ ì •ë§ ë§›ìˆë„¤ìš”!\nB: ë„¤, ë¹µì´ ì •ë§ ________.',
                options: ['ë¶€ë“œëŸ¬ì›Œìš”', 'ê±°ì¹ ì–´ìš”', 'ë”±ë”±í•´ìš”', 'ë§¤ë„ëŸ¬ì›Œìš”'],
                answer: 'ë¶€ë“œëŸ¬ì›Œìš”'
            },
            {
                vocab: 'ë”±ë”±í•˜ë‹¤',
                type: 'mc',
                question: 'ì•„ì´ìŠ¤í¬ë¦¼ì´ ê½ê½ ì–¼ì–´ì„œ ________.',
                options: ['ë”±ë”±í•˜ë‹¤', 'ë¶€ë“œëŸ½ë‹¤', 'ë¾°ì¡±í•˜ë‹¤', 'ìš¸í‰ë¶ˆí‰í•˜ë‹¤'],
                answer: 'ë”±ë”±í•˜ë‹¤'
            },
            {
                vocab: 'ìš¸í‰ë¶ˆí‰í•˜ë‹¤',
                type: 'mc',
                question: 'ë©œë¡ ì˜ ê»ì§ˆì€ ________.',
                options: ['ìš¸í‰ë¶ˆí‰í•˜ë‹¤', 'ë§¤ë„ëŸ½ë‹¤', 'í‰í‰í•˜ë‹¤', 'ë¶€ë“œëŸ½ë‹¤'],
                answer: 'ìš¸í‰ë¶ˆí‰í•˜ë‹¤'
            },
            {
                vocab: 'ë§¤ë„ëŸ½ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì˜¤ë˜ëœ ë‚˜ë¬´ì˜ ê²‰ì€ ë§¤ìš° ë§¤ë„ëŸ½ë‹¤."',
                hint: 'ë°˜ëŒ€ë§: ê±°ì¹ ë‹¤',
                answer: 'x'
            },
            // ì—°ìŠµ 3 ì–´íœ˜ (ì•…ê¸° 6ê°œ + ì—°ì£¼ë²•)
            {
                vocab: 'ë¶',
                type: 'mc',
                question: 'ë‘¥ê·¼ ëª¨ì–‘ì— ì±„ë¡œ ì³ì„œ \'ë‘¥ë‘¥\' ì†Œë¦¬ë¥¼ ë‚´ëŠ” ì•…ê¸°ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                options: ['ë¶', 'íƒ¬ë²„ë¦°', 'íŠ¸ë¼ì´ì•µê¸€', 'ê¸°íƒ€'],
                answer: 'ë¶'
            },
            {
                vocab: 'í•˜ëª¨ë‹ˆì¹´',
                type: 'mc',
                question: 'ì…ìœ¼ë¡œ ë¶ˆì–´ì„œ ì—°ì£¼í•˜ëŠ” ë„¤ëª¨ë‚œ ëª¨ì–‘ì˜ ì‘ì€ ì•…ê¸°ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                options: ['í•˜ëª¨ë‹ˆì¹´', 'ë¶', 'ê¸°íƒ€', 'í‚¤ë³´ë“œ'],
                answer: 'í•˜ëª¨ë‹ˆì¹´'
            },
            {
                vocab: 'ê¸°íƒ€',
                type: 'mc',
                question: 'ì†ìœ¼ë¡œ ì¤„ì„ ì³ì„œ ì—°ì£¼í•˜ëŠ” ì•…ê¸°ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                options: ['ê¸°íƒ€', 'í‚¤ë³´ë“œ', 'íŠ¸ë¼ì´ì•µê¸€', 'í•˜ëª¨ë‹ˆì¹´'],
                answer: 'ê¸°íƒ€'
            },
            {
                vocab: 'íƒ¬ë²„ë¦°',
                type: 'mc',
                question: 'ë‘¥ê·¼ ëª¨ì–‘ì´ë©° í”ë“¤ê±°ë‚˜ ì†ìœ¼ë¡œ ì³ì„œ ì—°ì£¼í•˜ëŠ” ì•…ê¸°ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                options: ['íƒ¬ë²„ë¦°', 'ë¶', 'ê¸°íƒ€', 'íŠ¸ë¼ì´ì•µê¸€'],
                answer: 'íƒ¬ë²„ë¦°'
            },
            {
                vocab: 'í‚¤ë³´ë“œ',
                type: 'mc',
                question: 'ê±´ë°˜ì„ ëˆŒëŸ¬ì„œ ì†Œë¦¬ë¥¼ ë‚´ëŠ” ì•…ê¸°ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                options: ['í‚¤ë³´ë“œ', 'ê¸°íƒ€', 'ë¶', 'í•˜ëª¨ë‹ˆì¹´'],
                answer: 'í‚¤ë³´ë“œ'
            },
            {
                vocab: 'íŠ¸ë¼ì´ì•µê¸€',
                type: 'mc',
                question: 'ì„¸ëª¨ ëª¨ì–‘ìœ¼ë¡œ ìƒê¸´ ì•…ê¸°ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                options: ['íŠ¸ë¼ì´ì•µê¸€', 'í•˜ëª¨ë‹ˆì¹´', 'ë¶', 'íƒ¬ë²„ë¦°'],
                answer: 'íŠ¸ë¼ì´ì•µê¸€'
            },
            {
                vocab: '[ì—°ì£¼ë²•]',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ê¸°íƒ€ëŠ” ì…ìœ¼ë¡œ ë¶ˆì–´ì„œ ì—°ì£¼í•œë‹¤."',
                hint: 'ê¸°íƒ€ëŠ” ì¤„ì„ ì¹©ë‹ˆë‹¤.',
                answer: 'x'
            },
            {
                vocab: '[ì—°ì£¼ë²•]',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "í‚¤ë³´ë“œëŠ” ê±´ë°˜ì„ ëˆŒëŸ¬ì„œ ì—°ì£¼í•œë‹¤."',
                answer: 'o'
            }
        ];


        // --- 2. ì „ì—­ ë³€ìˆ˜ ---
        const mainScreen = document.getElementById('main-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const screens = [mainScreen, quizScreen, resultsScreen];

        const startQuizBtn = document.getElementById('start-quiz-btn');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const restartQuizBtn = document.getElementById('restart-quiz-btn');
        const saveResultsBtn = document.getElementById('save-results-btn');
        const showHistoryBtn = document.getElementById('show-history-btn');
        const historyContainer = document.getElementById('history-container');
        const historyList = document.getElementById('history-list');
        const clearHistoryBtn = document.getElementById('clear-history-btn');

        const historyModal = document.getElementById('history-modal');
        const modalContent = document.getElementById('modal-content');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const closeModalBtnBottom = document.getElementById('close-modal-btn-bottom');

        const questionNumberEl = document.getElementById('question-number');
        const totalQuestionsEl = document.getElementById('total-questions');
        const hintBtn = document.getElementById('hint-btn');
        const hintTextEl = document.getElementById('hint-text');
        const progressBar = document.getElementById('progress-bar');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const oxOptionsContainer = document.getElementById('ox-options-container');

        const scoreEl = document.getElementById('score');
        const totalScoreEl = document.getElementById('total-score');
        const feedbackContainer = document.getElementById('feedback-container');

        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;
        let feedbackDetails = [];

        // --- 3. í™”ë©´ ì „í™˜ í•¨ìˆ˜ ---
        function showScreen(screenId) {
            screens.forEach(screen => {
                if (screen.id === screenId) {
                    screen.classList.add('active');
                } else {
                    screen.classList.remove('active');
                }
            });
        }

        // --- 4. í€´ì¦ˆ ë¡œì§ í•¨ìˆ˜ ---

        function startQuiz() {
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;
            feedbackDetails = [];
            // ì´ ë¬¸ì œ ìˆ˜ ë™ì  ì„¤ì •
            totalQuestionsEl.textContent = questions.length;
            totalScoreEl.textContent = questions.length;
            // ê²°ê³¼ ì €ì¥ ë²„íŠ¼ ì´ˆê¸°í™”
            saveResultsBtn.textContent = 'ê²°ê³¼ ì €ì¥í•˜ê¸°';
            saveResultsBtn.disabled = false;
            saveResultsBtn.classList.add('bg-green-500', 'hover:bg-green-600');
            saveResultsBtn.classList.remove('bg-gray-400');
            
            showScreen('quiz-screen');
            loadQuestion();
        }

        function loadQuestion() {
            // ì´ì „ ì„ íƒì§€ ì´ˆê¸°í™”
            optionsContainer.innerHTML = '';
            oxOptionsContainer.innerHTML = '';
            
            // ë‹¤ìŒ ë²„íŠ¼ ë¹„í™œì„±í™”
            disableNextButton();

            if (currentQuestionIndex >= questions.length) {
                showResults();
                return;
            }

            // íŒíŠ¸ ë²„íŠ¼ê³¼ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
            hintTextEl.classList.add('hidden'); // íŒíŠ¸ ìˆ¨ê¸°ê¸°
            hintTextEl.textContent = ''; // íŒíŠ¸ ë‚´ìš© ì§€ìš°ê¸°
            hintBtn.classList.remove('hidden'); // íŒíŠ¸ ë²„íŠ¼ ë³´ì´ê¸°

            const question = questions[currentQuestionIndex];
            
            // ì§ˆë¬¸ ì •ë³´ ì—…ë°ì´íŠ¸
            questionNumberEl.textContent = currentQuestionIndex + 1;
            questionTextEl.innerHTML = question.question.replace(/\n/g, '<br>'); // ì¤„ë°”ê¿ˆ ì²˜ë¦¬
            
            // íŒíŠ¸ ë‚´ìš© ì„¤ì •
            let hint = question.vocab; // ê¸°ë³¸ íŒíŠ¸ëŠ” ì–´íœ˜
            if (question.hint) { // 'hint' ì†ì„±ì´ ë”°ë¡œ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©
                hint = question.hint;
            }
            hintTextEl.textContent = hint; // íŒíŠ¸ í…ìŠ¤íŠ¸ ì„¤ì •

            // ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;

            // ë¬¸ì œ ìœ í˜•ì— ë”°ë¼ ì„ íƒì§€ ìƒì„±
            if (question.type === 'mc' || question.type === 'dialogue') {
                oxOptionsContainer.style.display = 'none';
                optionsContainer.style.display = 'block';
                
                // ì„ íƒì§€ ìˆœì„œ ì„ê¸° (ì˜µì…˜)
                const shuffledOptions = [...question.options].sort(() => Math.random() - 0.5);

                shuffledOptions.forEach(option => {
                    const optionId = `q${currentQuestionIndex}_${option.replace(/\s+/g, '_')}`;
                    const optionElement = `
                        <div>
                            <input type="radio" name="option" id="${optionId}" value="${option}" class="option-input hidden">
                            <label for="${optionId}" class="option-label block w-full text-left p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                ${option}
                            </label>
                        </div>
                    `;
                    optionsContainer.innerHTML += optionElement;
                });
            } else if (question.type === 'ox') {
                optionsContainer.style.display = 'none';
                oxOptionsContainer.style.display = 'flex';

                const options = ['o', 'x'];
                options.forEach(option => {
                    const optionId = `q${currentQuestionIndex}_${option}`;
                    const optionText = option === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                    const optionElement = `
                        <div class="flex-1">
                            <input type="radio" name="option" id="${optionId}" value="${option}" class="option-input hidden">
                            <label for="${optionId}" class="option-label block w-full text-center p-4 border-2 ${option === 'o' ? 'border-blue-400' : 'border-red-400'} rounded-lg cursor-pointer hover:bg-gray-50 text-xl font-bold">
                                ${optionText}
                            </label>
                        </div>
                    `;
                    oxOptionsContainer.innerHTML += optionElement;
                });
            }

            // ìƒì„±ëœ ë¼ë””ì˜¤ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.querySelectorAll('input[name="option"]').forEach(input => {
                input.addEventListener('change', () => {
                    userAnswers[currentQuestionIndex] = input.value;
                    // ì •ë‹µ/ì˜¤ë‹µ ì¦‰ì‹œ í”¼ë“œë°± (ì„ íƒ ì‚¬í•­)
                    // checkAnswer(input);
                    enableNextButton();
                });
            });
        }

        // (ì„ íƒ ì‚¬í•­) ì¦‰ì‹œ í”¼ë“œë°± í•¨ìˆ˜
        // function checkAnswer(selectedInput) {
        //     const question = questions[currentQuestionIndex];
        //     const selectedLabel = document.querySelector(`label[for="${selectedInput.id}"]`);
        //     const allLabels = document.querySelectorAll('.option-label');
        //     const allInputs = document.querySelectorAll('.option-input');

        //     // ëª¨ë“  ì…ë ¥ ë¹„í™œì„±í™”
        //     allInputs.forEach(input => input.disabled = true);
            
        //     allLabels.forEach(label => {
        //         const input = document.getElementById(label.getAttribute('for'));
        //         if (input.value === question.answer) {
        //             label.classList.add('!bg-green-500', '!text-white', '!border-green-500'); // ì •ë‹µ
        //         } else if (input.checked) {
        //             label.classList.add('!bg-red-500', '!text-white', '!border-red-500'); // ì„ íƒí•œ ì˜¤ë‹µ
        //         } else {
        //             label.classList.add('opacity-50'); // ì„ íƒ ì•ˆ ëœ ë‚˜ë¨¸ì§€
        //         }
        //     });
        //     enableNextButton();
        // }


        function enableNextButton() {
            nextQuestionBtn.disabled = false;
            nextQuestionBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            nextQuestionBtn.classList.add('bg-blue-500', 'hover:bg-blue-600', 'text-white');
            if (currentQuestionIndex === questions.length - 1) {
                nextQuestionBtn.textContent = 'ê²°ê³¼ ë³´ê¸°';
            } else {
                nextQuestionBtn.textContent = 'ë‹¤ìŒ';
            }
        }

        function disableNextButton() {
            nextQuestionBtn.disabled = true;
            nextQuestionBtn.classList.add('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            nextQuestionBtn.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'text-white');
        }

        function nextQuestion() {
            if (currentQuestionIndex >= questions.length - 1) {
                showResults();
            } else {
                currentQuestionIndex++;
                loadQuestion();
            }
        }

        function showResults() {
            score = 0;
            feedbackDetails = []; // í”¼ë“œë°± ì´ˆê¸°í™”
            feedbackContainer.innerHTML = ''; // í”¼ë“œë°± ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”

            questions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const correctAnswer = q.answer;
                const isCorrect = userAnswer === correctAnswer;

                if (isCorrect) {
                    score++;
                }

                // í”¼ë“œë°± ìƒì„¸ ì •ë³´ ìƒì„±
                const feedback = {
                    question: q.question,
                    vocab: q.vocab,
                    userAnswer: userAnswer,
                    correctAnswer: correctAnswer,
                    isCorrect: isCorrect
                };
                feedbackDetails.push(feedback); // ìƒì„¸ í”¼ë“œë°± ì €ì¥

                // í”¼ë“œë°± UI ìƒì„±
                const feedbackElement = document.createElement('div');
                feedbackElement.className = `p-4 rounded-lg ${isCorrect ? 'feedback-correct' : 'feedback-incorrect'}`;
                
                let answerText = correctAnswer;
                if (q.type === 'ox') {
                    answerText = correctAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                }
                let userAnswerText = userAnswer;
                if (q.type === 'ox' && userAnswer) { // userAnswerê°€ undefinedê°€ ì•„ë‹Œì§€ í™•ì¸
                    userAnswerText = userAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                } else if (!userAnswer) {
                    userAnswerText = "ì„ íƒ ì•ˆ í•¨";
                }

                feedbackElement.innerHTML = `
                    <p class="font-semibold text-gray-800">${index + 1}. [${q.vocab}] ${q.question.replace(/\n/g, '<br>')}</p>
                    <p class="mt-2 text-sm"><strong>ì •ë‹µ:</strong> ${answerText}</p>
                    <p class="text-sm"><strong>ì„ íƒ:</strong> ${userAnswerText} ${isCorrect ? 'ğŸ‘' : 'ğŸ‘'}</p>
                `;
                feedbackContainer.appendChild(feedbackElement);
            });

            scoreEl.textContent = score;
            totalScoreEl.textContent = questions.length; // ì´ì  ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸
            showScreen('results-screen');
        }

        function restartQuiz() {
            showScreen('main-screen');
        }

        // --- 5. ê¸°ë¡ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜ ---

        function saveResults() {
            try {
                const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
                const resultData = {
                    date: new Date().toLocaleString('ko-KR'),
                    score: score,
                    total: questions.length,
                    feedback: feedbackDetails // ìƒì„¸ í”¼ë“œë°± ì •ë³´ í¬í•¨
                };
                history.push(resultData);
                localStorage.setItem('quizHistory', JSON.stringify(history));
                
                saveResultsBtn.textContent = 'ì €ì¥ ì™„ë£Œ!';
                saveResultsBtn.disabled = true;
                saveResultsBtn.classList.replace('bg-green-500', 'bg-gray-400');
                saveResultsBtn.classList.remove('hover:bg-green-600');
                
                // ê¸°ë¡ ëª©ë¡ ì¦‰ì‹œ ê°±ì‹ 
                loadHistory();
            } catch (e) {
                console.error("ê²°ê³¼ ì €ì¥ ì‹¤íŒ¨:", e);
                // (ëŒ€ì•ˆ) ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼. ì—¬ê¸°ì„œëŠ” alert ëŒ€ì‹  console ì‚¬ìš©
                console.error("localStorage ì‚¬ìš©ì´ ì°¨ë‹¨ë˜ì—ˆê±°ë‚˜ ìš©ëŸ‰ì´ ì´ˆê³¼ë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }
        }

        function loadHistory() {
            try {
                const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
                historyList.innerHTML = ''; // ëª©ë¡ ì´ˆê¸°í™”

                if (history.length === 0) {
                    historyList.innerHTML = '<p class="text-gray-500 text-center">ì €ì¥ëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    historyContainer.classList.add('hidden'); // ê¸°ë¡ì´ ì—†ìœ¼ë©´ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
                    return;
                }

                historyContainer.classList.remove('hidden'); // ê¸°ë¡ì´ ìˆìœ¼ë©´ ì»¨í…Œì´ë„ˆ í‘œì‹œ
                
                history.reverse().forEach((record, index) => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'p-3 bg-white border rounded-lg flex justify-between items-center cursor-pointer hover:bg-gray-50';
                    historyItem.innerHTML = `
                        <span>
                            <span class="font-semibold">${record.date}</span>
                            <span class="ml-2 text-blue-600 font-bold">${record.score} / ${record.total} ì </span>
                        </span>
                        <span class="text-sm text-gray-500">ìƒì„¸ë³´ê¸° &gt;</span>
                    `;
                    // í´ë¦­ ì‹œ ìƒì„¸ ëª¨ë‹¬ ì—´ê¸°
                    historyItem.addEventListener('click', () => showHistoryDetail(record));
                    historyList.appendChild(historyItem);
                });
            } catch (e) {
                console.error("ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", e);
                historyList.innerHTML = '<p class="text-red-500 text-center">ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        function showHistoryDetail(record) {
            modalContent.innerHTML = ''; // ëª¨ë‹¬ ë‚´ìš© ì´ˆê¸°í™”
            
            const header = document.createElement('div');
            header.className = 'mb-4';
            header.innerHTML = `
                <h4 class="text-lg font-bold">${record.date}</h4>
                <p class="text-2xl font-bold text-blue-600">ì´ì : ${record.score} / ${record.total}</p>
            `;
            modalContent.appendChild(header);

            record.feedback.forEach((fb, index) => {
                const feedbackElement = document.createElement('div');
                feedbackElement.className = `p-4 rounded-lg mb-3 ${fb.isCorrect ? 'feedback-correct' : 'feedback-incorrect'}`;
                
                let answerText = fb.correctAnswer;
                let userAnswerText = fb.userAnswer;
                
                // ì›ë³¸ ì§ˆë¬¸ì˜ ìœ í˜•ì„ ì°¾ì•„ì„œ O/X ì²˜ë¦¬
                const originalQuestion = questions.find(q => q.vocab === fb.vocab && q.question === fb.question);
                const questionType = originalQuestion ? originalQuestion.type : null;

                if (questionType === 'ox') {
                    answerText = fb.correctAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                    userAnswerText = fb.userAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                }
                if (!fb.userAnswer) {
                     userAnswerText = "ì„ íƒ ì•ˆ í•¨";
                }

                feedbackElement.innerHTML = `
                    <p class="font-semibold text-gray-800">${index + 1}. [${fb.vocab}] ${fb.question.replace(/\n/g, '<br>')}</p>
                    <p class="mt-2 text-sm"><strong>ì •ë‹µ:</strong> ${answerText}</p>
                    <p class="text-sm"><strong>ì„ íƒ:</strong> ${userAnswerText} ${fb.isCorrect ? 'ğŸ‘' : 'ğŸ‘'}</p>
                `;
                modalContent.appendChild(feedbackElement);
            });

            historyModal.classList.remove('hidden');
        }

        function closeModal() {
            historyModal.classList.add('hidden');
        }

        function clearHistory() {
            // alert, confirmì€ iframe í™˜ê²½ì—ì„œ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ,
            // ì—¬ê¸°ì„œëŠ” í™•ì¸ ì ˆì°¨ ì—†ì´ ë°”ë¡œ ì‚­ì œí•˜ê±°ë‚˜ ì»¤ìŠ¤í…€ ëª¨ë‹¬ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
            // ì¼ë‹¨ì€ ë°”ë¡œ ì‚­ì œë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.
            // if (confirm('ì •ë§ë¡œ ëª¨ë“  ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            try {
                localStorage.removeItem('quizHistory');
                loadHistory(); // ëª©ë¡ ê°±ì‹ 
            } catch (e) {
                console.error("ê¸°ë¡ ì‚­ì œ ì‹¤íŒ¨:", e);
            }
            // }
        }

        // --- 6. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ---
        startQuizBtn.addEventListener('click', startQuiz);
        nextQuestionBtn.addEventListener('click', nextQuestion);
        restartQuizBtn.addEventListener('click', restartQuiz);
        saveResultsBtn.addEventListener('click', saveResults);
        
        showHistoryBtn.addEventListener('click', () => {
            loadHistory(); // ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ ìµœì‹  ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜´
            historyContainer.classList.toggle('hidden');
        });
        
        clearHistoryBtn.addEventListener('click', clearHistory);
        
        closeModalBtn.addEventListener('click', closeModal);
        closeModalBtnBottom.addEventListener('click', closeModal);

        hintBtn.addEventListener('click', () => {
            hintTextEl.classList.remove('hidden'); // íŒíŠ¸ í‘œì‹œ
            hintBtn.classList.add('hidden'); // íŒíŠ¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        });

        // ì´ˆê¸° í™”ë©´ ì„¤ì •
        showScreen('main-screen');
    </script>
</body>
</html>

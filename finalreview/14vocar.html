<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì–´ ì–´íœ˜ í€´ì¦ˆ</title>
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì ìš© */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        /* í™”ë©´ ì „í™˜ì„ ìœ„í•œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .screen {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  í™”ë©´ ìˆ¨ê¹€ */
        }
        .screen.active {
            display: block; /* active í´ë˜ìŠ¤ê°€ ìˆëŠ” í™”ë©´ë§Œ í‘œì‹œ */
        }
        /* ì»¤ìŠ¤í…€ ë¼ë””ì˜¤ ë²„íŠ¼/ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .option-label {
            transition: all 0.2s ease-in-out;
        }
        .option-input:checked + .option-label {
            background-color: #3b82f6; /* bg-blue-500 */
            color: white;
            border-color: #3b82f6; /* border-blue-500 */
        }
        .option-input:disabled + .option-label {
            background-color: #f3f4f6; /* bg-gray-100 */
            color: #9ca3af; /* text-gray-400 */
            cursor: not-allowed;
        }
        /* ì •ë‹µ/ì˜¤ë‹µ í”¼ë“œë°± ìŠ¤íƒ€ì¼ */
        .feedback-correct {
            background-color: #d1fae5; /* bg-green-100 */
            border-left: 4px solid #10b981; /* border-green-500 */
        }
        .feedback-incorrect {
            background-color: #fee2e2; /* bg-red-100 */
            border-left: 4px solid #ef4444; /* border-red-500 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex items-center justify-center min-h-screen">

    <div class="container w-full max-w-2xl mx-auto p-4 md:p-8 bg-white shadow-2xl rounded-lg">

        <!-- 1. ë©”ì¸ í™”ë©´ -->
        <div id="main-screen" class="screen active text-center">
            <h1 class="text-3xl font-bold text-blue-600 mb-6">í•œêµ­ì–´ ì–´íœ˜ í€´ì¦ˆ</h1>
            <p class="text-lg text-gray-700 mb-8">ì—°ìŠµ 1~4ì— ë‚˜ì˜¨ ì–´íœ˜ë¥¼ ë³µìŠµí•´ ë´…ì‹œë‹¤.</p>
            <button id="start-quiz-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg text-xl transition duration-300 shadow-md">
                í€´ì¦ˆ ì‹œì‘í•˜ê¸°
            </button>
            <button id="show-history-btn" class="w-full mt-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg text-xl transition duration-300">
                í€´ì¦ˆ ê¸°ë¡ ë³´ê¸°
            </button>
            <div id="history-container" class="mt-6 text-left hidden">
                <h2 class="text-2xl font-semibold mb-4 text-center">í€´ì¦ˆ ê¸°ë¡</h2>
                <div id="history-list" class="space-y-3 max-h-64 overflow-y-auto">
                    <!-- ê¸°ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
                <button id="clear-history-btn" class="w-full mt-4 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    ê¸°ë¡ ëª¨ë‘ ì‚­ì œ
                </button>
            </div>
            <!-- ìƒì„¸ ê¸°ë¡ ëª¨ë‹¬ -->
            <div id="history-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
                <div class="bg-white rounded-lg shadow-xl w-full max-w-xl max-h-[80vh] overflow-hidden">
                    <div class="flex justify-between items-center p-4 border-b">
                        <h3 class="text-xl font-bold">ìƒì„¸ ê¸°ë¡</h3>
                        <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
                    </div>
                    <div id="modal-content" class="p-6 overflow-y-auto max-h-[calc(80vh-120px)]">
                        <!-- ìƒì„¸ í”¼ë“œë°±ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                    <div class="p-4 border-t bg-gray-50 text-right">
                        <button id="close-modal-btn-bottom" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                            ë‹«ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. í€´ì¦ˆ í™”ë©´ -->
        <div id="quiz-screen" class="screen">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-lg font-semibold text-blue-600">ë¬¸ì œ <span id="question-number">1</span> / <span id="total-questions">27</span></span>
                    <!-- íŒíŠ¸ ë²„íŠ¼ê³¼ í…ìŠ¤íŠ¸ê°€ í‘œì‹œë  ì˜ì—­ -->
                    <div class="text-right">
                        <button id="hint-btn" class="text-sm font-medium bg-yellow-300 hover:bg-yellow-400 text-yellow-800 px-3 py-1 rounded-full transition duration-300 shadow-sm">
                            ğŸ’¡ íŒíŠ¸ ë³´ê¸°
                        </button>
                        <span id="hint-text" class="hidden text-sm font-semibold text-yellow-800 bg-yellow-100 px-3 py-1 rounded-full ml-2"></span>
                    </div>
                </div>
                <!-- ì§„í–‰ë¥  ë°” -->
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-500 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>

            <h2 id="question-text" class="text-xl md:text-2xl font-semibold text-gray-900 mb-6 min-h-[60px]"></h2>
            
            <!-- ì„ íƒì§€ ì˜ì—­ -->
            <div id="options-container" class="space-y-3">
                <!-- ì„ íƒì§€ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>

            <!-- O/X ì„ íƒì§€ ì˜ì—­ -->
            <div id="ox-options-container" class="flex space-x-4 mt-4">
                <!-- O/X ë²„íŠ¼ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>

            <button id="next-question-btn" class="w-full mt-8 bg-gray-300 text-gray-500 font-bold py-3 px-6 rounded-lg text-lg transition duration-300 cursor-not-allowed" disabled>
                ë‹¤ìŒ
            </button>
        </div>

        <!-- 3. ê²°ê³¼ í™”ë©´ -->
        <div id="results-screen" class="screen text-center">
            <h1 class="text-3xl font-bold text-blue-600 mb-4">í€´ì¦ˆ ì™„ë£Œ!</h1>
            <div class="bg-blue-50 p-6 rounded-lg shadow-inner mb-6">
                <h2 class="text-2xl font-semibold mb-2">ë‹¹ì‹ ì˜ ì ìˆ˜</h2>
                <p class="text-5xl font-bold text-blue-600"><span id="score">0</span> / <span id="total-score">27</span></p>
            </div>
            
            <div class="text-left mb-6">
                <h3 class="text-2xl font-semibold mb-4">ìƒì„¸ í”¼ë“œë°±</h3>
                <div id="feedback-container" class="space-y-4 max-h-80 overflow-y-auto p-4 bg-gray-50 rounded-lg border">
                    <!-- í”¼ë“œë°±ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <button id="save-results-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-300 shadow-md">
                ê²°ê³¼ ì €ì¥í•˜ê¸°
            </button>
            <button id="restart-quiz-btn" class="w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-300">
                ë‹¤ì‹œ í’€ê¸°
            </button>
        </div>

    </div>

    <script>
        // --- 1. í€´ì¦ˆ ë°ì´í„° ---
        // ëª¨ë“  ì–´íœ˜ë¥¼ í¬í•¨í•˜ëŠ” 27ê°œì˜ ë¬¸ì œ
        const questions = [
            // ì—°ìŠµ 1 ì–´íœ˜ (8ê°œ)
            {
                vocab: 'ì—¬ìœ ê°€ ìˆë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ë§¤ì¼ ì•¼ê·¼ì„ í•´ì„œ ìš”ì¦˜ ì•„ì£¼ ì—¬ìœ ê°€ ìˆë‹¤."',
                answer: 'x'
            },
            {
                vocab: 'í™œê¸°ì°¨ë‹¤',
                type: 'mc',
                question: 'ë¹ˆì¹¸ì— ì•Œë§ì€ ë§ì€?: "ì‹œì¥ì€ ì–¸ì œë‚˜ ì‚¬ëŒë“¤ë¡œ ë¶ë¹„ê³  ________."',
                options: ['í™œê¸°ì°¨ë‹¤', 'ë”°ë¶„í•˜ë‹¤', 'í‰í™”ë¡­ë‹¤', 'ë¶ˆí¸í•˜ë‹¤'],
                answer: 'í™œê¸°ì°¨ë‹¤'
            },
            {
                vocab: 'ë¶ˆí¸í•˜ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ìƒˆë¡œ ì´ì‚¬í•œ ì§‘ì€ ì§€í•˜ì² ì—­ì´ ê°€ê¹Œì›Œì„œ ì•„ì£¼ ë¶ˆí¸í•˜ë‹¤."',
                answer: 'x'
            },
            {
                vocab: 'ê³µê¸°ê°€ ë§‘ë‹¤',
                type: 'dialogue',
                question: 'A: ì‹œê³¨ì— ì‚¬ë‹ˆê¹Œ ë­ê°€ ì œì¼ ì¢‹ì•„ìš”?\nB: ë¬´ì—‡ë³´ë‹¤ ________.\n',
                options: ['ê³µê¸°ê°€ ë§‘ì€ ê²Œ ì¢‹ì•„ìš”', 'í¸ì˜ ì‹œì„¤ì´ ì˜ ë˜ì–´ ìˆì–´ìš”', 'ì‹œê°„ì´ ê°€ëŠ” ì¤„ ëª°ë¼ìš”', 'ì‚¬ëŒë“¤ì´ í™œê¸°ì°¨ìš”'],
                answer: 'ê³µê¸°ê°€ ë§‘ì€ ê²Œ ì¢‹ì•„ìš”'
            },
            {
                vocab: 'ë”°ë¶„í•˜ë‹¤',
                type: 'mc',
                question: 'í•˜ëŠ” ì¼ ì—†ì´ ì£¼ë§ ë‚´ë‚´ ì§‘ì—ë§Œ ìˆì—ˆë”ë‹ˆ ì •ë§ ________.',
                options: ['ë”°ë¶„í•˜ë‹¤', 'í™œê¸°ì°¨ë‹¤', 'ì—¬ìœ ê°€ ìˆë‹¤', 'í‰í™”ë¡­ë‹¤'],
                answer: 'ë”°ë¶„í•˜ë‹¤'
            },
            {
                vocab: 'í‰í™”ë¡­ë‹¤',
                type: 'mc',
                question: 'ì•„ë¬´ ì¼ë„ ì—†ì´ ì¡°ìš©í•œ ì‹œê³¨ì˜ í’ê²½ì€ ì°¸ ________.',
                options: ['í‰í™”ë¡œì›Œìš”', 'ë¶ˆí¸í•´ìš”', 'ë”°ë¶„í•´ìš”', 'í™œê¸°ì°¨ìš”'],
                answer: 'í‰í™”ë¡œì›Œìš”'
            },
            {
                vocab: 'ì‹œê°„ì´ ê°€ëŠ” ì¤„ ëª¨ë¥´ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì¹œí•œ ì¹œêµ¬ì™€ ì˜¤ëœë§Œì— ë§Œë‚˜ì„œ ìˆ˜ë‹¤ë¥¼ ë–¨ì—ˆë”ë‹ˆ ì‹œê°„ì´ ê°€ëŠ” ì¤„ ëª°ëë‹¤."',
                answer: 'o'
            },
            {
                vocab: 'í¸ì˜ ì‹œì„¤ì´ ì˜ ë˜ì–´ ìˆë‹¤',
                type: 'mc',
                question: 'ë„ì‹œ ìƒí™œì˜ ê°€ì¥ í° ì¥ì ì€ ________ ì ì…ë‹ˆë‹¤.',
                options: ['ê³µê¸°ê°€ ë§‘ì€', 'ë†ì‚¬ë¥¼ ì§“ëŠ”', 'í¸ì˜ ì‹œì„¤ì´ ì˜ ë˜ì–´ ìˆëŠ”', 'ê°€ì¶•ì„ í‚¤ìš°ëŠ”'],
                answer: 'í¸ì˜ ì‹œì„¤ì´ ì˜ ë˜ì–´ ìˆëŠ”'
            },
            // ì—°ìŠµ 2 ì–´íœ˜ (6ê°œ)
            {
                vocab: 'ì •ì›',
                type: 'mc',
                question: 'ì§‘ ì•ì— ê½ƒê³¼ ë‚˜ë¬´ë¥¼ ì‹¬ì–´ ì˜ˆìœ ________ì„/ë¥¼ ë§Œë“¤ì—ˆì–´ìš”.',
                options: ['ì •ì›', 'ë†ì‚¬', 'ê°€ì¶•', 'ì”ë””'],
                answer: 'ì •ì›'
            },
            {
                vocab: 'ì”ë””',
                type: 'mc',
                question: 'ê³µì› ________ ìœ„ì— ë—ìë¦¬ë¥¼ í´ê³  ì•‰ì•˜ì–´ìš”.',
                options: ['ì”ë””', 'ì±„ì†Œ', 'ë¬¼ê³ ê¸°', 'ë†ì‚¬'],
                answer: 'ì”ë””'
            },
            {
                vocab: 'ì±„ì†Œ',
                type: 'mc',
                question: 'ì˜¤ì´, ìƒì¶”, ë‹¹ê·¼, ê³ ì¶” ë“±ì€ ëª¨ë‘ ________ì…ë‹ˆë‹¤.',
                options: ['ì±„ì†Œ', 'ê°€ì¶•', 'ì •ì›', 'ë¬¼ê³ ê¸°'],
                answer: 'ì±„ì†Œ'
            },
            {
                vocab: 'ë†ì‚¬',
                type: 'dialogue',
                question: 'A: ì£¼ë§ì— ë­ í•˜ì…¨ì–´ìš”?\nB: ì‹œê³¨ì—ì„œ ë¶€ëª¨ë‹˜ ________ ì§“ëŠ” ê²ƒì„ ë„ì™€ë“œë ¸ì–´ìš”.',
                options: ['ë†ì‚¬', 'ê°€ì¶•', 'ë¬¼ê³ ê¸°', 'ì •ì›'],
                answer: 'ë†ì‚¬'
            },
            {
                vocab: 'ê°€ì¶•',
                type: 'mc',
                question: 'ì†Œ, ë¼ì§€, ë‹­ì²˜ëŸ¼ ì§‘ì—ì„œ ê¸°ë¥´ëŠ” ë™ë¬¼ë“¤ì„ ________ì´ë¼ê³  í•©ë‹ˆë‹¤.',
                options: ['ê°€ì¶•', 'ì±„ì†Œ', 'ë¬¼ê³ ê¸°', 'ì”ë””'],
                answer: 'ê°€ì¶•'
            },
            {
                vocab: 'ë¬¼ê³ ê¸°',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì€í‡´ í›„ì— ë°”ë‹¤ì—ì„œ ë†ì‚¬ë¥¼ ì§€ìœ¼ë©° ì‚´ê³  ì‹¶ë‹¤."',
                hint: 'ë°”ë‹¤ì—ì„œëŠ” ë³´í†µ ë¬¼ê³ ê¸°ë¥¼ ì¡ìŠµë‹ˆë‹¤.',
                answer: 'x'
            },
            // ì—°ìŠµ 3 ì–´íœ˜ (7ê°œ)
            {
                vocab: 'ê¹ë‹¤',
                type: 'mc',
                question: 'ì”ë””ê°€ ë„ˆë¬´ ë§ì´ ìë¼ì„œ ________.',
                options: ['ê¹ì•„ì•¼ê² ì–´ìš”', 'ì‹¬ì–´ì•¼ê² ì–´ìš”', 'ì§€ì–´ì•¼ê² ì–´ìš”', 'ì£¼ì›Œì•¼ê² ì–´ìš”'],
                answer: 'ê¹ì•„ì•¼ê² ì–´ìš”'
            },
            {
                vocab: 'ì‹¬ë‹¤',
                type: 'mc',
                question: 'ë´„ì´ ë˜ì–´ì„œ ì •ì›ì— ê½ƒì„ ________.',
                options: ['ì‹¬ì—ˆì–´ìš”', 'í‚¤ì› ì–´ìš”', 'ë‚šì•˜ì–´ìš”', 'ì§€ì—ˆì–´ìš”'],
                answer: 'ì‹¬ì—ˆì–´ìš”'
            },
            {
                vocab: 'ê°€ê¾¸ë‹¤',
                type: 'dialogue',
                question: 'A: ì •ì›ì´ ì°¸ ì˜ˆì˜ë„¤ìš”.\nB: ê°ì‚¬í•©ë‹ˆë‹¤. ì œê°€ ë§¤ì¼ ________.\n',
                options: ['ê°€ê¾¸ê³  ìˆì–´ìš”', 'ë‚šê³  ìˆì–´ìš”', 'ì§“ê³  ìˆì–´ìš”', 'ì¤ê³  ìˆì–´ìš”'],
                answer: 'ê°€ê¾¸ê³  ìˆì–´ìš”'
            },
            {
                vocab: 'í‚¤ìš°ë‹¤',
                type: 'dialogue',
                question: 'A: í• ì•„ë²„ì§€ ëŒì— ê°€ì¶•ì´ ìˆì–´ìš”?\nB: ë„¤, ì†Œì™€ ë‹­ì„ ________ ê³„ì„¸ìš”.',
                options: ['í‚¤ìš°ê³ ', 'ì‹¬ê³ ', 'ê¹ê³ ', 'ë‚šê³ '],
                answer: 'í‚¤ìš°ê³ '
            },
            {
                vocab: 'ì¤ë‹¤',
                type: 'mc',
                question: 'ê³µì›ì—ì„œ ì“°ë ˆê¸°ë¥¼ ________.',
                options: ['ì£¼ì› ì–´ìš”', 'ì§€ì—ˆì–´ìš”', 'í‚¤ì› ì–´ìš”', 'ì‹¬ì—ˆì–´ìš”'],
                answer: 'ì£¼ì› ì–´ìš”'
            },
            {
                vocab: 'ì§“ë‹¤',
                type: 'mc',
                question: 'ì‹œê³¨ì— ì€í‡´ í›„ ì‚´ ì§‘ì„ ________.',
                options: ['ì§€ì—ˆì–´ìš”', 'ë‚šì•˜ì–´ìš”', 'ê¹ì•˜ì–´ìš”', 'ì£¼ì› ì–´ìš”'],
                answer: 'ì§€ì—ˆì–´ìš”'
            },
            {
                vocab: 'ë‚šë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì–´ì œ ë‚šì‹œë¥¼ ê°€ì„œ ë¬¼ê³ ê¸°ë¥¼ ì—´ ë§ˆë¦¬ë‚˜ ì‹¬ì—ˆë‹¤."',
                hint: 'ë¬¼ê³ ê¸°ëŠ” ë‚šì‹œë¡œ ì¡ìŠµë‹ˆë‹¤.',
                answer: 'x'
            },
            // ì—°ìŠµ 4 ì–´íœ˜ (6ê°œ)
            {
                vocab: 'ì‚¬ë¼ì§€ë‹¤',
                type: 'mc',
                question: 'ì˜¤ë˜ëœ ê±´ë¬¼ì´ í—ë¦¬ê³  ê·¸ ìë¦¬ì— ë†’ì€ ë¹Œë”©ì´ ________.',
                options: ['ìƒê²¼ë‹¤', 'ì‚¬ë¼ì¡Œë‹¤', 'ë³€í–ˆë‹¤', 'ëª°ë¼ë´¤ë‹¤'],
                answer: 'ìƒê²¼ë‹¤' // 'ìƒê¸°ë‹¤' ë¬¸ì œë¡œ ë³€ê²½
            },
            {
                vocab: 'ìƒê¸°ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ë„ë¡œê°€ ìƒˆë¡œ ìƒê²¨ì„œ ì˜ˆì „ ëª¨ìŠµì´ ëª¨ë‘ ì‚¬ë¼ì¡Œë‹¤."',
                answer: 'o' // 'ì‚¬ë¼ì§€ë‹¤' ë¬¸ì œë¡œ ë³€ê²½
            },
            {
                vocab: 'ìƒìƒì´ ë˜ë‹¤',
                type: 'dialogue',
                question: 'A: 10ë…„ ë’¤ì— ì´ê³³ì´ ì–´ë–»ê²Œ ë³€í• ê¹Œìš”?\nB: ê¸€ì„ìš”, ì˜ ________.\n',
                options: ['ìƒìƒì´ ì•ˆ ë¼ìš”', 'ìƒìƒì´ ë¼ìš”', 'ëª°ë¼ë³´ê² ì–´ìš”', 'ë³€í–ˆì–´ìš”'],
                answer: 'ìƒìƒì´ ì•ˆ ë¼ìš”' // 'ìƒìƒì´ ì•ˆ ë˜ë‹¤' ë¬¸ì œë¡œ ë³€ê²½
            },
            {
                vocab: 'ìƒìƒì´ ì•ˆ ë˜ë‹¤',
                type: 'ox',
                question: 'ë¬¸ì¥ì´ ë°”ë¦…ë‹ˆê¹Œ?: "ì˜ˆì „ ì‚¬ì§„ì„ ë³´ë‹ˆ ì§€ê¸ˆì˜ ëª¨ìŠµê³¼ ë„ˆë¬´ ë‹¬ë¼ì„œ ìƒìƒì´ ì˜ ëœë‹¤."',
                answer: 'x' // 'ìƒìƒì´ ë˜ë‹¤' ë¬¸ì œë¡œ ë³€ê²½
            },
            {
                vocab: 'ë³€í•˜ë‹¤',
                type: 'mc',
                question: '10ë…„ ë§Œì— ê³ í–¥ì— ëŒì•„ì™”ë”ë‹ˆ ë„ˆë¬´ ë§ì´ ________ ì•Œì•„ë³¼ ìˆ˜ê°€ ì—†ì—ˆë‹¤.',
                options: ['ë³€í•´ì„œ', 'ì‚¬ë¼ì ¸ì„œ', 'ìƒê²¨ì„œ', 'ìƒìƒí•´ì„œ'],
                answer: 'ë³€í•´ì„œ'
            },
            {
                vocab: 'ëª°ë¼ë³´ë‹¤',
                type: 'mc',
                question: 'ì¹œêµ¬ê°€ ë„ˆë¬´ ì˜ˆë»ì ¸ì„œ í•˜ë§ˆí„°ë©´ ________.',
                options: ['ëª°ë¼ë³¼ ë»”í–ˆë‹¤', 'ì‚¬ë¼ì§ˆ ë»”í–ˆë‹¤', 'ë³€í•  ë»”í–ˆë‹¤', 'ìƒê¸¸ ë»”í–ˆë‹¤'],
                answer: 'ëª°ë¼ë³¼ ë»”í–ˆë‹¤'
            }
        ];

        // --- 2. ì „ì—­ ë³€ìˆ˜ ---
        const mainScreen = document.getElementById('main-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const screens = [mainScreen, quizScreen, resultsScreen];

        const startQuizBtn = document.getElementById('start-quiz-btn');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const restartQuizBtn = document.getElementById('restart-quiz-btn');
        const saveResultsBtn = document.getElementById('save-results-btn');
        const showHistoryBtn = document.getElementById('show-history-btn');
        const historyContainer = document.getElementById('history-container');
        const historyList = document.getElementById('history-list');
        const clearHistoryBtn = document.getElementById('clear-history-btn');

        const historyModal = document.getElementById('history-modal');
        const modalContent = document.getElementById('modal-content');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const closeModalBtnBottom = document.getElementById('close-modal-btn-bottom');

        const questionNumberEl = document.getElementById('question-number');
        const totalQuestionsEl = document.getElementById('total-questions');
        const hintBtn = document.getElementById('hint-btn');
        const hintTextEl = document.getElementById('hint-text');
        const progressBar = document.getElementById('progress-bar');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const oxOptionsContainer = document.getElementById('ox-options-container');

        const scoreEl = document.getElementById('score');
        const totalScoreEl = document.getElementById('total-score');
        const feedbackContainer = document.getElementById('feedback-container');

        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;
        let feedbackDetails = [];

        // --- 3. í™”ë©´ ì „í™˜ í•¨ìˆ˜ ---
        function showScreen(screenId) {
            screens.forEach(screen => {
                if (screen.id === screenId) {
                    screen.classList.add('active');
                } else {
                    screen.classList.remove('active');
                }
            });
        }

        // --- 4. í€´ì¦ˆ ë¡œì§ í•¨ìˆ˜ ---

        function startQuiz() {
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;
            feedbackDetails = [];
            totalQuestionsEl.textContent = questions.length;
            totalScoreEl.textContent = questions.length;
            showScreen('quiz-screen');
            loadQuestion();
        }

        function loadQuestion() {
            // ì´ì „ ì„ íƒì§€ ì´ˆê¸°í™”
            optionsContainer.innerHTML = '';
            oxOptionsContainer.innerHTML = '';
            
            // ë‹¤ìŒ ë²„íŠ¼ ë¹„í™œì„±í™”
            disableNextButton();

            if (currentQuestionIndex >= questions.length) {
                showResults();
                return;
            }

            // íŒíŠ¸ ë²„íŠ¼ê³¼ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
            hintTextEl.classList.add('hidden'); // íŒíŠ¸ ìˆ¨ê¸°ê¸°
            hintTextEl.textContent = ''; // íŒíŠ¸ ë‚´ìš© ì§€ìš°ê¸°
            hintBtn.classList.remove('hidden'); // íŒíŠ¸ ë²„íŠ¼ ë³´ì´ê¸°

            const question = questions[currentQuestionIndex];
            
            // ì§ˆë¬¸ ì •ë³´ ì—…ë°ì´íŠ¸
            questionNumberEl.textContent = currentQuestionIndex + 1;
            questionTextEl.innerHTML = question.question.replace(/\n/g, '<br>'); // ì¤„ë°”ê¿ˆ ì²˜ë¦¬
            
            // íŒíŠ¸ ë‚´ìš© ì„¤ì •
            let hint = question.vocab; // ê¸°ë³¸ íŒíŠ¸ëŠ” ì–´íœ˜
            if (question.hint) { // 'hint' ì†ì„±ì´ ë”°ë¡œ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©
                hint = question.hint;
            }
            hintTextEl.textContent = hint; // íŒíŠ¸ í…ìŠ¤íŠ¸ ì„¤ì •

            // ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;

            // ë¬¸ì œ ìœ í˜•ì— ë”°ë¼ ì„ íƒì§€ ìƒì„±
            if (question.type === 'mc' || question.type === 'dialogue') {
                oxOptionsContainer.style.display = 'none';
                optionsContainer.style.display = 'block';
                
                question.options.forEach(option => {
                    const optionId = `q${currentQuestionIndex}_${option.replace(/\s+/g, '_')}`;
                    const optionElement = `
                        <div>
                            <input type="radio" name="option" id="${optionId}" value="${option}" class="option-input hidden">
                            <label for="${optionId}" class="option-label block w-full text-left p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                ${option}
                            </label>
                        </div>
                    `;
                    optionsContainer.innerHTML += optionElement;
                });
            } else if (question.type === 'ox') {
                optionsContainer.style.display = 'none';
                oxOptionsContainer.style.display = 'flex';

                const options = ['o', 'x'];
                options.forEach(option => {
                    const optionId = `q${currentQuestionIndex}_${option}`;
                    const optionText = option === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                    const optionElement = `
                        <div class="flex-1">
                            <input type="radio" name="option" id="${optionId}" value="${option}" class="option-input hidden">
                            <label for="${optionId}" class="option-label block w-full text-center p-4 border-2 ${option === 'o' ? 'border-blue-400' : 'border-red-400'} rounded-lg cursor-pointer hover:bg-gray-50 text-xl font-bold">
                                ${optionText}
                            </label>
                        </div>
                    `;
                    oxOptionsContainer.innerHTML += optionElement;
                });
            }

            // ìƒì„±ëœ ë¼ë””ì˜¤ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.querySelectorAll('input[name="option"]').forEach(input => {
                input.addEventListener('change', () => {
                    userAnswers[currentQuestionIndex] = input.value;
                    enableNextButton();
                });
            });
        }

        function enableNextButton() {
            nextQuestionBtn.disabled = false;
            nextQuestionBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            nextQuestionBtn.classList.add('bg-blue-500', 'hover:bg-blue-600', 'text-white');
            if (currentQuestionIndex === questions.length - 1) {
                nextQuestionBtn.textContent = 'ê²°ê³¼ ë³´ê¸°';
            } else {
                nextQuestionBtn.textContent = 'ë‹¤ìŒ';
            }
        }

        function disableNextButton() {
            nextQuestionBtn.disabled = true;
            nextQuestionBtn.classList.add('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            nextQuestionBtn.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'text-white');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        function showResults() {
            score = 0;
            feedbackDetails = []; // í”¼ë“œë°± ì´ˆê¸°í™”
            feedbackContainer.innerHTML = ''; // í”¼ë“œë°± ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”

            questions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const correctAnswer = q.answer;
                const isCorrect = userAnswer === correctAnswer;

                if (isCorrect) {
                    score++;
                }

                // í”¼ë“œë°± ìƒì„¸ ì •ë³´ ìƒì„±
                const feedback = {
                    question: q.question,
                    vocab: q.vocab,
                    userAnswer: userAnswer,
                    correctAnswer: correctAnswer,
                    isCorrect: isCorrect
                };
                feedbackDetails.push(feedback); // ìƒì„¸ í”¼ë“œë°± ì €ì¥

                // í”¼ë“œë°± UI ìƒì„±
                const feedbackElement = document.createElement('div');
                feedbackElement.className = `p-4 rounded-lg ${isCorrect ? 'feedback-correct' : 'feedback-incorrect'}`;
                
                let answerText = correctAnswer;
                if (q.type === 'ox') {
                    answerText = correctAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                }
                let userAnswerText = userAnswer;
                if (q.type === 'ox') {
                    userAnswerText = userAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                }

                feedbackElement.innerHTML = `
                    <p class="font-semibold text-gray-800">${index + 1}. [${q.vocab}] ${q.question.replace(/\n/g, '<br>')}</p>
                    <p class="mt-2 text-sm"><strong>ì •ë‹µ:</strong> ${answerText}</p>
                    <p class="text-sm"><strong>ì„ íƒ:</strong> ${userAnswerText} ${isCorrect ? 'ğŸ‘' : 'ğŸ‘'}</p>
                `;
                feedbackContainer.appendChild(feedbackElement);
            });

            scoreEl.textContent = score;
            showScreen('results-screen');
        }

        function restartQuiz() {
            showScreen('main-screen');
        }

        // --- 5. ê¸°ë¡ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜ ---

        function saveResults() {
            const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            const resultData = {
                date: new Date().toLocaleString('ko-KR'),
                score: score,
                total: questions.length,
                feedback: feedbackDetails // ìƒì„¸ í”¼ë“œë°± ì •ë³´ í¬í•¨
            };
            history.push(resultData);
            localStorage.setItem('quizHistory', JSON.stringify(history));
            
            saveResultsBtn.textContent = 'ì €ì¥ ì™„ë£Œ!';
            saveResultsBtn.disabled = true;
            saveResultsBtn.classList.replace('bg-green-500', 'bg-gray-400');
            
            // ê¸°ë¡ ëª©ë¡ ì¦‰ì‹œ ê°±ì‹ 
            loadHistory();
        }

        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            historyList.innerHTML = ''; // ëª©ë¡ ì´ˆê¸°í™”

            if (history.length === 0) {
                historyList.innerHTML = '<p class="text-gray-500 text-center">ì €ì¥ëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                historyContainer.classList.add('hidden');
                return;
            }

            historyContainer.classList.remove('hidden');
            
            history.reverse().forEach((record, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'p-3 bg-white border rounded-lg flex justify-between items-center cursor-pointer hover:bg-gray-50';
                historyItem.innerHTML = `
                    <span>
                        <span class="font-semibold">${record.date}</span>
                        <span class="ml-2 text-blue-600 font-bold">${record.score} / ${record.total} ì </span>
                    </span>
                    <span class="text-sm text-gray-500">ìƒì„¸ë³´ê¸° &gt;</span>
                `;
                // í´ë¦­ ì‹œ ìƒì„¸ ëª¨ë‹¬ ì—´ê¸°
                historyItem.addEventListener('click', () => showHistoryDetail(record));
                historyList.appendChild(historyItem);
            });
        }

        function showHistoryDetail(record) {
            modalContent.innerHTML = ''; // ëª¨ë‹¬ ë‚´ìš© ì´ˆê¸°í™”
            
            const header = document.createElement('div');
            header.className = 'mb-4';
            header.innerHTML = `
                <h4 class="text-lg font-bold">${record.date}</h4>
                <p class="text-2xl font-bold text-blue-600">ì´ì : ${record.score} / ${record.total}</p>
            `;
            modalContent.appendChild(header);

            record.feedback.forEach((fb, index) => {
                const feedbackElement = document.createElement('div');
                feedbackElement.className = `p-4 rounded-lg mb-3 ${fb.isCorrect ? 'feedback-correct' : 'feedback-incorrect'}`;
                
                let answerText = fb.correctAnswer;
                let userAnswerText = fb.userAnswer;
                
                // O/X ë‹µë³€ ì²˜ë¦¬
                const questionType = questions.find(q => q.vocab === fb.vocab)?.type;
                if (questionType === 'ox') {
                    answerText = fb.correctAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                    userAnswerText = fb.userAnswer === 'o' ? 'O (ë§ë‹¤)' : 'X (í‹€ë¦¬ë‹¤)';
                }

                feedbackElement.innerHTML = `
                    <p class="font-semibold text-gray-800">${index + 1}. [${fb.vocab}] ${fb.question.replace(/\n/g, '<br>')}</p>
                    <p class="mt-2 text-sm"><strong>ì •ë‹µ:</strong> ${answerText}</p>
                    <p class="text-sm"><strong>ì„ íƒ:</strong> ${userAnswerText} ${fb.isCorrect ? 'ğŸ‘' : 'ğŸ‘'}</p>
                `;
                modalContent.appendChild(feedbackElement);
            });

            historyModal.classList.remove('hidden');
        }

        function closeModal() {
            historyModal.classList.add('hidden');
        }

        function clearHistory() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem('quizHistory');
                loadHistory(); // ëª©ë¡ ê°±ì‹ 
            }
        }

        // --- 6. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ---
        startQuizBtn.addEventListener('click', startQuiz);
        nextQuestionBtn.addEventListener('click', nextQuestion);
        restartQuizBtn.addEventListener('click', restartQuiz);
        saveResultsBtn.addEventListener('click', saveResults);
        
        showHistoryBtn.addEventListener('click', () => {
            loadHistory();
            historyContainer.classList.toggle('hidden');
        });
        
        clearHistoryBtn.addEventListener('click', clearHistory);
        
        closeModalBtn.addEventListener('click', closeModal);
        closeModalBtnBottom.addEventListener('click', closeModal);

        hintBtn.addEventListener('click', () => {
            hintTextEl.classList.remove('hidden'); // íŒíŠ¸ í‘œì‹œ
            hintBtn.classList.add('hidden'); // íŒíŠ¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        });

        // ì´ˆê¸° í™”ë©´ ì„¤ì •
        showScreen('main-screen');
    </script>
</body>
</html>

<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>í•œêµ­ì–´ ë¹ˆì¹¸ ì¶”ë¡  (TOPIK â…¡ ì¤‘ê¸‰)</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      /* Warm / Cozy Theme (Default) */
      --bg: #F9F7F2;          /* ë”°ëœ»í•œ ë¯¸ìƒ‰ ë°°ê²½ */
      --card: #FFFFFF;        /* ê¹¨ë—í•œ ì¹´ë“œ */
      --card-sub: #F4F1EA;    /* ì¹´ë“œ ë‚´ë¶€ êµ¬ë¶„ ì˜ì—­ */
      --text-main: #4A4238;   /* ë¶€ë“œëŸ¬ìš´ ê³ ë™ìƒ‰ í…ìŠ¤íŠ¸ */
      --text-sub: #8C8478;    /* ì—°í•œ ì„¤ëª… í…ìŠ¤íŠ¸ */
      --primary: #8DA399;     /* ì°¨ë¶„í•œ ì„¸ì´ì§€ ê·¸ë¦° (ê°•ì¡°) */
      --primary-dark: #6F857B;
      --accent: #D4A373;      /* ë”°ëœ»í•œ ë¼ë–¼ìƒ‰ (í¬ì¸íŠ¸) */
      --line: #E6E2D8;        /* ì—°í•œ ê²½ê³„ì„  */
      --correct: #8FB598;     /* ì •ë‹µ (íŒŒìŠ¤í…” ê·¸ë¦°) */
      --wrong: #E08E8E;       /* ì˜¤ë‹µ (íŒŒìŠ¤í…” ë ˆë“œ) */
      --shadow: 0 8px 24px rgba(74, 66, 56, 0.08);
      
      --radius: 20px;
      --radius-sm: 12px;
      --font-body: "Gowun Dodum", "Noto Sans KR", sans-serif;
    }

    [data-theme="dark"] {
      /* Night Study Theme */
      --bg: #2C2824;
      --card: #38322C;
      --card-sub: #423C36;
      --text-main: #E8DCCA;
      --text-sub: #A89F96;
      --primary: #7A968C;
      --primary-dark: #5F7A70;
      --accent: #C49363;
      --line: #504840;
      --correct: #5E8F6C;
      --wrong: #C76B6B;
      --shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text-main);
      font-family: var(--font-body);
      font-size: 17px;
      line-height: 1.6;
      transition: background 0.3s ease, color 0.3s ease;
      -webkit-font-smoothing: antialiased;
    }

    /* Layout */
    .wrap {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 20px 120px;
    }

    /* Header */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(249, 247, 242, 0.95); /* Backdrop for light */
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--line);
      transition: background 0.3s;
    }
    [data-theme="dark"] header { background: rgba(44, 40, 36, 0.95); }

    .head-inner {
      max-width: 800px;
      margin: 0 auto;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
    }
    .brand h1 {
      margin: 0;
      font-size: 20px;
      color: var(--text-main);
      font-weight: 700;
    }
    .brand p {
      margin: 4px 0 0;
      font-size: 13px;
      color: var(--text-sub);
    }

    /* Progress Bar */
    .progress-track {
      height: 4px;
      background: var(--line);
      width: 100%;
      position: absolute;
      bottom: 0;
      left: 0;
    }
    .progress-fill {
      height: 100%;
      background: var(--primary);
      width: 0%;
      transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    }

    /* Controls */
    .controls { display: flex; gap: 8px; }
    
    button {
      font-family: var(--font-body);
      cursor: pointer;
      border: none;
      outline: none;
      transition: all 0.2s;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 99px;
      background: var(--card);
      border: 1px solid var(--line);
      color: var(--text-main);
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(0,0,0,0.03);
    }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.06); }
    .btn:active { transform: translateY(0); }
    
    .btn.primary {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
    }
    .btn.primary:hover { background: var(--primary-dark); }
    
    .btn.secondary {
      background: var(--card-sub);
      color: var(--text-sub);
      font-size: 13px;
    }

    .seg-control {
      display: inline-flex;
      background: var(--card-sub);
      padding: 4px;
      border-radius: 99px;
    }
    .seg-control button {
      padding: 6px 12px;
      border-radius: 99px;
      font-size: 13px;
      color: var(--text-sub);
      background: transparent;
      font-weight: 600;
    }
    .seg-control button[aria-pressed="true"] {
      background: var(--card);
      color: var(--primary);
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    /* Dashboard */
    .dashboard {
      margin: 24px 0;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: space-between;
      align-items: center;
    }
    .stats {
      display: flex;
      gap: 12px;
      font-size: 14px;
      color: var(--text-sub);
      font-weight: 600;
    }
    .badge {
      padding: 4px 10px;
      background: var(--card-sub);
      border-radius: 6px;
      color: var(--text-main);
    }
    .badge b { color: var(--accent); }

    /* Cards */
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      overflow: hidden;
      border: 2px solid transparent;
      transition: transform 0.2s, border-color 0.3s;
    }
    .card.correct { border-color: var(--correct); }
    .card.wrong { border-color: var(--wrong); }

    .card-head {
      padding: 18px 24px;
      border-bottom: 1px solid var(--line);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      background: var(--card-sub);
    }
    .q-meta h3 { margin: 0; font-size: 18px; color: var(--text-main); }
    .q-meta span { font-size: 13px; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; }

    .card-body { padding: 24px; }

    /* Passage & Blanks */
    .passage-box {
      background: var(--bg);
      padding: 20px;
      border-radius: var(--radius-sm);
      line-height: 2.0;
      font-size: 18px;
      color: var(--text-main);
      border: 1px solid var(--line);
    }
    
    .blank-wrap {
      display: inline-block;
      margin: 0 4px;
      position: relative;
    }
    
    select, input[type="text"] {
      appearance: none;
      border: 2px solid var(--line);
      background: var(--card);
      color: var(--primary-dark);
      padding: 8px 32px 8px 12px;
      border-radius: 8px;
      font-family: inherit;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: border-color 0.2s, box-shadow 0.2s;
      min-width: 120px;
      max-width: 100%;
    }
    /* Select arrow custom */
    .blank-wrap::after {
      content: '';
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      width: 0; 
      height: 0; 
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 6px solid var(--text-sub);
      pointer-events: none;
    }
    .blank-wrap.type-mode::after { display: none; } /* No arrow for text input */
    .blank-wrap input { padding-right: 12px; }

    select:focus, input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(141, 163, 153, 0.2);
    }
    
    /* Feedback Area */
    .feedback {
      margin-top: 16px;
      padding: 16px;
      border-radius: var(--radius-sm);
      font-size: 14px;
      display: none;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn { from{opacity:0; transform:translateY(-5px)} to{opacity:1; transform:translateY(0)}}

    .feedback.is-correct { background: color-mix(in srgb, var(--correct) 15%, transparent); color: #3d5a45; display: block; }
    .feedback.is-wrong { background: color-mix(in srgb, var(--wrong) 15%, transparent); color: #8a3c3c; display: block; }

    [data-theme="dark"] .feedback.is-correct { color: #a4dcb5; }
    [data-theme="dark"] .feedback.is-wrong { color: #ffb8b8; }

    .card-foot {
      padding: 16px 24px;
      border-top: 1px solid var(--line);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    
    .link-btn {
      background: none;
      color: var(--primary);
      font-weight: 700;
      padding: 0;
      border: none;
      font-size: 14px;
      text-decoration: underline;
      text-underline-offset: 4px;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(4px);
      z-index: 200;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .modal-overlay.open { display: flex; opacity: 1; }

    .modal {
      width: 100%;
      max-width: 600px;
      max-height: 85vh;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 20px 50px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      transform: scale(0.95);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .modal-overlay.open .modal { transform: scale(1); }

    .modal-head {
      padding: 20px;
      border-bottom: 1px solid var(--line);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .modal-head h2 { margin: 0; font-size: 18px; }
    
    .modal-body {
      padding: 20px;
      overflow-y: auto;
    }
    
    .tabs { display: flex; gap: 8px; margin-bottom: 20px; }
    .tab {
      flex: 1;
      padding: 10px;
      border-radius: 12px;
      background: var(--card-sub);
      color: var(--text-sub);
      font-weight: 600;
      font-size: 14px;
    }
    .tab[aria-selected="true"] {
      background: var(--primary);
      color: #fff;
      box-shadow: 0 4px 12px rgba(141, 163, 153, 0.4);
    }

    .study-list { display: flex; flex-direction: column; gap: 12px; }
    .study-item {
      padding: 12px 16px;
      border: 1px solid var(--line);
      border-radius: 12px;
      background: var(--bg);
    }
    .study-item strong { display: block; color: var(--accent); margin-bottom: 4px; font-size: 15px; }
    .study-item p { margin: 0; font-size: 14px; color: var(--text-main); }

    /* Bottom Bar */
    .bottom-bar {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: var(--card);
      border-top: 1px solid var(--line);
      padding: 12px 20px calc(12px + env(safe-area-inset-bottom));
      z-index: 90;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
      display: flex;
      justify-content: center;
      gap: 12px;
    }

    @media (max-width: 480px) {
      .head-inner { flex-direction: column; align-items: stretch; gap: 16px; }
      .controls { justify-content: space-between; }
      .card-foot { flex-direction: column; align-items: stretch; text-align: center; }
      select, input[type="text"] { width: 100%; min-width: 0; }
    }
  </style>
</head>
<body>

<header>
  <div class="head-inner">
    <div class="brand">
      <h1>í•œêµ­ì–´ ë¹ˆì¹¸ ì¶”ë¡ </h1>
      <p>TOPIK â…¡ ì¤‘ê¸‰ (2ê¸‰ í›„ë°˜~3ê¸‰ ì´ˆë°˜)</p>
    </div>
    <div class="controls">
      <div class="seg-control" role="group">
        <button id="langKoBtn" aria-pressed="true">ì„¤ëª…: í•œêµ­ì–´</button>
        <button id="langViBtn" aria-pressed="false">Tiáº¿ng Viá»‡t</button>
      </div>
      <button class="btn secondary" id="themeBtn">í…Œë§ˆ ë³€ê²½</button>
    </div>
  </div>
  <div class="progress-track"><div class="progress-fill" id="progressBar"></div></div>
</header>

<div class="wrap">
  <div class="dashboard">
    <div class="stats">
      <span class="badge">ì§„í–‰ <b id="progressText">0/5</b></span>
      <span class="badge">ì •ë‹µ <b id="scoreText">0</b></span>
    </div>
    <div class="controls">
      <button class="btn secondary" id="modeToggleBtn">ì…ë ¥ ëª¨ë“œ: ì„ íƒí˜•</button>
      <button class="btn" id="openGlobalStudyBtn">ì „ì²´ ë‹¨ì–´ì¥</button>
      <button class="btn secondary" id="resetBtn">ì´ˆê¸°í™”</button>
    </div>
  </div>

  <div id="quizRoot"></div>
</div>

<div class="bottom-bar">
  <button class="btn primary" id="gradeAllBtn" style="flex:1; max-width: 200px;">ì „ì²´ ì±„ì </button>
  <button class="btn secondary" id="filterWrongBtn">ì˜¤ë‹µë§Œ ë³´ê¸°</button>
</div>

<div class="modal-overlay" id="modalOverlay" aria-hidden="true">
  <div class="modal">
    <div class="modal-head">
      <h2 id="modalTitle">í•™ìŠµ ìë£Œ</h2>
      <button class="btn secondary" id="closeModalBtn">ë‹«ê¸°</button>
    </div>
    <div class="modal-body">
      <div class="tabs">
        <button class="tab" id="tabVocab" aria-selected="true">ì–´íœ˜/í‘œí˜„</button>
        <button class="tab" id="tabTips" aria-selected="false">ì¶”ë¡  íŒ</button>
        <button class="tab" id="tabExplain" aria-selected="false">ì •ë‹µ í•´ì„¤</button>
      </div>
      <div id="modalContent" class="study-list"></div>
    </div>
  </div>
</div>

<script>
  // ----------------------------------------------------
  // DATA (Revised for Natural Vietnamese & Korean)
  // ----------------------------------------------------
  const QUIZ = [
    {
      id: 1,
      title: "ëƒ‰ì¥ê³  ë³´ê´€ ìœ„ì¹˜ (Vá»‹ trÃ­ báº£o quáº£n)",
      blanks: [
        {
          key: "b1",
          label: "1ë²ˆ ë¹ˆì¹¸",
          correct: ["ëƒ‰ì¥ì‹¤ ì•ˆìª½ì— ë‘” ìŒì‹ë³´ë‹¤", "ì•ˆìª½ì— ë‘” ìŒì‹ë³´ë‹¤"],
          options: ["ëƒ‰ì¥ì‹¤ ì•ˆìª½ì— ë‘” ìŒì‹ë³´ë‹¤", "ëƒ‰ì¥ì‹¤ ì•ˆìª½ì— ë‘” ìŒì‹ì²˜ëŸ¼", "ëƒ‰ì¥ì‹¤ ë¬¸ ìª½ì— ë‘” ìŒì‹ë³´ë‹¤", "ë°”ë¡œ êº¼ë‚¸ ìŒì‹ë³´ë‹¤"]
        },
        {
          key: "b2",
          label: "2ë²ˆ ë¹ˆì¹¸",
          correct: ["ë‘ì§€ ë§ê³ ", "ë³´ê´€í•˜ì§€ ë§ê³ ", "ë„£ì§€ ë§ê³ "],
          options: ["ë‘ì§€ ë§ê³ ", "ë„£ì–´ë„ ë˜ì§€ë§Œ", "ë„£ì–´ì•¼ í•˜ê³ ", "ë‘ì—ˆë‹¤ê°€"]
        }
      ],
      passage: [
        `ëƒ‰ì¥ê³  ì† ì‹í’ˆì„ ì‹ ì„ í•˜ê²Œ ë³´ê´€í•˜ë ¤ë©´ ì‹í’ˆì˜ íŠ¹ì„±ì— ë§ëŠ” ìœ„ì¹˜ì— ë‘ì–´ì•¼ í•œë‹¤. ëƒ‰ì¥ì‹¤ì˜ ë¬¸ ìª½ì€ ì•ˆìª½ë³´ë‹¤ ì˜¨ë„ê°€ ë†’ê³  ë¬¸ì„ ì—´ê³  ë‹«ì„ ë•Œë§ˆë‹¤ ì˜¨ë„ê°€ ë‹¬ë¼ì§„ë‹¤. ê·¸ë˜ì„œ ê°™ì€ ì‹í’ˆì´ë¼ë„ ëƒ‰ì¥ì‹¤ ë¬¸ ìª½ì— ë‘” ìŒì‹ì€ (`,
        `) ë” ë¹¨ë¦¬ ìƒí•œë‹¤. ë¬¼ì´ë‚˜ ìŒë£Œìˆ˜ì²˜ëŸ¼ ì‰½ê²Œ ìƒí•˜ì§€ ì•ŠëŠ” ì‹í’ˆì€ ë¬¸ ìª½ì— ë³´ê´€í•´ë„ ëœë‹¤. ê·¸ë ‡ì§€ë§Œ ìš°ìœ ë‚˜ ë‹¬ê±€ì²˜ëŸ¼ ìƒí•˜ê¸° ì‰¬ìš´ ì‹í’ˆì€ ëƒ‰ì¥ê³  ë¬¸ ìª½ì— (`,
        `) ëƒ‰ì¥ê³  ì•ˆìª½ì— ë³´ê´€í•´ì•¼ í•œë‹¤.`
      ],
      study: {
        ko: {
          vocab: [
            ["ë³´ê´€í•˜ë‹¤", "ë¬¼ê±´ì„ ë§¡ì•„ì„œ ê°„ì§í•˜ë‹¤."],
            ["ì‹ ì„ í•˜ë‹¤", "ìŒì‹ì´ ìƒí•˜ì§€ ì•Šê³  ìƒíƒœê°€ ì¢‹ë‹¤."],
            ["íŠ¹ì„±", "ê·¸ê²ƒë§Œì´ ê°€ì§„ íŠ¹ë³„í•œ ì„±ì§ˆ."],
            ["ìƒí•˜ë‹¤", "ìŒì‹ì´ ì©ê±°ë‚˜ ë§›ì´ ë³€í•˜ë‹¤."],
            ["-ì§€ ë§ê³ ", "ì•ì˜ í–‰ë™ì€ í•˜ì§€ ë§ê³  ë’¤ì˜ í–‰ë™ì„ í•˜ë¼ëŠ” ëœ» (ê¸ˆì§€+ëŒ€ì•ˆ)."]
          ],
          tips: [
            "ì²« ë²ˆì§¸ ë¹ˆì¹¸ì€ 'ë¬¸ ìª½'ê³¼ 'ì•ˆìª½'ì„ ë¹„êµí•˜ê³  ìˆì–´ìš”. 'ë” ë¹¨ë¦¬ ìƒí•œë‹¤'ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ë ¤ë©´ ë¹„êµ í‘œí˜„ì¸ '-ë³´ë‹¤'ê°€ í•„ìš”í•´ìš”.",
            "ë‘ ë²ˆì§¸ ë¹ˆì¹¸ ë’¤ì— 'ì•ˆìª½ì— ë³´ê´€í•´ì•¼ í•œë‹¤'ê°€ ë‚˜ì˜¤ì£ ? ê·¸ëŸ¼ ì•ì—ëŠ” 'ë¬¸ ìª½ì— ë‘ë©´ ì•ˆ ëœë‹¤'ëŠ” ë§ì´ ì™€ì•¼ í•´ìš”."
          ],
          explain: [
            "1ë²ˆ: ë¬¸ ìª½ì´ ì˜¨ë„ê°€ ë” ë†’ìœ¼ë‹ˆê¹Œ ì•ˆìª½ë³´ë‹¤ ìŒì‹ì´ ë¹¨ë¦¬ ìƒí•©ë‹ˆë‹¤. ë¹„êµ ëŒ€ìƒì¸ 'ì•ˆìª½ì— ë‘” ìŒì‹ë³´ë‹¤'ê°€ ì •ë‹µì…ë‹ˆë‹¤.",
            "2ë²ˆ: 'ë¬¸ ìª½ì— ë‘ì§€ ì•ŠëŠ”ë‹¤'ì™€ 'ì•ˆìª½ì— ë‘”ë‹¤'ë¥¼ ì—°ê²°í•´ì•¼ í•˜ë¯€ë¡œ 'ë‘ì§€ ë§ê³ 'ê°€ ê°€ì¥ ìì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤."
          ]
        },
        vi: {
          vocab: [
            ["ë³´ê´€í•˜ë‹¤", "Báº£o quáº£n, cáº¥t giá»¯."],
            ["ì‹ ì„ í•˜ë‹¤", "TÆ°Æ¡i ngon (thá»±c pháº©m)."],
            ["íŠ¹ì„±", "Äáº·c tÃ­nh, tÃ­nh cháº¥t Ä‘áº·c biá»‡t."],
            ["ìƒí•˜ë‹¤", "Bá»‹ há»ng, bá»‹ Ã´i thiu."],
            ["-ì§€ ë§ê³ ", "Äá»«ng lÃ m A mÃ  hÃ£y lÃ m B (Cáº¥u trÃºc cáº¥m Ä‘oÃ¡n + thay tháº¿)."]
          ],
          tips: [
            "Ã” trá»‘ng 1 Ä‘ang so sÃ¡nh 'phÃ­a cá»­a' vÃ  'phÃ­a trong'. Äá»ƒ dáº«n Ä‘áº¿n káº¿t quáº£ 'há»ng nhanh hÆ¡n', ta cáº§n cáº¥u trÃºc so sÃ¡nh '-ë³´ë‹¤'.",
            "Ã” trá»‘ng 2: PhÃ­a sau nÃ³i lÃ  'pháº£i báº£o quáº£n phÃ­a trong', váº­y phÃ­a trÆ°á»›c pháº£i lÃ  'Ä‘á»«ng Ä‘á»ƒ á»Ÿ phÃ­a cá»­a'. HÃ£y tÃ¬m cáº¥u trÃºc phá»§ Ä‘á»‹nh."
          ],
          explain: [
            "1: VÃ¬ nhiá»‡t Ä‘á»™ á»Ÿ cá»­a cao hÆ¡n nÃªn thá»±c pháº©m há»ng nhanh hÆ¡n so vá»›i phÃ­a trong. ÄÃ¡p Ã¡n lÃ  'ì•ˆìª½ì— ë‘” ìŒì‹ë³´ë‹¤' (so vá»›i thá»©c Äƒn Ä‘á»ƒ bÃªn trong).",
            "2: Cáº¥u trÃºc 'Äá»«ng Ä‘á»ƒ á»Ÿ cá»­a mÃ  hÃ£y Ä‘á»ƒ bÃªn trong' lÃ  tá»± nhiÃªn nháº¥t -> 'ë‘ì§€ ë§ê³ '."
          ]
        }
      }
    },
    {
      id: 2,
      title: "ì„±ì ê³¼ ë©”íƒ€ì¸ì§€ (ThÃ nh tÃ­ch há»c táº­p)",
      blanks: [
        {
          key: "b1",
          label: "1ë²ˆ ë¹ˆì¹¸",
          correct: ["ì°¨ì´ê°€ ìˆëŠ”ì§€", "ì°¨ì´ê°€ ìˆëŠ”ê°€"],
          options: ["ì°¨ì´ê°€ ìˆëŠ”ì§€", "ê°€ê²©ì´ ì–¼ë§ˆì¸ì§€", "ì–¸ì œ ì‹œì‘í–ˆëŠ”ì§€", "ì–´ë””ì— ìˆëŠ”ì§€"]
        },
        {
          key: "b2",
          label: "2ë²ˆ ë¹ˆì¹¸",
          correct: ["ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ë°˜ë©´", "ëŠ¥ë ¥ì´ ë›°ì–´ë‚¬ì§€ë§Œ"],
          options: ["ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ë°˜ë©´", "ëŠ¥ë ¥ì´ ì—†ëŠ” ëŒ€ì‹ ", "ëŠ¥ë ¥ì„ ìƒì—ˆê¸° ë•Œë¬¸ì—", "ëŠ¥ë ¥ì´ ë†’ì•„ì ¸ì„œ"]
        }
      ],
      passage: [
        `í•œ ë°©ì†¡ í”„ë¡œê·¸ë¨ì—ì„œ í•™ì—… ì„±ì ì´ ìš°ìˆ˜í•œ í•™ìƒê³¼ ê·¸ë ‡ì§€ ì•Šì€ í•™ìƒë“¤ ì‚¬ì´ì— ì–´ë–¤ (`,
        `) ì¡°ì‚¬í–ˆë‹¤. ì¡°ì‚¬ ê²°ê³¼ ì„±ì ì´ ìš°ìˆ˜í•œ í•™ìƒë“¤ê³¼ ê·¸ë ‡ì§€ ì•Šì€ í•™ìƒë“¤ì˜ ê¸°ì–µë ¥ê³¼ ì•„ì´í(IQ)ëŠ” í° ì°¨ì´ê°€ ì—†ëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ë‹¤. ë°˜ë©´ì— ì„±ì ì´ ìš°ìˆ˜í•œ í•™ìƒë“¤ì€ ìì‹ ì´ ì•„ëŠ” ê²ƒê³¼ ëª¨ë¥´ëŠ” ê²ƒì„ íŒŒì•…í•˜ëŠ” (`,
        `) ì„±ì ì´ ìš°ìˆ˜í•˜ì§€ ì•Šì€ í•™ìƒë“¤ì€ ê·¸ ëŠ¥ë ¥ì´ ë¶€ì¡±í–ˆë‹¤.`
      ],
      study: {
        ko: {
          vocab: [
            ["í•™ì—… ì„±ì ", "ê³µë¶€í•œ ê²°ê³¼ë¡œ ì–»ì€ ì ìˆ˜."],
            ["ìš°ìˆ˜í•˜ë‹¤", "ì—¬ëŸ¿ ì¤‘ì—ì„œ ì•„ì£¼ ë›°ì–´ë‚˜ë‹¤."],
            ["íŒŒì•…í•˜ë‹¤", "ì–´ë–¤ ë‚´ìš©ì„ í™•ì‹¤í•˜ê²Œ ì•Œë‹¤."],
            ["ë°˜ë©´ì—", "ì•ì˜ ë‚´ìš©ê³¼ ë°˜ëŒ€ë˜ëŠ” ë‚´ìš©ì„ ë§í•  ë•Œ ì”€."]
          ],
          tips: [
            "ì²« ë¹ˆì¹¸ì€ ë¬´ì—‡ì„ 'ì¡°ì‚¬'í–ˆëŠ”ì§€ ë¬»ê³  ìˆì–´ìš”. ë³´í†µ ë‘ ê·¸ë£¹ì„ ì¡°ì‚¬í•  ë•ŒëŠ” 'ì°¨ì´'ë¥¼ ë´…ë‹ˆë‹¤.",
            "ë‘ ë²ˆì§¸ ë¹ˆì¹¸ ë’¤ì— 'ì„±ì ì´ ì•ˆ ì¢‹ì€ í•™ìƒì€ ëŠ¥ë ¥ì´ ë¶€ì¡±í–ˆë‹¤'ë¼ê³  í–ˆì£ ? ê·¸ëŸ¼ ì•ì—ëŠ” 'ì„±ì ì´ ì¢‹ì€ í•™ìƒì€ ëŠ¥ë ¥ì´ ì¢‹ë‹¤'ëŠ” ë§ì´ ì™€ì•¼ í•˜ê³ , ë‘ ë¬¸ì¥ì€ ë°˜ëŒ€ ê´€ê³„ì˜ˆìš”."
          ],
          explain: [
            "1ë²ˆ: ì„±ì ì´ ì¢‹ì€ í•™ìƒê³¼ ë‚˜ìœ í•™ìƒì„ ë¹„êµ ì¡°ì‚¬í–ˆìœ¼ë¯€ë¡œ 'ì–´ë–¤ ì°¨ì´ê°€ ìˆëŠ”ì§€'ê°€ ì ì ˆí•©ë‹ˆë‹¤.",
            "2ë²ˆ: ì„±ì  ìš°ìˆ˜ í•™ìƒì€ ëŠ¥ë ¥ì´ ì¢‹ê³ , ë°˜ëŒ€ í•™ìƒì€ ë¶€ì¡±í•˜ë‹¤ëŠ” ëŒ€ì¡° ë¬¸ì¥ì´ë¯€ë¡œ 'ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ë°˜ë©´'ì´ ì •ë‹µì…ë‹ˆë‹¤."
          ]
        },
        vi: {
          vocab: [
            ["í•™ì—… ì„±ì ", "ThÃ nh tÃ­ch há»c táº­p."],
            ["ìš°ìˆ˜í•˜ë‹¤", "Xuáº¥t sáº¯c, Æ°u tÃº."],
            ["íŒŒì•…í•˜ë‹¤", "Náº¯m báº¯t, hiá»ƒu rÃµ."],
            ["ë°˜ë©´ì—", "NgÆ°á»£c láº¡i, trÃ¡i láº¡i (dÃ¹ng khi Ä‘á»‘i chiáº¿u)."]
          ],
          tips: [
            "Ã” trá»‘ng 1: Äá»™ng tá»« lÃ  'Ä‘iá»u tra/kháº£o sÃ¡t'. Khi nghiÃªn cá»©u hai nhÃ³m Ä‘á»‘i láº­p, ngÆ°á»i ta thÆ°á»ng tÃ¬m xem cÃ³ sá»± 'khÃ¡c biá»‡t' (ì°¨ì´) nÃ o khÃ´ng.",
            "Ã” trá»‘ng 2: Váº¿ sau nÃ³i há»c sinh kÃ©m thÃ¬ thiáº¿u nÄƒng lá»±c nÃ y. Váº­y váº¿ trÆ°á»›c nÃ³i há»c sinh giá»i pháº£i 'cÃ³ nÄƒng lá»±c vÆ°á»£t trá»™i', vÃ  cáº§n tá»« ná»‘i thá»ƒ hiá»‡n sá»± Ä‘á»‘i láº­p."
          ],
          explain: [
            "1: Äiá»u tra sá»± khÃ¡c biá»‡t giá»¯a hai nhÃ³m -> 'ì°¨ì´ê°€ ìˆëŠ”ì§€' (cÃ³ sá»± khÃ¡c biá»‡t nÃ o khÃ´ng).",
            "2: Äá»‘i láº­p giá»¯a nhÃ³m giá»i (nÄƒng lá»±c tá»‘t) vÃ  nhÃ³m kÃ©m (thiáº¿u nÄƒng lá»±c) -> 'ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ë°˜ë©´' (trong khi nÄƒng lá»±c xuáº¥t sáº¯c thÃ¬...)."
          ]
        }
      }
    },
    {
      id: 3,
      title: "ìˆ˜ë©´ ì‹œê°„ (Thá»i gian ngá»§)",
      blanks: [
        {
          key: "b1",
          label: "1ë²ˆ ë¹ˆì¹¸",
          correct: ["ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ê²Œ", "ê°ì ë‹¤ë¥´ê²Œ", "ê°œì¸ë§ˆë‹¤ ë‹¤ë¥´ê²Œ"],
          options: ["ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ê²Œ", "í•­ìƒ ë˜‘ê°™ì´", "ì¡°ê¸ˆë§Œ", "ë¹ ë¥´ê²Œ"]
        },
        {
          key: "b2",
          label: "2ë²ˆ ë¹ˆì¹¸",
          correct: ["ë‚®ì ì„ ìì•¼ í•œë‹¤", "ì ì„ ë” ìì•¼ í•œë‹¤"],
          options: ["ë‚®ì ì„ ìì•¼ í•œë‹¤", "ìš´ë™ì„ ë” í•´ì•¼ í•œë‹¤", "ë°¥ì„ ë¨¹ì§€ ë§ì•„ì•¼ í•œë‹¤", "ì»¤í”¼ë¥¼ ë§ˆì…”ì•¼ í•œë‹¤"]
        }
      ],
      passage: [
        `ì¡°ì‚¬ì— ë”°ë¥´ë©´ íƒ€ê³ ë‚œ ì²´ì§ˆì´ë‚˜ ê±´ê°• ìƒíƒœì— ë”°ë¼ í•„ìš”í•œ ìˆ˜ë©´ ì‹œê°„ì´ (`,
        `) ë‚˜íƒ€ë‚¬ë‹¤. ì„±ì¸ 10ëª… ì¤‘ 2ëª…ì€ í•„ìš”í•œ ìˆ˜ë©´ ì‹œê°„ì´ 6ì‹œê°„ ë¯¸ë§Œì¸ ë° ë°˜í•´ 10ëª… ì¤‘ 1ëª…ì€ 9ì‹œê°„ ì´ìƒì„ ìì•¼ í”¼ë¡œê°€ í’€ë¦°ë‹¤ê³  í•œë‹¤. 9ì‹œê°„ ì´ìƒì„ ìì•¼ í•˜ëŠ” ì‚¬ëŒë“¤ì´ ë°¤ì— ì˜ ëª» ì¤ë‹¤ë©´ ë¶€ì¡±í•œ ì ì„ ë³´ì¶©í•˜ê¸° ìœ„í•´ (`,
        `).`
      ],
      study: {
        ko: {
          vocab: [
            ["íƒ€ê³ ë‚œ ì²´ì§ˆ", "íƒœì–´ë‚  ë•Œë¶€í„° ê°€ì§€ê³  ìˆëŠ” ëª¸ì˜ ì„±ì§ˆ."],
            ["ë¯¸ë§Œ / ì´ìƒ", "ë³´ë‹¤ ì ìŒ / ë³´ë‹¤ ë§ê±°ë‚˜ ê°™ìŒ."],
            ["í”¼ë¡œê°€ í’€ë¦¬ë‹¤", "ëª¸ì´ í˜ë“¤ì—ˆë˜ ê²ƒì´ ì‚¬ë¼ì§€ë‹¤."],
            ["ë³´ì¶©í•˜ë‹¤", "ë¶€ì¡±í•œ ê²ƒì„ ì±„ìš°ë‹¤."]
          ],
          tips: [
            "ì²« ë¬¸ì¥ì—ì„œ 'ì²´ì§ˆì— ë”°ë¼'ë¼ê³  í–ˆìœ¼ë‹ˆ ê²°ê³¼ë„ 'ë‹¤ë¥´ë‹¤'ê°€ ë‚˜ì™€ì•¼ê² ì£ ?",
            "ì ì´ ë¶€ì¡±í•´ì„œ 'ë³´ì¶©'í•˜ë ¤ë©´ ë¬´ì—‡ì„ í•´ì•¼ í• ê¹Œìš”? ë‹¹ì—°íˆ ì ì„ ë” ìì•¼ í•©ë‹ˆë‹¤."
          ],
          explain: [
            "1ë²ˆ: ì–´ë–¤ ì‚¬ëŒì€ 6ì‹œê°„, ì–´ë–¤ ì‚¬ëŒì€ 9ì‹œê°„ì´ë¯€ë¡œ 'ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ê²Œ'ê°€ ë§ìŠµë‹ˆë‹¤.",
            "2ë²ˆ: ë¶€ì¡±í•œ ì ì„ ì±„ìš°ëŠ” ê°€ì¥ ì§ì ‘ì ì¸ ë°©ë²•ì€ 'ë‚®ì 'ì…ë‹ˆë‹¤."
          ]
        },
        vi: {
          vocab: [
            ["íƒ€ê³ ë‚œ ì²´ì§ˆ", "CÆ¡ Ä‘á»‹a báº©m sinh."],
            ["ë¯¸ë§Œ / ì´ìƒ", "DÆ°á»›i / TrÃªn (hoáº·c báº±ng)."],
            ["í”¼ë¡œê°€ í’€ë¦¬ë‹¤", "Tan biáº¿n má»‡t má»i, há»“i phá»¥c sá»©c khá»e."],
            ["ë³´ì¶©í•˜ë‹¤", "Bá»• sung, bÃ¹ Ä‘áº¯p."]
          ],
          tips: [
            "CÃ¢u Ä‘áº§u nÃ³i 'tÃ¹y theo cÆ¡ Ä‘á»‹a', nghÄ©a lÃ  káº¿t quáº£ pháº£i 'khÃ¡c nhau' (ë‹¤ë¥´ë‹¤).",
            "Äá»ƒ 'bÃ¹ Ä‘áº¯p' (ë³´ì¶©) giáº¥c ngá»§ thiáº¿u, hÃ nh Ä‘á»™ng há»£p lÃ½ nháº¥t lÃ  ngá»§ thÃªm."
          ],
          explain: [
            "1: NgÆ°á»i cáº§n 6 tiáº¿ng, ngÆ°á»i cáº§n 9 tiáº¿ng -> 'ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ê²Œ' (khÃ¡c nhau tÃ¹y má»—i ngÆ°á»i).",
            "2: CÃ¡ch Ä‘á»ƒ bÃ¹ giáº¥c ngá»§ thiáº¿u lÃ  ngá»§ trÆ°a -> 'ë‚®ì ì„ ìì•¼ í•œë‹¤'."
          ]
        }
      }
    },
    {
      id: 4,
      title: "ìë™ì°¨ ì•ˆì „ ì‹¤í—˜ (Thá»­ nghiá»‡m an toÃ n xe)",
      blanks: [
        {
          key: "b1",
          label: "1ë²ˆ ë¹ˆì¹¸",
          correct: ["ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤", "ë§Œë“¤ê¸° ìœ„í•´ì„œë‹¤"],
          options: ["ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤", "íŒ”ê¸° ìœ„í•´ì„œì´ë‹¤", "ë³´ì—¬ ì£¼ê¸° ìœ„í•´ì„œì´ë‹¤", "ë¹ ë¥´ê²Œ í•˜ê¸° ìœ„í•´ì„œì´ë‹¤"]
        },
        {
          key: "b2",
          label: "2ë²ˆ ë¹ˆì¹¸",
          correct: ["ì¡°ì‚¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ", "ì´ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ"],
          options: ["ì¡°ì‚¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ", "ê´‘ê³ ë¥¼ í†µí•´", "ìš°ì—°íˆ", "í˜ìœ¼ë¡œ"]
        }
      ],
      passage: [
        `ìë™ì°¨ì˜ ìƒì‚° ê³¼ì •ì—ëŠ” ì•ˆì „ ì‹¤í—˜ì´ í¬í•¨ë˜ì–´ ìˆë‹¤. ì•ˆì „ ì‹¤í—˜ì˜ ëª©ì ì€ êµí†µì‚¬ê³ ê°€ ë‚˜ë”ë¼ë„ ì´ìš©ìì˜ í”¼í•´ë¥¼ ì¤„ì¼ ìˆ˜ ìˆëŠ” íŠ¼íŠ¼í•œ ì°¨ë¥¼ (`,
        `). ì•ˆì „ ì‹¤í—˜ì—ì„œëŠ” ì‚¬ëŒ í¬ê¸°ì˜ ì¸í˜•ì„ íƒœìš´ ì°¨ê°€ ê³¼ì†, ì¶”ë½, ì¶©ëŒ ì‚¬ê³  ë“±ì„ ë‹¹í•˜ë„ë¡ ë§Œë“ ë‹¤. ê·¸ë¦¬ê³  ì¸í˜•ì´ ì…ì€ í”¼í•´ ìƒí™©ê³¼ í”¼í•´ ì›ì¸ì„ ì¡°ì‚¬í•œë‹¤. ìë™ì°¨ íšŒì‚¬ëŠ” (`,
        `) ìë™ì°¨ì˜ ì„±ëŠ¥ì„ ê°œì„ í•´ ë‚˜ê°„ë‹¤.`
      ],
      study: {
        ko: {
          vocab: [
            ["ìƒì‚° ê³¼ì •", "ë¬¼ê±´ì„ ë§Œë“¤ì–´ ë‚´ëŠ” ìˆœì„œ/ê³¼ì •."],
            ["ëª©ì ", "ì–´ë–¤ ì¼ì„ í•˜ëŠ” ì´ìœ ë‚˜ ëª©í‘œ."],
            ["íŠ¼íŠ¼í•˜ë‹¤", "ì‰½ê²Œ ë¶€ì„œì§€ì§€ ì•Šë‹¤."],
            ["ê°œì„ í•˜ë‹¤", "ë” ì¢‹ê²Œ ê³ ì¹˜ë‹¤."],
            ["-ì„ ë°”íƒ•ìœ¼ë¡œ", "ë¬´ì—‡ì„ ê¸°ì´ˆ/ê·¼ê±°ë¡œ í•˜ì—¬."]
          ],
          tips: [
            "ì²« ë²ˆì§¸ ë¹ˆì¹¸ì€ 'ëª©ì ì€ ~'ìœ¼ë¡œ ì‹œì‘í–ˆìœ¼ë‹ˆ, ëì€ '~ê¸° ìœ„í•´ì„œì´ë‹¤'ê°€ ìì—°ìŠ¤ëŸ¬ì›Œìš”.",
            "ë‘ ë²ˆì§¸ ë¹ˆì¹¸ì€ 'ì¡°ì‚¬í•œë‹¤' ë’¤ì— ë‚˜ì˜¤ì£ ? ì¡°ì‚¬í•œ ê²ƒì„ ê·¼ê±°ë¡œ ì°¨ë¥¼ ë” ì¢‹ê²Œ ë§Œë“œëŠ” ê±°ì˜ˆìš”."
          ],
          explain: [
            "1ë²ˆ: ì‹¤í—˜ì˜ ëª©ì ì€ ì•ˆì „í•œ ì°¨ë¥¼ 'ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤'ì…ë‹ˆë‹¤.",
            "2ë²ˆ: ì• ë¬¸ì¥ì—ì„œ ì¡°ì‚¬í•œ ë‚´ìš©ì„ ê·¼ê±°ë¡œ ì‚¼ì•„ì•¼ í•˜ë¯€ë¡œ 'ì¡°ì‚¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ'ê°€ ì •ë‹µì…ë‹ˆë‹¤."
          ]
        },
        vi: {
          vocab: [
            ["ìƒì‚° ê³¼ì •", "QuÃ¡ trÃ¬nh sáº£n xuáº¥t."],
            ["ëª©ì ", "Má»¥c Ä‘Ã­ch."],
            ["íŠ¼íŠ¼í•˜ë‹¤", "Cháº¯c cháº¯n, bá»n."],
            ["ê°œì„ í•˜ë‹¤", "Cáº£i thiá»‡n, lÃ m cho tá»‘t hÆ¡n."],
            ["-ì„ ë°”íƒ•ìœ¼ë¡œ", "Dá»±a trÃªn ná»n táº£ng/cÆ¡ sá»Ÿ lÃ ..."]
          ],
          tips: [
            "Ã” 1 báº¯t Ä‘áº§u báº±ng 'Má»¥c Ä‘Ã­ch lÃ ...', nÃªn Ä‘uÃ´i cÃ¢u thÆ°á»ng lÃ  cáº¥u trÃºc 'Ä‘á»ƒ...' (-ê¸° ìœ„í•´ì„œì´ë‹¤).",
            "Ã” 2 xuáº¥t hiá»‡n sau hÃ nh Ä‘á»™ng 'Ä‘iá»u tra'. Äá»ƒ cáº£i thiá»‡n xe, ngÆ°á»i ta pháº£i 'dá»±a trÃªn káº¿t quáº£' Ä‘Ã³."
          ],
          explain: [
            "1: Má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ sáº£n xuáº¥t (lÃ m ra) xe bá»n -> 'ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤'.",
            "2: Cáº£i thiá»‡n hiá»‡u nÄƒng dá»±a trÃªn nhá»¯ng gÃ¬ Ä‘Ã£ Ä‘iá»u tra -> 'ì¡°ì‚¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ'."
          ]
        }
      }
    },
    {
      id: 5,
      title: "íƒœë°±ì‹œì˜ ë³€í™” (Sá»± thay Ä‘á»•i cá»§a Taebaek)",
      blanks: [
        {
          key: "b1",
          label: "1ë²ˆ ë¹ˆì¹¸",
          correct: ["ì‡ í‡´í•´ ê°”ë‹¤", "ì‡ í‡´í–ˆë‹¤", "ì¹¨ì²´ë˜ì—ˆë‹¤"],
          options: ["ì‡ í‡´í•´ ê°”ë‹¤", "ë” í™œë°œí•´ì¡Œë‹¤", "ê°‘ìê¸° ì»¤ì¡Œë‹¤", "ëŒ€ë„ì‹œê°€ ë˜ì—ˆë‹¤"]
        },
        {
          key: "b2",
          label: "2ë²ˆ ë¹ˆì¹¸",
          correct: ["ëŠ˜ì—ˆë‹¤", "ì¦ê°€í–ˆë‹¤", "ëŠ˜ì–´ë‚¬ë‹¤"],
          options: ["ëŠ˜ì—ˆë‹¤", "ì¤„ì—ˆë‹¤", "ë©ˆì·„ë‹¤", "í©ì–´ì¡Œë‹¤"]
        }
      ],
      passage: [
        `ê°•ì›ë„ íƒœë°±ì‹œëŠ” í•œë•Œ ëŒ€í•œë¯¼êµ­ ìµœëŒ€ì˜ ì—°íƒ„ ìƒì‚°ì§€ë¡œì„œ í™œë ¥ì´ ë„˜ì³ ë‚˜ëŠ” ë„ì‹œì˜€ë‹¤. ê·¸ëŸ¬ë‚˜ 1980ë…„ëŒ€ ì´í›„ ë‚œë°© ë°©ì‹ì´ ì—°íƒ„ì—ì„œ ì„ìœ ë‚˜ ê°€ìŠ¤ë¡œ ë°”ë€Œë©´ì„œ ì¸êµ¬ê°€ ê¸‰ê²©íˆ ê°ì†Œí•˜ê³  ë„ì‹œëŠ” ì ì°¨ (`,
        `). íƒœë°±ì‹œ ì£¼ë¯¼ë“¤ì€ ë„ì‹œë¥¼ ì‚´ë¦´ ë°©ë²•ì„ ê³ ë¯¼í–ˆë‹¤. ë†’ì€ ì‚°ì§€ì— ìœ„ì¹˜í•´ ìˆì–´ ì—¬ë¦„ì—ë„ ì‹œì›í•˜ê³  ê²¨ìš¸ì—ëŠ” ëˆˆì´ ë§ì´ ë‚´ë¦¬ëŠ” íƒœë°±ì‹œì˜ ìì—°í™˜ê²½ê³¼ ê¸°í›„ë¥¼ í™œìš©í•˜ê¸°ë¡œ í–ˆë‹¤. ì—¬ë¦„ì—ëŠ” í•´ë°”ë¼ê¸° ì¶•ì œë¥¼ ê·¸ë¦¬ê³  ê²¨ìš¸ì—ëŠ” ëˆˆ ì¶•ì œë¥¼ ì—´ê³  ì ê·¹ì ìœ¼ë¡œ í™ë³´í•œ ê²°ê³¼ íƒœë°±ì‹œì— ì°¾ì•„ì˜¤ëŠ” ê´€ê´‘ê° ìˆ˜ëŠ” ê¾¸ì¤€íˆ (`,
        `).`
      ],
      study: {
        ko: {
          vocab: [
            ["í•œë•Œ", "ê³¼ê±°ì˜ ì–´ëŠ ì‹œê¸°."],
            ["í™œë ¥ì´ ë„˜ì¹˜ë‹¤", "í˜ê³¼ ì—ë„ˆì§€ê°€ ê°€ë“í•˜ë‹¤."],
            ["ê¸‰ê²©íˆ", "ë³€í™”ì˜ ì†ë„ê°€ ë§¤ìš° ë¹ ë¥´ê²Œ."],
            ["ì‡ í‡´í•˜ë‹¤", "ê¸°ìš´ì´ë‚˜ ì„¸ë ¥ì´ ì•½í•´ì§€ë‹¤."],
            ["í™ë³´í•˜ë‹¤", "ë„ë¦¬ ì•Œë¦¬ë‹¤."]
          ],
          tips: [
            "'ê·¸ëŸ¬ë‚˜' ë’¤ì— ì¸êµ¬ê°€ ì¤„ì–´ë“ ë‹¤ê³  í–ˆì–´ìš”. ê·¸ëŸ¼ ë„ì‹œëŠ” ì•ˆ ì¢‹ì€ ìƒíƒœê°€ ë˜ê² ì£ ?",
            "ì¶•ì œë¥¼ ì—´ê³  í™ë³´ë¥¼ ì—´ì‹¬íˆ í–ˆì–´ìš”. ê²°ê³¼ëŠ”? ê´€ê´‘ê°ì´ ë§ì´ ì˜¤ê² ì£ ?"
          ],
          explain: [
            "1ë²ˆ: ì¸êµ¬ê°€ ì¤„ê³  ì‚°ì—…ì´ ì‚¬ë¼ì§€ë©´ ë„ì‹œëŠ” ì•½í•´ì§‘ë‹ˆë‹¤. 'ì‡ í‡´í•´ ê°”ë‹¤'ê°€ ë§ìŠµë‹ˆë‹¤.",
            "2ë²ˆ: ë…¸ë ¥ì˜ ê²°ê³¼ë¡œ ê´€ê´‘ê°ì´ ë§ì•„ì¡Œìœ¼ë¯€ë¡œ 'ëŠ˜ì—ˆë‹¤'ê°€ ì •ë‹µì…ë‹ˆë‹¤."
          ]
        },
        vi: {
          vocab: [
            ["í•œë•Œ", "Má»™t thá»i (trong quÃ¡ khá»©)."],
            ["í™œë ¥ì´ ë„˜ì¹˜ë‹¤", "TrÃ n Ä‘áº§y sá»©c sá»‘ng, sáº§m uáº¥t."],
            ["ê¸‰ê²©íˆ", "Má»™t cÃ¡ch cáº¥pê²©, nhanh chÃ³ng."],
            ["ì‡ í‡´í•˜ë‹¤", "Suy thoÃ¡i, xuá»‘ng dá»‘c."],
            ["í™ë³´í•˜ë‹¤", "Quáº£ng bÃ¡, tuyÃªn truyá»n."]
          ],
          tips: [
            "Sau tá»« 'Tuy nhiÃªn' (ê·¸ëŸ¬ë‚˜), dÃ¢n sá»‘ giáº£m máº¡nh. Váº­y thÃ nh phá»‘ sáº½ Ä‘i theo chiá»u hÆ°á»›ng xáº¥u (suy thoÃ¡i).",
            "Tá»• chá»©c lá»… há»™i vÃ  quáº£ng bÃ¡ tÃ­ch cá»±c. Káº¿t quáº£ tÃ­ch cá»±c lÃ  khÃ¡ch du lá»‹ch sáº½ 'tÄƒng lÃªn'."
          ],
          explain: [
            "1: Do thay Ä‘á»•i nhiÃªn liá»‡u sÆ°á»Ÿi áº¥m, thÃ nh phá»‘ dáº§n Ä‘i xuá»‘ng -> 'ì‡ í‡´í•´ ê°”ë‹¤' (trá»Ÿ nÃªn suy thoÃ¡i).",
            "2: Káº¿t quáº£ cá»§a ná»— lá»±c quáº£ng bÃ¡ lÃ  khÃ¡ch du lá»‹ch tÄƒng -> 'ëŠ˜ì—ˆë‹¤' (Ä‘Ã£ tÄƒng lÃªn)."
          ]
        }
      }
    }
  ];

  // ----------------------------------------------------
  // LOGIC
  // ----------------------------------------------------
  const LS_KEY = "korean_quiz_v2";
  
  // Default State
  const defaultState = {
    theme: "light",
    lang: "ko",      // ko | vi
    mode: "select",  // select | type
    answers: {},     // { "q1_b1": "val" }
    results: {},     // { q1: true/false }
    wrongFilter: false
  };

  let state = loadState();

  // DOM Elements
  const $ = (sel) => document.querySelector(sel);
  const root = $("#quizRoot");

  function loadState() {
    try {
      const raw = localStorage.getItem(LS_KEY);
      return raw ? { ...defaultState, ...JSON.parse(raw) } : { ...defaultState };
    } catch {
      return { ...defaultState };
    }
  }

  function saveState() {
    localStorage.setItem(LS_KEY, JSON.stringify(state));
    updateUIHeader();
  }

  function getKey(qId, bKey) { return `q${qId}_${bKey}`; }

  function updateUIHeader() {
    // Progress
    const total = QUIZ.length;
    const answered = Object.keys(state.results).length;
    const correctCount = Object.values(state.results).filter(Boolean).length;
    
    $("#progressText").textContent = `${answered}/${total}`;
    $("#scoreText").textContent = correctCount;
    
    const pct = Math.round((answered / total) * 100);
    $("#progressBar").style.width = `${pct}%`;

    // Toggles
    $("#langKoBtn").setAttribute("aria-pressed", state.lang === "ko");
    $("#langViBtn").setAttribute("aria-pressed", state.lang === "vi");
    
    $("#modeToggleBtn").textContent = state.mode === "select" ? "ì…ë ¥ ëª¨ë“œ: ì„ íƒí˜•" : "ì…ë ¥ ëª¨ë“œ: ì§ì ‘ ì…ë ¥";
    
    // Theme
    document.body.dataset.theme = state.theme;
  }

  // Render
  function render() {
    root.innerHTML = "";
    
    QUIZ.forEach(q => {
      const result = state.results[`q${q.id}`];
      // Filter Logic
      if (state.wrongFilter && result === true) return; 

      const card = document.createElement("article");
      card.className = "card";
      if (result === true) card.classList.add("correct");
      if (result === false) card.classList.add("wrong");
      
      // Header
      const head = document.createElement("div");
      head.className = "card-head";
      head.innerHTML = `
        <div class="q-meta">
          <span>Question ${q.id}</span>
          <h3>${q.title}</h3>
        </div>
        <div class="controls">
          <button class="btn secondary icon-btn" onclick="readPassage(${q.id})">ğŸ”Š ë“£ê¸°</button>
          <button class="btn secondary icon-btn" onclick="openStudy(${q.id})">ğŸ“– í•™ìŠµ</button>
        </div>
      `;

      // Body
      const body = document.createElement("div");
      body.className = "card-body";
      
      const passageBox = document.createElement("div");
      passageBox.className = "passage-box";
      
      // Construct Passage HTML
      let pHTML = "";
      q.passage.forEach((text, i) => {
        pHTML += text;
        if (i < q.blanks.length) {
          pHTML += createBlankHTML(q, q.blanks[i]);
        }
      });
      passageBox.innerHTML = pHTML;

      // Feedback
      const feedback = document.createElement("div");
      if (result === true) {
        feedback.className = "feedback is-correct";
        feedback.innerHTML = `<strong>ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰</strong> <br>ì°¸ ì˜í–ˆì–´ìš”.`;
      } else if (result === false) {
        feedback.className = "feedback is-wrong";
        feedback.innerHTML = `<strong>ì•„ì‰¬ì›Œìš”. ë‹¤ì‹œ ìƒê°í•´ ë³¼ê¹Œìš”?</strong> <br>íŒíŠ¸ê°€ í•„ìš”í•˜ë©´ 'í•™ìŠµ' ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”.`;
      } else {
        feedback.className = "feedback";
      }

      body.appendChild(passageBox);
      body.appendChild(feedback);

      // Footer
      const foot = document.createElement("div");
      foot.className = "card-foot";
      
      // Button wording based on state
      const btnText = result === true ? "ë‹¤ì‹œ í’€ê¸°" : "ì±„ì í•˜ê¸°";
      const btnClass = result === true ? "btn secondary" : "btn primary";
      
      foot.innerHTML = `
        <button class="link-btn" onclick="openStudy(${q.id}, 'tips')">ğŸ’¡ íŒíŠ¸ ë³´ê¸°</button>
        <div class="controls">
          ${result === false ? `<button class="btn secondary" onclick="showAnswer(${q.id})">ì •ë‹µ ë³´ê¸°</button>` : ""}
          <button class="${btnClass}" onclick="handleCheck(${q.id})">${btnText}</button>
        </div>
      `;

      card.appendChild(head);
      card.appendChild(body);
      card.appendChild(foot);
      root.appendChild(card);

      // Bind Inputs
      q.blanks.forEach(b => {
        const key = getKey(q.id, b.key);
        const el = card.querySelector(`[data-key="${key}"]`);
        if (el) {
          el.value = state.answers[key] || "";
          el.onchange = (e) => {
            state.answers[key] = e.target.value;
            saveState();
          };
        }
      });
    });
    
    updateUIHeader();
  }

  function createBlankHTML(q, blank) {
    const key = getKey(q.id, blank.key);
    const wrapClass = state.mode === "type" ? "blank-wrap type-mode" : "blank-wrap";
    
    if (state.mode === "type") {
      return `<div class="${wrapClass}"><input type="text" data-key="${key}" placeholder="ì…ë ¥" autocomplete="off" spellcheck="false"></div>`;
    } else {
      const opts = [`<option value="" disabled selected>ì„ íƒ</option>`, ...blank.options.map(o => `<option value="${o}">${o}</option>`)].join("");
      return `<div class="${wrapClass}"><select data-key="${key}">${opts}</select></div>`;
    }
  }

  // ----------------------------------------------------
  // ACTIONS
  // ----------------------------------------------------
  window.handleCheck = (qId) => {
    // If already correct, this button acts as reset for this question
    if (state.results[`q${qId}`] === true) {
      if(!confirm("ì´ ë¬¸ì œë¥¼ ì´ˆê¸°í™”í•˜ê³  ë‹¤ì‹œ í’€ê¹Œìš”?")) return;
      delete state.results[`q${qId}`];
      // clear answers
      const q = QUIZ.find(x => x.id === qId);
      q.blanks.forEach(b => delete state.answers[getKey(qId, b.key)]);
      saveState();
      render();
      return;
    }

    const q = QUIZ.find(x => x.id === qId);
    let allCorrect = true;

    q.blanks.forEach(b => {
      const key = getKey(qId, b.key);
      const val = (state.answers[key] || "").trim().replace(/\s+/g, ""); // remove spaces for comparison
      const corrects = b.correct.map(c => c.replace(/\s+/g, ""));
      if (!corrects.includes(val)) allCorrect = false;
    });

    state.results[`q${qId}`] = allCorrect;
    saveState();
    render();
  };

  window.showAnswer = (qId) => {
    if(!confirm("ì •ë‹µì„ í™•ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
    const q = QUIZ.find(x => x.id === qId);
    q.blanks.forEach(b => {
      state.answers[getKey(qId, b.key)] = b.correct[0];
    });
    delete state.results[`q${qId}`]; // Reset status to let them check again or just see it
    saveState();
    render();
  };

  window.readPassage = (qId) => {
    const q = QUIZ.find(x => x.id === qId);
    const text = q.passage.join(" ë¹ˆì¹¸ "); // Read "Blank" for gaps
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "ko-KR";
    utter.rate = 0.9; // Slightly slower for learners
    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
  };

  // ----------------------------------------------------
  // MODAL
  // ----------------------------------------------------
  window.openStudy = (qId, forceTab) => {
    const modal = $("#modalOverlay");
    const content = $("#modalContent");
    const title = $("#modalTitle");
    const isGlobal = qId === 'global';
    
    // Set Active Tab
    const tabName = forceTab || 'vocab';
    document.querySelectorAll('.tab').forEach(t => t.setAttribute('aria-selected', 'false'));
    if(tabName === 'tips') $("#tabTips").setAttribute('aria-selected', 'true');
    else if(tabName === 'explain') $("#tabExplain").setAttribute('aria-selected', 'true');
    else $("#tabVocab").setAttribute('aria-selected', 'true');

    // Build Content
    let html = "";
    const langKey = state.lang; // ko or vi

    if (isGlobal) {
      title.textContent = "ì „ì²´ ë‹¨ì–´ì¥";
      // Aggregate all vocab
      const allVocab = [];
      QUIZ.forEach(q => {
        q.study[langKey].vocab.forEach(v => allVocab.push(v));
      });
      html = allVocab.map(([w, d]) => `
        <div class="study-item">
          <strong>${w}</strong>
          <p>${d}</p>
        </div>
      `).join("");
      // Hide irrelevant tabs for global
      $("#tabTips").style.display = 'none';
      $("#tabExplain").style.display = 'none';
    } else {
      const q = QUIZ.find(x => x.id === qId);
      title.textContent = `í•™ìŠµ ìë£Œ (${q.id}ë²ˆ)`;
      $("#tabTips").style.display = '';
      $("#tabExplain").style.display = '';

      // Define renderers for tabs
      const renderTab = () => {
        const active = document.querySelector('.tab[aria-selected="true"]').id;
        const data = q.study[langKey];
        
        let subHtml = "";
        if (active === "tabVocab") {
          subHtml = data.vocab.map(([w, d]) => `<div class="study-item"><strong>${w}</strong><p>${d}</p></div>`).join("");
        } else if (active === "tabTips") {
          subHtml = data.tips.map((t, i) => `<div class="study-item"><strong>Tip ${i+1}</strong><p>${t}</p></div>`).join("");
        } else {
          subHtml = data.explain.map((t, i) => `<div class="study-item"><strong>í•´ì„¤ ${i+1}</strong><p>${t}</p></div>`).join("");
        }
        content.innerHTML = subHtml;
      };
      
      // Tab Click Events
      $("#tabVocab").onclick = () => { $("#tabVocab").setAttribute('aria-selected',true); $("#tabTips").setAttribute('aria-selected',false); $("#tabExplain").setAttribute('aria-selected',false); renderTab(); };
      $("#tabTips").onclick = () => { $("#tabVocab").setAttribute('aria-selected',false); $("#tabTips").setAttribute('aria-selected',true); $("#tabExplain").setAttribute('aria-selected',false); renderTab(); };
      $("#tabExplain").onclick = () => { $("#tabVocab").setAttribute('aria-selected',false); $("#tabTips").setAttribute('aria-selected',false); $("#tabExplain").setAttribute('aria-selected',true); renderTab(); };
      
      // Initial render
      renderTab();
      modal.classList.add("open");
      return; 
    }

    content.innerHTML = html;
    modal.classList.add("open");
  };

  $("#closeModalBtn").onclick = () => $("#modalOverlay").classList.remove("open");
  $("#modalOverlay").onclick = (e) => { if(e.target === $("#modalOverlay")) $("#modalOverlay").classList.remove("open"); };
  $("#openGlobalStudyBtn").onclick = () => openStudy('global');

  // ----------------------------------------------------
  // GLOBAL EVENTS
  // ----------------------------------------------------
  $("#langKoBtn").onclick = () => { state.lang = "ko"; saveState(); render(); };
  $("#langViBtn").onclick = () => { state.lang = "vi"; saveState(); render(); };
  
  $("#themeBtn").onclick = () => {
    state.theme = state.theme === "light" ? "dark" : "light";
    saveState();
  };
  
  $("#modeToggleBtn").onclick = () => {
    state.mode = state.mode === "select" ? "type" : "select";
    saveState();
    render();
  };

  $("#resetBtn").onclick = () => {
    if(confirm("ëª¨ë“  ì§„í–‰ ìƒí™©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
      localStorage.removeItem(LS_KEY);
      location.reload();
    }
  };

  $("#gradeAllBtn").onclick = () => {
    QUIZ.forEach(q => window.handleCheck(q.id));
    alert("ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  $("#filterWrongBtn").onclick = () => {
    state.wrongFilter = !state.wrongFilter;
    $("#filterWrongBtn").textContent = state.wrongFilter ? "ëª¨ë“  ë¬¸ì œ ë³´ê¸°" : "ì˜¤ë‹µë§Œ ë³´ê¸°";
    $("#filterWrongBtn").classList.toggle("primary");
    render();
  };

  // Initial
  render();

</script>
</body>
</html>
